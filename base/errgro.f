      SUBROUTINE ERRGRO (LRETRN,IERRN)
      IMPLICIT NONE
C----------
C BASE $Id$
C----------
C
C     ERROR PROCESSOR FOR THE FOREST VEGETATION SIMULATOR.
C
COMMONS
C
C
      INCLUDE 'PRGPRM.F77'
C
C
      INCLUDE 'CONTRL.F77'
C
C
      INCLUDE 'PLOT.F77'
C
C
COMMONS
C

!DEC$ ATTRIBUTES DLLEXPORT,C,DECORATE :: FVSGETICCODE
!DEC$ ATTRIBUTES ALIAS : 'FVSGETICCODE' :: FVSGETICCODE
!DEC$ ATTRIBUTES REFERENCE :: I

      LOGICAL LRETRN
      INTEGER IERRN,IPTKNT,I
      CHARACTER*12 PREF
      CHARACTER*135 CMSG
C
      DATA PREF/'********   '/
      CMSG = ' '

      GO TO( 1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,
     >       2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,
     >       3100,3200,3300,3400,3500,3600,3700,3800,3900,4000,
     >       4100,4200,4300,4400,4500,4600,4700,4800,4900,5000,
     >       5100),
     >      IERRN 
 1100 CONTINUE
C                        ERROR NUMBER 1
      WRITE (JOSTND,1110) PREF,IRECNT
      WRITE (CMSG,1111) IRECNT
 1110 FORMAT (/A11,'FVS01 ERROR:  INVALID KEYWORD WAS SPECIFIED.',
     >        '  RECORDS READ=',I4)
 1111 FORMAT ('FVS01 ERROR:  INVALID KEYWORD WAS SPECIFIED.',
     >        '  RECORDS READ=',I4)
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
 1200 CONTINUE
C                        ERROR NUMBER 2
      WRITE (JOSTND,1210) PREF,IRECNT
      WRITE (CMSG,1211) IRECNT
 1210 FORMAT (/A11,'FVS02 ERROR:  NO "STOP" RECORD IN KEYWORD FILE',
     >        ';  RECORDS READ=',I4,'; END-OF-FILE.')
 1211 FORMAT ('FVS02 ERROR:  NO "STOP" RECORD IN KEYWORD FILE',
     >        ';  RECORDS READ=',I4,'; END-OF-FILE.')
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
 1300 CONTINUE
C                        ERROR NUMBER 3
      WRITE (JOSTND,1310) PREF
      WRITE(CMSG,1311)
 1310 FORMAT (/A11,'FVS03 WARNING:  FOREST CODE INDICATES THE',
     >        ' GEOGRAPHIC LOCATION IS OUTSIDE THE RANGE OF THE ',
     >        'MODEL.  DEFAULT CODE IS USED.')
 1311 FORMAT ('FVS03 WARNING:  FOREST CODE INDICATES THE',
     >        ' GEOGRAPHIC LOCATION IS OUTSIDE THE RANGE OF THE ',
     >        'MODEL.  DEFAULT CODE IS USED.')
      IF (ICCODE .LT. 1) ICCODE=1
      GO TO 9000
 1400 CONTINUE
C                        ERROR NUMBER 4
      WRITE (JOSTND,1410) PREF
      WRITE (CMSG,1411)
 1410 FORMAT (/A11,'FVS04 ERROR:  A REQUIRED PARAMETER IS MISSING',
     >        ' OR A PARAMETER IS INCORRECT; KEYWORD IGNORED.')
 1411 FORMAT ('FVS04 ERROR:  A REQUIRED PARAMETER IS MISSING',
     >        ' OR A PARAMETER IS INCORRECT; KEYWORD IGNORED.')
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
 1500 CONTINUE
C                        ERROR NUMBER 5
      WRITE (JOSTND,1510) PREF
      WRITE (CMSG,1511)
 1510 FORMAT (/A11,'FVS05 ERROR: EXPRESSION IS TOO LONG.')
 1511 FORMAT ('FVS05 ERROR: EXPRESSION IS TOO LONG.')
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
 1600 CONTINUE
C                        ERROR NUMBER 6
      WRITE (JOSTND,1610) PREF,IRECNT
      WRITE (CMSG,1611) IRECNT
 1610 FORMAT (/A11,'FVS06 ERROR:  KEYWORD RECORD WAS INCORRECTLY',
     >        ' READ. RECORDS READ=',I4)
 1611 FORMAT ('FVS06 ERROR:  KEYWORD RECORD WAS INCORRECTLY',
     >        ' READ. RECORDS READ=',I4)
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
 1700 CONTINUE
C                        ERROR NUMBER 7
      WRITE (JOSTND,1710) PREF
      WRITE (CMSG,1711)
 1710 FORMAT (/A11,'FVS07 WARNING:  A TREEFMT OR SPCODES RECORD',
     >        ' FOLLOWS A TREEDATA RECORD.')
 1711 FORMAT ('FVS07 WARNING:  A TREEFMT OR SPCODES RECORD',
     >        ' FOLLOWS A TREEDATA RECORD.')
      IF (ICCODE .LT. 1) ICCODE=1
      GO TO 9000
 1800 CONTINUE
C                        ERROR NUMBER 8
      WRITE (JOSTND,1810) PREF,IREC1,IRECRD,NPLT
      WRITE (CMSG,1811) IREC1,IRECRD,NPLT
 1810 FORMAT (/A11,'FVS08 WARNING:  TOO FEW PROJECTABLE TREE RECORDS.',
     >        '  PROJECTABLE RECORDS:',I2,';',/,28X,'TREE RECORDS:',I4,
     >        ';  STAND ID: ',A26)
 1811 FORMAT ('FVS08 WARNING:  TOO FEW PROJECTABLE TREE RECORDS.',
     >        '  PROJECTABLE RECORDS:',I2,'; TREE RECORDS:',I4,
     >        '; STAND ID: ',A26)
      IF (ICCODE .LT. 1) ICCODE=1
      GO TO 9000
 1900 CONTINUE
C                        ERROR NUMBER 9
      IPTKNT=LSTKNT-1
      WRITE (JOSTND,1910) PREF,IPTKNT,NSTKNT
      WRITE (CMSG,1911) IPTKNT,NSTKNT
 1910 FORMAT (/A11,'FVS09 WARNING:  PLOT COUNTS DO NOT MATCH ',
     >        'DATA ON THE DESIGN RECORD; DESIGN RECORD DATA USED.',/
     >        T29,'PLOT COUNT=',I4,'; NONSTOCKABLE COUNT=',I4)
 1911 FORMAT ('FVS09 WARNING:  PLOT COUNTS DO NOT MATCH ',
     >        'DATA ON THE DESIGN RECORD; DESIGN RECORD DATA USED.',
     >        'PLOT COUNT=',I4,'; NONSTOCKABLE COUNT=',I4)
      IF (ICCODE .LT. 1) ICCODE=1
      GO TO 9000
 2000 CONTINUE
C                        ERROR NUMBER 10
      WRITE (JOSTND,2010) PREF
      WRITE (CMSG,2011)
 2010 FORMAT (/A11,'FVS10 ERROR:  OPTION/ACTIVITY STORAGE AREA IS',
     >        ' FULL;  REQUEST(S) IGNORED.')
 2011 FORMAT ('FVS10 ERROR:  OPTION/ACTIVITY STORAGE AREA IS',
     >        ' FULL;  REQUEST(S) IGNORED.')
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
 2100 CONTINUE
C                        ERROR NUMBER 11
      WRITE (JOSTND,2110) PREF
      WRITE (CMSG,2111)
 2110 FORMAT (/A11,'FVS11 ERROR:  REQUESTED EXTENSION IS NOT PART',
     >        ' OF THIS PROGRAM.')
 2111 FORMAT ('FVS11 ERROR:  REQUESTED EXTENSION IS NOT PART',
     >        ' OF THIS PROGRAM.')
      IF (ICCODE .LT. 3) ICCODE=3
      GO TO 9000
 2200 CONTINUE
C                        ERROR NUMBER 12
      WRITE (JOSTND,2210) PREF
      WRITE (CMSG,2211)
 2210 FORMAT (/A11,'FVS12 ERROR:  ERROR COMPILING EXPRESSION RENDERS',
     >             ' IT USELESS.  IT WILL BE IGNORED.')
 2211 FORMAT ('FVS12 ERROR:  ERROR COMPILING EXPRESSION RENDERS',
     >             ' IT USELESS.  IT WILL BE IGNORED.')
      IF (ICCODE.LT.2) ICCODE=2
      GO TO 9000
 2300 CONTINUE
C                        ERROR NUMBER 13
      WRITE (JOSTND,2310) PREF,IRECRD,LSTKNT
      WRITE (CMSG,2311) IRECRD,LSTKNT
 2310 FORMAT (/A11,'FVS13 ERROR:  THE MAXIMUM NUMBER OF USEABLE ',
     >        'TREE RECORDS HAVE BEEN PROCESSED.  NUMBER READ =',I6,
     >        '; PLOT COUNT =',I3)
 2311 FORMAT ('FVS13 ERROR:  THE MAXIMUM NUMBER OF USEABLE ',
     >        'TREE RECORDS HAVE BEEN PROCESSED.  NUMBER READ =',I6,
     >        '; PLOT COUNT =',I3)
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
 2400 CONTINUE
C                        ERROR NUMBER 14
      WRITE(JOSTND,2410) PREF
      WRITE(CMSG,2411)
 2410 FORMAT(/A11,'FVS14 WARNING:  HABITAT/PLANT ASSOCIATION/ECOREGION',
     &            ' CODE WAS NOT RECOGNIZED; HABITAT/PLANT ',
     &            'ASSOCIATION/ECOREGION SET TO DEFAULT CODE.')
 2411 FORMAT('FVS14 WARNING:  HABITAT/PLANT ASSOCIATION/ECOREGION',
     &            ' CODE WAS NOT RECOGNIZED; HABITAT/PLANT ',
     &            'ASSOCIATION/ECOREGION SET TO DEFAULT CODE.')
      IF (ICCODE .LT. 1) ICCODE=1
      GO TO 9000
 2500 CONTINUE
C                        ERROR NUMBER 15
      WRITE (JOSTND,2510) PREF
      WRITE (CMSG,2511)
 2510 FORMAT (/A11,'FVS15 ERROR:  ATTEMPT TO REDEFINE A RESERVED ',
     >       'VARIABLE.  EXPRESSION IGNORED.')
 2511 FORMAT ('FVS15 ERROR:  ATTEMPT TO REDEFINE A RESERVED ',
     >       'VARIABLE.  EXPRESSION IGNORED.')
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
 2600 CONTINUE
C                        ERROR NUMBER 16
      WRITE (JOSTND,2610) PREF,IRECNT
      WRITE (CMSG,2611) IRECNT
 2610 FORMAT (/A11,'FVS16 ERROR:  KEYWORD ENTERED IS USED IN ',
     >        'WRONG CONTEXT AND WAS IGNORED.  RECORDS READ=',I4)
 2611 FORMAT ('FVS16 ERROR:  KEYWORD ENTERED IS USED IN ',
     >        'WRONG CONTEXT AND WAS IGNORED.  RECORDS READ=',I4)
      IF (ICCODE.LT.2) ICCODE=2
      GO TO 9000
 2700 CONTINUE
C                        ERROR NUMBER 17
      WRITE (JOSTND,2710) PREF
      WRITE (CMSG,2711)
 2710 FORMAT (/A11,'FVS17 ERROR:  EVENT MONITOR STORAGE AREA IS FULL.')
 2711 FORMAT ('FVS17 ERROR:  EVENT MONITOR STORAGE AREA IS FULL.')
      IF (ICCODE.LT.2) ICCODE=2
      GO TO 9000
 2800 CONTINUE
C                        ERROR NUMBER 18
      WRITE (JOSTND,2810) PREF
      WRITE (CMSG,2811)
 2810 FORMAT (/A11,'FVS18 ERROR:  ATTEMPT TO SCHEDULE A GROUP OF ',
     >        'ACTIVITIES FAILED.')
 2811 FORMAT ('FVS18 ERROR:  ATTEMPT TO SCHEDULE A GROUP OF ',
     >        'ACTIVITIES FAILED.')
      IF (ICCODE.LT.3) ICCODE=3
      GO TO 9000
 2900 CONTINUE
C                        ERROR NUMBER 19
      WRITE (JOSTND,2910) PREF
      WRITE (CMSG,2911)
 2910 FORMAT(/A11,'FVS19 ERROR:  INCORRECT RECORD TYPE OR END OF ',
     >        'DATA FOUND WHILE READING SAMPLE TREE SCRATCH FILE.')
 2911 FORMAT('FVS19 ERROR:  INCORRECT RECORD TYPE OR END OF ',
     >        'DATA FOUND WHILE READING SAMPLE TREE SCRATCH FILE.')
      IF (ICCODE .LT. 4) ICCODE=4
      GO TO 9000
 3000 CONTINUE
C                        ERROR NUMBER 20
      WRITE (JOSTND,3010) PREF
      WRITE (CMSG,3011)
 3010 FORMAT(/A11,'FVS20 WARNING:  SAMPLE TREE AND STAND ATTRIBUTE',
     >        ' TABLE SCRATCH FILE IS EMPTY; TABLE NOT PRINTED.')
 3011 FORMAT('FVS20 WARNING:  SAMPLE TREE AND STAND ATTRIBUTE',
     >        ' TABLE SCRATCH FILE IS EMPTY; TABLE NOT PRINTED.')
      IF (ICCODE .LT. 1) ICCODE=1
      GO TO 9000
 3100 CONTINUE
C                        ERROR NUMBER 21
      WRITE (JOSTND,3110) PREF
      WRITE (CMSG,3111)
 3110 FORMAT (/A11,'FVS21 ERROR:  AN EXPRESSION ',
     >  'WAS INCORRECTLY COMPUTED; ANSWER IS IGNORED.')
 3111 FORMAT ('FVS21 ERROR:  AN EXPRESSION ',
     >  'WAS INCORRECTLY COMPUTED; ANSWER IS IGNORED.')
      IF (ICCODE .LT. 1) ICCODE=2
      GO TO 9000
 3200 CONTINUE
C                        ERROR NUMBER 22
      WRITE (JOSTND,3210) PREF
      WRITE (CMSG,3211)
 3210 FORMAT(/A11,'FVS22 ERROR:  OVER 9 ALTERNATIVE ACTIVITY GROUPS ',
     >        'SPECIFIED, CURRENT GROUP MAY NOT BE SCHEDULED.')
 3211 FORMAT('FVS22 ERROR:  OVER 9 ALTERNATIVE ACTIVITY GROUPS ',
     >        'SPECIFIED, CURRENT GROUP MAY NOT BE SCHEDULED.')
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
 3300 CONTINUE
C                        ERROR NUMBER 23
      WRITE(JOSTND,3310) PREF
      WRITE(CMSG,3311)
 3310 FORMAT(/A11,'FVS23 WARNING:  PLANT ASSOCIATION (FIELD 2) NOT ',
     &            'RECOGNIZED.')
 3311 FORMAT('FVS23 WARNING:  PLANT ASSOCIATION (FIELD 2) NOT ',
     &            'RECOGNIZED.')
      IF (ICCODE .LT. 1) ICCODE=1
      GO TO 9000
 3400 CONTINUE
C                        ERROR NUMBER 24
      WRITE(JOSTND,3410) PREF
      WRITE(CMSG,3411)
 3410 FORMAT(/A11,'FVS24 WARNING:  MODEL TYPE (FIELD 2) NOT ',
     &            'RECOGNIZED.')
 3411 FORMAT('FVS24 WARNING:  MODEL TYPE (FIELD 2) NOT ',
     &            'RECOGNIZED.')
      IF (ICCODE .LT. 1) ICCODE=1
      GO TO 9000
C                        ERROR NUMBER 25
 3500 CONTINUE
      WRITE(JOSTND,3510) PREF
      WRITE(CMSG,3511)
 3510 FORMAT(/A11,'FVS25 ERROR:  INCORRECT USE/PLACEMENT OF PARMS;',
     >        ' KEYWORD IGNORED.')
 3511 FORMAT('FVS25 ERROR:  INCORRECT USE/PLACEMENT OF PARMS;',
     >        ' KEYWORD IGNORED.')
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
 3600 CONTINUE
C                        ERROR NUMBER 26
      WRITE(JOSTND,3610) PREF
      WRITE(CMSG,3611)
 3610 FORMAT(/A11,'FVS26 ERROR:  GENERAL REPORTS SCRATCH FILE CAN',
     >        ' NOT BE OPENED.')
 3611 FORMAT('FVS26 ERROR:  GENERAL REPORTS SCRATCH FILE CAN',
     >        ' NOT BE OPENED.')
      IF (ICCODE .LT. 3) ICCODE=3
      GO TO 9000
 3700 CONTINUE
C                        ERROR NUMBER 27
      WRITE (JOSTND,3710) PREF
      WRITE (CMSG,3711)
 3710 FORMAT (/A11,'FVS27 WARNING:  CALCULATED CALIBRATION VALUE ',
     >        'OUTSIDE REASONABLE RANGE. CALIBRATION OF THIS SPECIES ',
     >        'BEING TURNED OFF.')
 3711 FORMAT ('FVS27 WARNING:  CALCULATED CALIBRATION VALUE ',
     >        'OUTSIDE REASONABLE RANGE. CALIBRATION OF THIS SPECIES ',
     >        'BEING TURNED OFF.')
      IF (ICCODE .LT. 2) ICCODE=2      
      GO TO 9000
 3800 CONTINUE
C                        ERROR NUMBER 28
      WRITE (JOSTND,3810) PREF
      WRITE (CMSG,3811)
 3810 FORMAT (/A11,'FVS28 ERROR:  MAXIMUM NUMBER OF 30 SPECIES GROUPS',
     >        ' HAS ALREADY BEEN DEFINED; KEYWORD IGNORED.')
 3811 FORMAT ('FVS28 ERROR:  MAXIMUM NUMBER OF 30 SPECIES GROUPS',
     >        ' HAS ALREADY BEEN DEFINED; KEYWORD IGNORED.')
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
 3900 CONTINUE
C                        ERROR NUMBER 29
      WRITE (JOSTND,3910) PREF
      WRITE (CMSG,3911)
 3910 FORMAT (/A11,'FVS29 ERROR:  A SPECIES CODE WAS NOT RECOGNIZED.',
     >        ' THIS SPECIES WILL BE IGNORED.')
 3911 FORMAT ('FVS29 ERROR:  A SPECIES CODE WAS NOT RECOGNIZED.',
     >        ' THIS SPECIES WILL BE IGNORED.')
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
 4000 CONTINUE
C                        ERROR NUMBER 30
      WRITE (JOSTND,4010) PREF
      WRITE (CMSG,4011)
 4010 FORMAT (/A11,'FVS30 ERROR:  KEYWORD WAS USED OUT OF REQUIRED'
     >        ' SEQUENCE AND IS IGNORED.')
 4011 FORMAT ('FVS30 ERROR:  KEYWORD WAS USED OUT OF REQUIRED'
     >        ' SEQUENCE AND IS IGNORED.')
      IF (ICCODE .LT. 2) ICCODE=2
      GOTO 9000
C                        ERROR NUMBER 31
 4100 CONTINUE
      WRITE(JOSTND,4110) PREF
      WRITE(CMSG,4111)
 4110 FORMAT(/A11,'FVS31 ERROR:  .KCP OR .ADD FILE CAN NOT BE OPENED.')
 4111 FORMAT('FVS31 ERROR:  .KCP OR .ADD FILE CAN NOT BE OPENED.')
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
C                        ERROR NUMBER 32
 4200 CONTINUE
      WRITE(JOSTND,4210) PREF
      WRITE(CMSG,4211)
 4210 FORMAT(/A11,'FVS32 WARNING:  PV REFERENCE CODE WAS NOT ',
     &            'RECOGNIZED; HABITAT/PLANT ASSOCIATION/ECOREGION ',
     &            'SET TO DEFAULT CODE.')
 4211 FORMAT('FVS32 WARNING:  PV REFERENCE CODE WAS NOT ',
     &            'RECOGNIZED; HABITAT/PLANT ASSOCIATION/ECOREGION ',
     &            'SET TO DEFAULT CODE.')
      IF (ICCODE .LT. 1) ICCODE=1
      GO TO 9000
C                        ERROR NUMBER 33
 4300 CONTINUE
      WRITE(JOSTND,4310) PREF
      WRITE(CMSG,4311)
 4310 FORMAT(/A11,'FVS33 WARNING:  PV CODE WAS NOT ',
     &            'RECOGNIZED; HABITAT/PLANT ASSOCIATION/ECOREGION ',
     &            'SET TO DEFAULT CODE.')
 4311 FORMAT('FVS33 WARNING:  PV CODE WAS NOT ',
     &            'RECOGNIZED; HABITAT/PLANT ASSOCIATION/ECOREGION ',
     &            'SET TO DEFAULT CODE.')
      IF (ICCODE .LT. 1) ICCODE=1
      GO TO 9000
C                        ERROR NUMBER 34
 4400 CONTINUE
      WRITE(JOSTND,4410) PREF
      WRITE(CMSG,4411)
 4410 FORMAT(/A11,'FVS34 WARNING:  PV CODE/PV REFERENCE CODE ',
     &            'COMBINATION WAS NOT RECOGNIZED; HABITAT/PLANT ',
     &            'ASSOCIATION/ECOREGION SET TO DEFAULT CODE.')
 4411 FORMAT('FVS34 WARNING:  PV CODE/PV REFERENCE CODE ',
     &            'COMBINATION WAS NOT RECOGNIZED; HABITAT/PLANT ',
     &            'ASSOCIATION/ECOREGION SET TO DEFAULT CODE.')
      IF (ICCODE .LT. 1) ICCODE=1
      GO TO 9000
C                        ERROR NUMBER 35
 4500 CONTINUE
      WRITE(JOSTND,4510)  PREF
      WRITE(CMSG,4511)
 4510 FORMAT(/A11,'FVS35 WARNING:  THE NUMBER OF NONSTOCKABLE ',
     &            'PLOTS EQUALS THE TOTAL NUMBER OF PLOTS. ',
     &            /T29,'NUMBER OF NONSTOCKABLE PLOTS SET TO ZERO.')
 4511 FORMAT('FVS35 WARNING:  THE NUMBER OF NONSTOCKABLE ',
     &            'PLOTS EQUALS THE TOTAL NUMBER OF PLOTS. ',
     &            'NUMBER OF NONSTOCKABLE PLOTS SET TO ZERO.')
      IF (ICCODE .LT. 1) ICCODE=1
      GO TO 9000
C                        ERROR NUMBER 36
 4600 CONTINUE
      WRITE(JOSTND,4610)  PREF
      WRITE(CMSG,4611)
 4610 FORMAT(/A11,'FVS36 WARNING:  EXCESSIVE TREE HEIGHT: UNABLE TO ',
     &         'CALCULATE VOLUME FOR TREE RECORD, VOLUME SET TO ZERO')
 4611 FORMAT('FVS36 WARNING:  EXCESSIVE TREE HEIGHT: UNABLE TO ',
     &         'CALCULATE VOLUME FOR TREE RECORD, VOLUME SET TO ZERO')
      IF (ICCODE .LT. 1) ICCODE=1
      GO TO 9000
C                        ERROR NUMBER 37
 4700 CONTINUE
      WRITE (JOSTND,4710) PREF
      WRITE (CMSG,4711)
 4710 FORMAT (/A11,'FVS37 ERROR:  MAXIMUM NUMBER OF 30 POINT GROUPS',
     >        ' HAS ALREADY BEEN DEFINED; KEYWORD IGNORED.')
 4711 FORMAT ('FVS37 ERROR:  MAXIMUM NUMBER OF 30 POINT GROUPS',
     >        ' HAS ALREADY BEEN DEFINED; KEYWORD IGNORED.')
      IF (ICCODE .LT. 2) ICCODE=2
      GO TO 9000
C                        ERROR NUMBER 38
 4800 CONTINUE
      WRITE (JOSTND,4810) PREF
      WRITE (CMSG,4811)
 4810 FORMAT (/A11,'FVS38 ERROR:  MORE PLOTS FOUND IN TREE DATA ',
     >      'THAN SPECIFIED IN STAND DATA; PROJECTION TERMINATED.')
 4811 FORMAT ('FVS38 ERROR:  MORE PLOTS FOUND IN TREE DATA ',
     >      'THAN SPECIFIED IN STAND DATA; PROJECTION TERMINATED.')
      IF (ICCODE .LT. 3) ICCODE=3
      GO TO 9000
C                        ERROR NUMBER 39
 4900 CONTINUE
      WRITE(JOSTND,4910)  PREF
      WRITE(CMSG,4911)
 4910 FORMAT(/A11,'FVS39 ERROR:  USER DEFINED COMPUTE VARIABLE NAME ',
     &  'CONTAINS INVALID SPECIAL CHARACTERS. PROJECTION TERMINATED.')
 4911 FORMAT('FVS39 ERROR:  USER DEFINED COMPUTE VARIABLE NAME ',
     &  'CONTAINS INVALID SPECIAL CHARACTERS. PROJECTION TERMINATED.')
      IF (ICCODE .LT. 3) ICCODE=3
      GO TO 9000
 
C                        ERROR NUMBER 40
 5000 CONTINUE
      WRITE(JOSTND,5010)  PREF
      WRITE(CMSG,5011)
 5010 FORMAT(/A11,'FVS40 WARNING:  TREE RECORD REPRESENTING GREATER ',
     &  'THAN 1000 TPA ENCOUNTERED. MAY CAUSE MATHEMATICAL ERRORS.')
 5011 FORMAT('FVS40 WARNING:  TREE RECORD REPRESENTING GREATER ',
     &  'THAN 1000 TPA ENCOUNTERED. MAY CAUSE MATHEMATICAL ERRORS.')
      IF (ICCODE .LT. 2) ICCODE=1
      GO TO 9000
 
C                        ERROR NUMBER 41
 5100 CONTINUE
      WRITE(JOSTND,5110)  PREF
      WRITE(CMSG,5111)  
 5110 FORMAT(/A11,'FVS41 WARNING:  INITIAL STAND STOCKING IS MORE ',
     &  'THAN 5% ABOVE LIMIT, SDI MAXIMUM RESET.')
      IF (ICCODE .LT. 2) ICCODE=1
 5111 FORMAT('FVS41 WARNING:  INITIAL STAND STOCKING IS MORE ',
     &  'THAN 5% ABOVE LIMIT, SDI MAXIMUM RESET.')
      IF (ICCODE .LT. 2) ICCODE=1
      GO TO 9000

 9000 CONTINUE
      CALL DBSERROR(NPLT,CMSG)
      IF (LRETRN) RETURN
      CALL fvsSetRtnCode(ICCODE)
      RETURN
C
      ENTRY GRSTOP
      CALL fvsSetRtnCode(ICCODE)
      RETURN

      ENTRY fvsGetICCode(I)
      I = ICCODE
      RETURN

      END
