      SUBROUTINE ESTOCK (ELEV,IFT,XBA,PN)
      IMPLICIT NONE
C----------
C AK $Id$
C----------
C     CALCULATES PROBABILITY OF STOCKING FOR REGENERATION MODEL.
C     COEFFICIENTS FOR PLANTING ARE NOT INCLUDED IN EQUATIONS.
C
COMMONS
C
C
      INCLUDE 'PRGPRM.F77'
C
C
      INCLUDE 'ESPARM.F77'
C
C
      INCLUDE 'ESCOMN.F77'
C
C
      INCLUDE 'ESCOM2.F77'
C
C
      INCLUDE 'CONTRL.F77'
C
C
COMMONS
C
C----------
C  VARIABLE DEFINITIONS:
C----------
C
C  IFT      -- STAND FOREST TYPE CATEGORY WHERE:
C                1 = 122
C                2 = 125
C                3 = 270
C                4 = 271
C                5 = 281
C                6 = 301
C                7 = 304
C                8 = 305
C                9 = 703
C               10 = 901
C               11 = 902
C               12 = 904 (MAPPED TO 703)
C               13 = 911
C               14 = OTHER (MAPPED TO 122)
C  XPRD     -- PLOT RELATIVE DENSITY >= REGNBK, (SDIZ/SDIMAX)
C  XPTA     -- PLOT TREES PER ACRE >= REGNBK
C  SLO      -- PLOT SLOPE AS PROPORTION (ESCOMN.F77)
C  ELEV     -- STAND ELEVATION (100S OF FEET)
C  ELEVSQ   -- STAND ELEVATION (100S OF FEET) SQUARED (ESCOMN.F77)
C  XCOS     -- COSINE(ASPECT IN RADIANS) * SLOPE (ESCOMN.F77)
C  TLAT     -- STAND LATITUDE
C  PNFT     -- FOREST TYPE COEFFICIENT (B1)
C  PNRDA    -- RELATIVE DENSITY COEFFICIENT (B2)
C  PNPTPAA  -- TPA COEFFICIENT (B3)
C  PNSLO    -- SLOPE COEFFICIENT (B4)
C  PNEVEL   -- ELEVATION COEFFICIENT (B5)
C  PNELEVSQ -- ELEVATION SQUARED COEFFICIENT (B6)
C  PNXCOS   -- COS(ASPECT)*SLOPE COEFFICIENT (B7)
C  PNTLAT   -- STAND LATTITUDE COEFFICIENT (B8)
C  PN       -- USED IN DETERMINING PROBABILITY OF STOCKING
C----------
C  VARIABLE DECLARATIONS:
C----------  
      REAL PN,ELEV,PNFT(14),PNSLO,
     &     PNELEV(14),PNELEVSQ,PNXCOS,B1,B2,B3,B4,B5,B6,
     &     ADJSLO,ADJXC,PNSBA(14),XBA
      INTEGER IFT
C
C----------
C      DATA PNFT /
C     & 1.91407,  1.91407, 2.409481, 3.477396, 3.42792,
C     & 3.159591, 4.103265, 2.17215, 2.243518, 3.033035,
C     &  2.08587, 2.243518, 2.074072, 1.913788 /
C     DATA PNRDA / -1.118168 /
C      DATA PNPTPAA / 0.001757 /
C      DATA PNSLO / -0.001908 /
C      DATA PNELEV / 0.044478 /
C      DATA PNELEVSQ / -0.00127 /
C      DATA PNXCOS / -0.001886 /
C      DATA PNTLAT / -0.037725 /

      DATA PNFT /
     & 0.622735,  3.474829, 0.781726, 2.532744, 2.388648,
     & 1.244506,  3.058275, 0.360967, -0.698189, 2.057404,
     &  -0.110165, 0.074138, 0.622735, 0.622735 /
     
      DATA PNSBA / 
     & -0.003064, -0.004506, -0.000727, -0.001821, -0.002513,
     & -0.000649, -0.002014, -0.001319, -0.001207, -0.002271,
     & -0.001207, -0.001207, -0.003064, -0.003064/
     
      DATA PNSLO / -0.001469 /
      
      DATA PNELEV / 
     &  0.01671, -0.067113, 0.02004, -0.011355, -0.01391,
     &  0.031207, -0.028182, 0.043718, 0.093026, -0.0049,
     &  0.049536, 0.053783, 0.01671, 0.01671/
     
      DATA PNELEVSQ / -0.00051 /
      
      DATA PNXCOS / -0.001648 /
      
C     SET COEFFICIENTS FOR COMPUTING PN           
C      B1 = PNFT(IFT)
C      B2 = PNRDA
C      B3 = PNPTPAA
C      B4 = PNSLO
C      B5 = PNELEV
C      B6 = PNELEVSQ
C      B7 = PNXCOS
C      B8 = PNTLAT

C     SET COEFFICIENTS FOR COMPUTING PN           
      B1 = PNFT(IFT)
      B2 = PNSBA(IFT)
      B3 = PNSLO
      B4 = PNELEV(IFT)
      B5 = PNELEVSQ
      B6 = PNXCOS

C     ADJUST PLOT SLO-BASED VARIABLES TO PERCENT SLOPE.  
      ADJSLO = SLO*100
      ADJXC  = XCOS*100
      
C     PREDICT STOCKING PROBABILITY      
C      PN = B1 + B2 * XPRD + B3 * XPTA + B4 * ADJSLO + B5 * ELEV + 
C     &     B6 * ELEVSQ + B7 * ADJXC + B8 * TLAT

C     PREDICT STOCKING PROBABILITY      
      PN = B1 + B2 * XBA + B3 * ADJSLO + B4 * ELEV + 
     &    B5 * ELEVSQ + B6 * ADJXC
C
      RETURN
      END
