      SUBROUTINE ESTOCK (ELEV,IFT,XBA,XTPA,PN)
      IMPLICIT NONE
C----------
C AK $Id$
C----------
C     CALCULATES PROBABILITY OF STOCKING FOR REGENERATION MODEL.
C     COEFFICIENTS FOR PLANTING ARE NOT INCLUDED IN EQUATIONS.
C
COMMONS
C
C
      INCLUDE 'PRGPRM.F77'
C
C
      INCLUDE 'ESPARM.F77'
C
C
      INCLUDE 'ESCOMN.F77'
C
C
      INCLUDE 'ESCOM2.F77'
C
C
      INCLUDE 'CONTRL.F77'
C
C
COMMONS
C
C----------
C  VARIABLE DEFINITIONS:
C----------
C
C  IFT      -- STAND FOREST TYPE CATEGORY WHERE:
C                1 = 122
C                2 = 125
C                3 = 270
C                4 = 271
C                5 = 281
C                6 = 301
C                7 = 304
C                8 = 305
C                9 = 703
C               10 = 901
C               11 = 902
C               12 = 904 (MAPPED TO 703)
C               13 = 911
C               14 = OTHER (MAPPED TO 122)
C  XPRD     -- PLOT RELATIVE DENSITY >= REGNBK, (SDIZ/SDIMAX)
C  XPTA     -- PLOT TREES PER ACRE >= REGNBK
C  SLO      -- PLOT SLOPE AS PROPORTION (ESCOMN.F77)
C  ELEV     -- STAND ELEVATION (100S OF FEET)
C  ELEVSQ   -- STAND ELEVATION (100S OF FEET) SQUARED (ESCOMN.F77)
C  XCOS     -- COSINE(ASPECT IN RADIANS) * SLOPE (ESCOMN.F77)
C  TLAT     -- STAND LATITUDE
C  PNFT     -- FOREST TYPE COEFFICIENT (B1)
C  PNRDA    -- RELATIVE DENSITY COEFFICIENT (B2)
C  PNPTPAA  -- TPA COEFFICIENT (B3)
C  PNSLO    -- SLOPE COEFFICIENT (B4)
C  PNEVEL   -- ELEVATION COEFFICIENT (B5)
C  PNELEVSQ -- ELEVATION SQUARED COEFFICIENT (B6)
C  PNXCOS   -- COS(ASPECT)*SLOPE COEFFICIENT (B7)
C  PNTLAT   -- STAND LATTITUDE COEFFICIENT (B8)
C  PN       -- USED IN DETERMINING PROBABILITY OF STOCKING
C----------
C  VARIABLE DECLARATIONS:
C----------  
      REAL PN,ELEV,PNFT(14),PNSLO,
     &     PNELEV(14),PNELEVSQ,PNXCOS,B1,B2,B3,B4,B5,B6,B7,
     &     ADJSLO,ADJXC,PNSBA(14),PNSTPA(14),XBA,XTPA
      INTEGER IFT
C
C----------
C      DATA PNFT /
C     & 1.91407,  1.91407, 2.409481, 3.477396, 3.42792,
C     & 3.159591, 4.103265, 2.17215, 2.243518, 3.033035,
C     &  2.08587, 2.243518, 2.074072, 1.913788 /
C     DATA PNRDA / -1.118168 /
C      DATA PNPTPAA / 0.001757 /
C      DATA PNSLO / -0.001908 /
C      DATA PNELEV / 0.044478 /
C      DATA PNELEVSQ / -0.00127 /
C      DATA PNXCOS / -0.001886 /
C      DATA PNTLAT / -0.037725 /

      DATA PNFT /
     & 0.11984,  0.724734, 0.281057, 1.420298, 1.692877,
     & 0.799783,  2.004055, -0.088053, -0.886832, 1.758875,
     &  -0.396971, 0.11984, -0.226642, 0.11984 /
     
      DATA PNSBA / 
     & -0.007563, -0.009088, -0.001981, -0.003231, -0.006918,
     & -0.000437, -0.001118, -0.001364,  0.00148, -0.003435,
     & -0.004599, -0.007563,  -0.000211, -0.007563/
     
      DATA PNSTPA / 
     &  0.001567,  0.004375,  0.001579,  0.002995,  0.002453,
     &  0.000933,  0.001286,  0.001072,  0.000764,  0.000288,
     &  0.002261,  0.001567,  0.000886,  0.001567/
     
      DATA PNSLO / -0.002198 /
      
      DATA PNELEV / 
     &  0.005943, -0.046579, 0.019987, -0.011566, -0.028077,
     &  0.036386,  0.004927, 0.047183,  0.081858,  0.005247,
     &  0.020562,  0.005943,  0.055045, 0.005943/
     
      DATA PNELEVSQ / -0.000291 /
      
      DATA PNXCOS / -0.001268 /
      
C     SET COEFFICIENTS FOR COMPUTING PN           
C      B1 = PNFT(IFT)
C      B2 = PNRDA
C      B3 = PNPTPAA
C      B4 = PNSLO
C      B5 = PNELEV
C      B6 = PNELEVSQ
C      B7 = PNXCOS
C      B8 = PNTLAT

C     SET COEFFICIENTS FOR COMPUTING PN           
      B1 = PNFT(IFT)
      B2 = PNSBA(IFT)
      B3 = PNSTPA(IFT)
      B4 = PNSLO
      B5 = PNELEV(IFT)
      B6 = PNELEVSQ
      B7 = PNXCOS

C     ADJUST PLOT SLO-BASED VARIABLES TO PERCENT SLOPE.  
      ADJSLO = SLO*100
      ADJXC  = XCOS*100

C----------
C  PREDICT STOCKING PROBABILITY
C
C  PN = B1 + B2 * XBA + B3 * ADJSLO + B4 * ELEV + B5 * ELEVSQ +
C  B6 * ADJXC
C
C  VARIABLES DEFINED IN SECTION ABOVE
C  PN IS CONVERTED TO PROBABILITY OF STOCKING IN ESTAB.F BY
C  EXP(PN)/(1 + EXP(PN))
C----------

C     PREDICT STOCKING PROBABILITY      
      PN = B1 + B2 * XBA + B3 * XTPA + B4 * ADJSLO + B5 * ELEV + 
     &    B6 * ELEVSQ + B7 * ADJXC
C
      RETURN
      END
