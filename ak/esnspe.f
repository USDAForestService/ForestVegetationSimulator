      SUBROUTINE ESNSPE (IFT,PSPE,ITPP)
      IMPLICIT NONE
C----------
C AK $Id$
C----------
C     PREDICTS THE PROBABILITIES FOR THE NUMBER OF SPECIES 
C     ON STOCKED PLOTS
C----------
C  VARIABLE DEFINITIONS:
C----------
C  IFT      -- STAND FOREST TYPE CATEGORY WHERE:
C                1 = 122
C                2 = 125
C                3 = 270
C                4 = 271
C                5 = 281
C                6 = 301
C                7 = 304
C                8 = 305
C                9 = 703
C               10 = 901
C               11 = 902
C               12 = 904
C               13 = 911
C               14 = OTHER (NO ADVANCED REGENERATION)
C  ITPP     -- NUMBER OF TREES PER STOCKED PLOT (INTEGER)
C  RITPP    -- NUMBER OF TREES PER STOCKED PLOT (REAL)
C  NSSPB1 AND B1 -- B1 COEFFICENT BY FOREST TYPE AND NUMBER OF SPECIES (6)
C  NSSPB2 AND B2 -- B2 COEFFICENT BY NUMBER OF SPECIES (6)
C  PSPA     -- X VARIABLE IN EQN FOR PSPE
C  PSPE     -- PROBABILITY OF 1-6 SPECIES ON A PLOT
C----------
C  VARIABLE DECLARATIONS:
C----------
C
      INTEGER ITPP,I,II,IFT
C
      REAL RITPP,NSSPB1(6,14),NSSPB2(6),B1,B2
C
      REAL PSPE(6),PSPA
C PNFT(13,MAXSP)
C----------   
      RITPP=REAL(ITPP)
C
C----------
      DATA ((NSSPB1(I,II),I=1,6),II=1,14) / 
     &  0.972981,-0.834718,-3.573698,-8.267139,-8.314783,-7.558021,     ! 122 WHITE SPRUCE                     
     &  1.526159,-1.180112,-3.382956,-7.027506,-6.899899,-7.414408,     ! 125 BLACK SPRUCE                     
     &  0.144362,-0.610492,-1.932355,-3.940045,-5.871061,-5.950709,     ! 270 MOUNTAIN HEMLOCK                 
     & -1.037575,-0.6349,  -1.00881, -2.045421,-3.649316,-5.684398,     ! 271 ALASKA CEDAR                     
     & -0.834682,-0.560016,-1.084101,-2.424931,-3.687542,-4.7882,     ! 281 LODGEPOLE PINE                   
     &  0.109696,-0.288746,-2.295444,-4.580596,-6.466768,-7.424241,     ! 301 WESTERN HEMLOCK                  
     & -0.515852,-0.705988,-1.374317,-2.46867, -3.095118,-5.352223,     ! 304 WESTERN REDCEDAR                 
     &  0.526281,-0.598075,-2.850753,-5.709389,-7.372072,-6.595731,     ! 305 SITKA SPRUCE                     
     &  1.2398,  -1.182158,-2.639666,-7.840419,-7.749638,-7.024492,     ! 703 COTTONWOOD                       
     &  0.306906,-0.395092,-2.667478,-7.872929,-8.068009,-7.396098,     ! 901 ASPEN                            
     &  0.343207,-0.579799,-2.28306,-16.112153,-13.857581,-8.448979,     ! 902 PAPER BIRCH 
     &  0.972981,-0.834718,-3.573698,-8.267139,-8.314783,-7.558021,     ! 904 BALSAM POPLAR MAPPED TO 703 COTTONWOOD                     
     & -0.144419,-0.500671,-2.3677,  -6.245782,-6.848877,-6.723267,     ! 911 RED ALDER                        
     &  0.972981,-0.834718,-3.573698,-8.267139,-8.314783,-7.558021 /    ! OTHER F.T. MAPPED TO 122 WHITE SPRUCE
      DATA NSSPB2 / 
     & -0.017788, 0.001412, 0.002114, 0.015448, 0.012057, 0.004851 /

C----------
C  PREDICT PROBABILITIES FOR NUMBER OF SPECIES ON PLOT
C
C  PSPA = B1 + B2 * RITPP
C
C  VARIABLES DEFINED IN SECTION ABOVE
C  PSPA IS CONVERTED TO PROBABILITY OF NUMBER OF SPECIES ON PLOT BY
C  EXP(PN)/(1 + EXP(PN))
C----------

C     P(1 SPECIES ON STOCKED PLOTS)
      B1 = NSSPB1(1,IFT)
      B2 = NSSPB2(1)
      PSPA = B1 + B2 * RITPP
      PSPE(1) = EXP(PSPA)/(1+EXP(PSPA))
C     P(2 SPECIES ON STOCKED PLOTS)
      IF(ITPP.LT.2) GO TO 78
      B1 = NSSPB1(2,IFT)
      B2 = NSSPB2(2)
      PSPA = B1 + B2 * RITPP
      PSPE(2) = EXP(PSPA)/(1+EXP(PSPA))
C     P(3 SPECIES ON STOCKED PLOTS)
      IF(ITPP.LT.3) GO TO 78
      B1 = NSSPB1(3,IFT)
      B2 = NSSPB2(3)
      PSPA = B1 + B2 * RITPP
      PSPE(3) = EXP(PSPA)/(1+EXP(PSPA))
C     P(4 SPECIES ON STOCKED PLOTS)
      IF(ITPP.LT.4) GO TO 78
      B1 = NSSPB1(4,IFT)
      B2 = NSSPB2(4)
      PSPA = B1 + B2 * RITPP
      PSPE(4) = EXP(PSPA)/(1+EXP(PSPA))
C     P(5 SPECIES ON STOCKED PLOTS)
      IF(ITPP.LT.5) GO TO 78
      B1 = NSSPB1(5,IFT)
      B2 = NSSPB2(5)
      PSPA = B1 + B2 * RITPP
      PSPE(5) = EXP(PSPA)/(1+EXP(PSPA))
C     P(6 SPECIES ON STOCKED PLOTS)
      IF(ITPP.LT.6) GO TO 78
      B1 = NSSPB1(6,IFT)
      B2 = NSSPB2(6)
      PSPA = B1 + B2 * RITPP
      PSPE(6) = EXP(PSPA)/(1+EXP(PSPA))
C
   78 CONTINUE
      RETURN
      END
