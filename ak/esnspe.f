      SUBROUTINE ESNSPE (IFT,PSPE,ITPP,DEBUG,JOSTND)
      IMPLICIT NONE
C----------
C AK $Id$
C----------
C     PREDICTS THE PROBABILITIES FOR THE NUMBER OF SPECIES 
C     ON STOCKED PLOTS
C----------
C  VARIABLE DEFINITIONS:
C----------
C  IFT      -- STAND FOREST TYPE CATEGORY WHERE:
C                1 = 122
C                2 = 125
C                3 = 270
C                4 = 271
C                5 = 281
C                6 = 301
C                7 = 304
C                8 = 305
C                9 = 703
C               10 = 901
C               11 = 902
C               12 = 904
C               13 = 911
C               14 = OTHER (NO ADVANCED REGENERATION)
C  ITPP     -- NUMBER OF TREES PER STOCKED PLOT (INTEGER)
C  RITPP    -- NUMBER OF TREES PER STOCKED PLOT (REAL)
C  NSSPB1 AND B1 -- B1 COEFFICENT BY FOREST TYPE AND NUMBER OF SPECIES (6)
C  NSSPB2 AND B2 -- B2 COEFFICENT BY NUMBER OF SPECIES (6)
C  PSPA     -- X VARIABLE IN EQN FOR PSPE
C  PSPE     -- PROBABILITY OF 1-6 SPECIES ON A PLOT
C----------
C  VARIABLE DECLARATIONS:
C----------
      LOGICAL DEBUG
C
      INTEGER ITPP,I,II,IFT,JOSTND
C
      REAL RITPP,NSSPB1(6,14),NSSPB2(6),B1,B2
C
      REAL PSPE(6),PSPA
C PNFT(13,MAXSP)
C----------   
      RITPP=REAL(ITPP)
C
C----------
      DATA ((NSSPB1(I,II),I=1,6),II=1,14) / 
     & 1.514466, -1.130485, -4.345526, -6.061343, -9.282172, -9.263319,     ! 122 WHITE SPRUCE                     
     & 2.33692,  -1.364289, -4.725742, -7.190956, -10.817028, -9.695317,     ! 125 BLACK SPRUCE                     
     & 0.787703, -0.822546, -2.824892, -5.172281, -8.815643, -9.039528,     ! 270 MOUNTAIN HEMLOCK                 
     &-0.227513, -0.743091, -1.941313, -3.391035, -6.505262, -9.421316,     ! 271 ALASKA CEDAR                     
     &-0.041975, -0.643339, -1.961849, -4.009763, -8.205985, -5.996876,     ! 281 LODGEPOLE PINE                   
     & 0.837373, -0.687024, -3.137052, -5.605608, -9.147572, -9.551078,     ! 301 WESTERN HEMLOCK                  
     & 0.295898, -0.757339, -2.411081, -3.820975, -6.728512, -7.271471,     ! 304 WESTERN REDCEDAR                 
     & 1.261125, -1.085806, -3.752193, -5.807558, -8.732909, -8.933396,     ! 305 SITKA SPRUCE                     
     & 1.535307, -1.288482, -3.233754, -5.765195, -8.679735, -8.831665,     ! 703 COTTONWOOD                       
     & 0.827381, -0.632341, -3.309655, -6.342733, -9.042995, -9.132168,     ! 901 ASPEN                            
     & 0.955467, -0.845367, -3.046738, -6.182925, -9.180378, -9.272577,     ! 902 PAPER BIRCH 
     & 1.514466, -1.130485, -4.345526, -6.061343, -9.282172, -9.263319,     ! 904 BALSAM POPLAR MAPPED TO 703 COTTONWOOD                     
     & 0.856235, -0.937544, -2.764232, -5.426666, -8.64982,  -8.767986,     ! 911 RED ALDER                        
     & 1.514466, -1.130485, -4.345526, -6.061343, -9.282172, -9.263319 /    ! OTHER F.T. MAPPED TO 122 WHITE SPRUCE

      DATA NSSPB2 / 
     & -0.095656, 0.027575, 0.082907, 0.111271, 0.196761, 0.09174 /

C----------
C  PREDICT PROBABILITIES FOR NUMBER OF SPECIES ON PLOT
C
C  PSPA = B1 + B2 * RITPP
C
C  VARIABLES DEFINED IN SECTION ABOVE
C  PSPA IS CONVERTED TO PROBABILITY OF NUMBER OF SPECIES ON PLOT BY
C  EXP(PN)/(1 + EXP(PN))
C----------

C     P(1 SPECIES ON STOCKED PLOTS)
      B1 = NSSPB1(1,IFT)
      B2 = NSSPB2(1)
      PSPA = B1 + B2 * RITPP
      PSPE(1) = EXP(PSPA)/(1+EXP(PSPA))
C     P(2 SPECIES ON STOCKED PLOTS)
      IF(ITPP.LT.2) GO TO 78
      B1 = NSSPB1(2,IFT)
      B2 = NSSPB2(2)
      PSPA = B1 + B2 * RITPP
      PSPE(2) = EXP(PSPA)/(1+EXP(PSPA))
C     P(3 SPECIES ON STOCKED PLOTS)
      IF(ITPP.LT.3) GO TO 78
      B1 = NSSPB1(3,IFT)
      B2 = NSSPB2(3)
      PSPA = B1 + B2 * RITPP
      PSPE(3) = EXP(PSPA)/(1+EXP(PSPA))
C     P(4 SPECIES ON STOCKED PLOTS)
      IF(ITPP.LT.4) GO TO 78
      B1 = NSSPB1(4,IFT)
      B2 = NSSPB2(4)
      PSPA = B1 + B2 * RITPP
      PSPE(4) = EXP(PSPA)/(1+EXP(PSPA))
C     P(5 SPECIES ON STOCKED PLOTS)
      IF(ITPP.LT.5) GO TO 78
      B1 = NSSPB1(5,IFT)
      B2 = NSSPB2(5)
      PSPA = B1 + B2 * RITPP
      PSPE(5) = EXP(PSPA)/(1+EXP(PSPA))
C     P(6 SPECIES ON STOCKED PLOTS)
      IF(ITPP.LT.6) GO TO 78
      B1 = NSSPB1(6,IFT)
      B2 = NSSPB2(6)
      PSPA = B1 + B2 * RITPP
      PSPE(6) = EXP(PSPA)/(1+EXP(PSPA))
C
   78 CONTINUE
      IF(DEBUG)WRITE(JOSTND,*)'IN ESNSPE',' IFT=',IFT,' ITPP=',ITPP,
     & ' PSPE(1)=',PSPE(1),' PSPE(2)=',PSPE(2),' PSPE(3)=',PSPE(3),
     & ' PSPE(4)=',PSPE(4),' PSPE(5)=',PSPE(5),' PSPE(6)=',PSPE(6)
      RETURN
      END
