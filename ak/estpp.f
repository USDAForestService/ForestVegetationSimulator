      SUBROUTINE ESTPP (VAL,IFT,TPP)
      IMPLICIT NONE
C----------
C AK $Id$
C----------
C     PREDICTS THE NUMBER OF NATURAL REGENERATING TREES
C     TO ESTABLISH PER PLOT
C----------
C
COMMONS
C
C
      INCLUDE 'PRGPRM.F77'
C
C
      INCLUDE 'ESPARM.F77'
C
C
      INCLUDE 'ESCOM2.F77'
C
C
      INCLUDE 'ESCOMN.F77'
C
C
COMMONS
C
C----------
C  VARIABLE DEFINITIONS:
C----------
C
C  VAL      -- RANDOM NUMBER DRAW
C  IFT      -- STAND FOREST TYPE CATEGORY WHERE:
C                1 = 122
C                2 = 125
C                3 = 270
C                4 = 271
C                5 = 281
C                6 = 301
C                7 = 304
C                8 = 305
C                9 = 703
C               10 = 901
C               11 = 902
C               12 = 904
C               13 = 911
C               14 = OTHER (NO ADVANCED REGENERATION)
C  BB AND BBIFT   -- WEIBULL SCALE PARAMETER BY FOREST TYPE
C  CC AND CCIFT   -- WEIBULL SHAPE PARAMETER BY FOREST TYPE
C  TPP      -- NUMBER OF TREES PER STOCKED PLOT
C
C----------
C  VARIABLE DECLARATIONS:
C----------
C
      REAL BB,CC,TPP,VAL,BBIFT(14),CCIFT(14)
      INTEGER IFT

      DATA BBIFT / 
     & 9.920173, 20.014237, 6.939908, 14.517648, 13.472296, 13.472296,
     & 14.65442, 6.170266,  8.073641,  9.68019,  9.061888,  9.920173,
     & 4.913458, 9.920173 /

      DATA CCIFT /    
     & 0.874413, 1.141855, 1.077064, 1.207867, 0.958417, 0.958417, 
     & 1.178212, 0.992615, 0.772255, 1.048497, 0.918066, 0.874413, 
     & 1.073496, 0.874413 /

C     CALCULATE TREES PER STOCKED PLOT.
C     LP,YC,RC FOREST TYPES: USE WESTERN HEMLOCK FOREST TYPE WEIBULL
C     DISTRIBUTION.
      BB = BBIFT(IFT)
      CC = CCIFT(IFT)
      TPP = BB * (-1*ALOG(1-VAL))**(1/CC)

C     SET TO 0 IF FOREST TYPE IS OTHER (14)
      IF(IFT.EQ.14)TPP=0.
      RETURN
      END
