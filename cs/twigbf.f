      SUBROUTINE TWIGBF(ISPC,H,D,VMAX,BBFV)
      IMPLICIT NONE
C----------
C CS $Id: twigbf.f 000 2018-03-27 00:00:00Z gedixon $
C----------
C
COMMONS
C
C
      INCLUDE 'PRGPRM.F77'
C
C
      INCLUDE 'PLOT.F77'
C
C
COMMONS
C
C  ************** BOARD FOOT MERCHANTABILITY SPECIFICATIONS ********
C
C  BFVOL CALCULATES BOARD FOOT VOLUME OF ANY TREE LARGER THAN A MINIMUM
C  DBH SPECIFIED BY THE USER.  MINIMUM DBH CAN VARY BY SPECIES,
C  BUT CANNOT BE LESS THAN 2 INCHES. 
C
C  MERCHANTABLE TOP DIAMETER CAN BE SET WITH THE BFVOLUME KEYWORD
C  AT ANY VALUE BETWEEN 2 IN. AND ACTUAL DBH.  THIS DIAMETER IS
C  OUTSIDE BARK -- IF DIB IS DESIRED, ALLOWANCE FOR DOUBLE BARK
C  THICKNESS MUST BE MADE IN SPECIFICATION OF TOP DIAMETER.
C
C----------
      REAL B1(MAXSP),B2(MAXSP),B3(MAXSP),B4(MAXSP),BBFV,VMAX,D,H
      INTEGER ISPC
      REAL RDANUW
C----------
C  COEFFICIENTS FOR NET BOARD FOOT VOLUME EQUATION FOR ACCEPTABLE
C  TREES (TREE CLASS 1 & 2).
C----------
      DATA B1/
     &  2*68.6358,5*68.6528,2*68.6472,4*178.1367,10*1151.2737,343.5727,
     &  3*68.6341,68.6298,3*68.6272,68.6298,8*693.5429,261.7747,68.6283,
     &  68.6272,3*68.6341,103.7664,5*871.4258,7*103.7664,
     &  8*871.4258,29*164.5671/
      DATA B2/
     &  2*.6359,5*.9374,2*.5722,4*.3116,10*.0,.3245,3*.7813,.6536,
     &  3*.5665,.5869,8*.0476,.3820,.6229,.5665,3*.7813,.6707,5*.0682,
     &  7*.6707,8*.0682,29*.4052/
      DATA B3/
     &  2*.000082,5*.00004,2*.000087,4*.000083,10*.000077,.000081,
     &  3*.000079,.000053,3*.000140,.000045,8*.000071,.000088,.000045,
     &  .000140,3*.000079,.000076,5*.000112,7*.00076,8*.000112,
     &  29*.000061/
      DATA B4/
     &  2*2.8486,5*2.6643,2*2.8488,4*2.8811,10*2.7331,2.6745,3*2.5203,
     &  2.8696,3*2.7006,3.0054,8*2.9203,2.6472,3.0375,2.7006,3*2.5203,
     &  2.6670,5*2.5879,7*2.6670,8*2.5879,29*2.8766/
C-----------------------------------------------------------------
C  CENTRAL STATES ACCEPTABLE TREE CLASS BD FT VOLUME EQUATION:
C  --SMITH, W. BRAD, C.A. WEIST. 1982. A NET VOLUME EQUATION
C    FOR INDIANA. RESOUR. BULL. NC-63. ST PAUL, MN: USDA, FOREST
C    SERVICE, NORTH CENTRAL FOREST EXPERIMENT STATION. 7 P.
C
C          V = B1*SI**B2*[1-EXP(-B3*DBH**B4)]
C
C  WHERE:
C        V = VOLUME
C       SI = SITE INDEX
C      DBH = DIAMETER BREAST HEIGHT
C    B1-B4 = SPECIES SPECIFIC COEFFICIENTS
C------------------------------------------------------------------
C----------
C  DUMMY ARGUMENT NOT USED WARNING SUPPRESSION SECTION
C----------
      RDANUW = H
C
C----------
C  COMPUTE TOTAL BOARD FOOT VOLUME (VMAX)
C----------
        VMAX=B1(ISPC)*SITEAR(ISPC)**B2(ISPC)*(1.-EXP(-1.0*B3(ISPC)
     &      *(D**B4(ISPC))))
C----------
C  COMPUTE MERCH BOARD FOOT VOLUME (BBFV)
C----------
        BBFV=VMAX
        RETURN
        END
