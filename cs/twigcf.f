      SUBROUTINE TWIGCF(ISPC,H,D,VN,VM,I)
      IMPLICIT NONE
C----------
C CS $Id: twigcf.f 000 2018-03-27 00:00:00Z gedixon $
C----------
C THIS ROUTINE CALCULATES TOTAL CUBIC FOOT VOLUME AND MERCH
C CUBIC FOOT VOLUME FOR A TREE.  CORRECTIONS FOR TOP KILL AND
C DEFECT ARE STILL CALCULATED IN VOLS.
C----------
COMMONS
C
      INCLUDE 'PRGPRM.F77'
C
C
      INCLUDE 'PLOT.F77'
C
C
      INCLUDE 'ARRAYS.F77'
C
C
      INCLUDE 'VOLSTD.F77'
C
C
COMMONS
C----------
C  DIMENSION STATEMENT FOR INTERNAL ARRAYS.
C----------
      REAL B1(MAXSP),B2(MAXSP),B3(MAXSP),B4(MAXSP),
     & A1(MAXSP),A2(MAXSP),A3(MAXSP),A4(MAXSP),C1(MAXSP),
     & C2(MAXSP),C3(MAXSP),C4(MAXSP)
      REAL VM,VN,D,H,D1,D2,D3,D4
      INTEGER I,ISPC
      REAL RDANUW
C----------
C  COEFFICIENTS FOR NET CUBIC FOOT VOLUME FOR ACCEPTABLE TREES
C  (TREE CLASS 1)
C----------
      DATA A1/
     &  2*24.3201,5*32.7134,2*65.4786,4*15.8460,10*24.3795,252.1400,
     &  3*168.5280,14.1604,3*948.9211,21.9481,8*341.7616,23.6994,
     &  16.8823,948.9211,3*168.5280,21.1498,5*126.1555,7*21.1498,
     &  8*126.1555,29*16.7211/
      DATA A2/
     &  2*.8216,5*.3785,2*.0383,4*.5938,10*.5106,.0336,3*.0904,.8812,
     &  3*.0,.4170,8*.0,.5052,.5723,.0,3*.0904,.5754,5*.2152,7*.5754,
     &  8*.2152,29*.5991/
      DATA A3/
     &  2*.000044,5*.000089,2*.000265,4*.000063,10*.000086,.000110,
     &  3*.000099,.000056,3*.000059,.000263,8*.000083,.000097,.000100,
     &.000059,3*.000099,.000110,5*.000081,7*.00011,8*.000081,29*.000080/
      DATA A4/
     &  2*2.5616,5*2.7986,2*2.7537,4*2.8574,10*2.7597,2.5349,3*2.6121,
     &  2.4651,3*2.3163,2.5539,8*2.5673,2.7495,2.7071,2.3163,3*2.6121,
     &  2.5942,5*2.5973,7*2.5942,8*2.5973,29*2.7109/
C----------
C  COEFFICIENTS TO CALCULATE NET MERCHANTABLE CUBIC FOOT VOLUME
C  FOR ACCEPTABLE TREES (TREE CLASS 1)
C----------
      DATA B1/
     &  2*32.7134,5*8.5339,2*528.3431,4*4.0386,10*142.5035,1173.2462,
     &  3*527.1757,75.3457,3*190.0165,50.047,8*77.4351,26.6412,34.0091,
     &  190.0165,3*527.1757,32.6541,5*108.1743,7*32.6541,8*108.1743,
     &  29*15.0211/
      DATA B2/
     &  2*.3785,5*.5167,2*.1433,4*.6312,10*.0034,4*.0,.4188,3*.0,.2127,
     &  8*.0922,.4204,.2952,4*.0,.4767,5*.0818,7*.4767,8*.0818,
     &  29*.4755/
      DATA B3/
     &  2*.000089,5*.000231,2*.00003,4*.000064,10*.000116,.000025,
     &  3*.000078,.000016,3*.000199,.000064,8*.000154,.000135,.000025,
     &  .000199,3*.000078,.000084,5*.000175,7*.000084,8*.000175,
     &  29*.000087/
      DATA B4/
     &  2*2.7986,5*2.7641,2*2.4206,4*3.1986,10*2.6411,2.4259,3*2.2867,
     &  2.8728,3*2.3569,2.8882,8*2.6564,2.5659,3.2982,2.3569,3*2.2867,
     &  2.6689,5*2.4623,7*2.6689,8*2.4623,29*2.8131/
C----------
C  COEFFICIENTS FOR NET CUBIC FOOT VOLUME FOR UNDESIRABLE TREES
C  (TREE CLASS 2)
C----------
      DATA C1/
     &  7*22.7769,6*57.1662,10*18.6983,4.0681,3*5.0944,62.0266,
     &  3*72.0477,8.9688,8*25.5502,2*57.1662,72.0477,3*5.0944,104.1617,
     &  5*21.1882,7*104.1617,8*21.1882,17*57.1662,12*42.6350/
      DATA C2/
     &  7*.4240,6*.4545,10*.4097,.5642,3*.6960,.4397,3*.0743,.3930,
     &  8*.1927,2*.4545,.0743,3*.696,.089,5*.6788,7*.0890,8*.6788,
     &  17*.4545,12*.000/
      DATA C3/
     &  7*.000057,6*.000048,10*.000132,.000099,3*.000158,.000037,
     &  3*.000166,.000253,8*.0002,2*.000048,.000166,3*.000158,.000119,
     &  5*.000073,7*.000119,8*.000073,17*.000048,12*.000454/
      DATA C4/
     &  7*2.9092,6*2.5027,10*2.7085,3.2936,3*2.6118,2.6637,3*2.7068,
     &  2.8160,8*2.7686,2*2.5027,2.7068,3*2.6118,2.5916,5*2.4026,
     &  7*2.5916,8*2.4026,17*2.5027,12*2.5315/
C------------------------------------------------------------------
C  CENTRAL STATES ACCEPTABLE TREE CLASS VOLUME EQUATION:
C  --SMITH, W. BRAD; WEIST, CAROL A. 1982. A NET VOLUME EQUATION
C    FOR INDIANA. RESOURCE BULL. NC-63. ST. PAUL, MN: US DEPT OF
C    AG, FS, NCFES.
C
C         V = A*SI**B*[1-EXP(-C*(DBH**D)]
C
C  WHERE:
C      V = VOLUME
C     SI = SITE INDEX
C    DBH = DIAMETER BREAST HEIGHT
C    A-D = SPECIES SPECIFIC COEFFICIENTS
C
C----------
C  DUMMY ARGUMENT NOT USED WARNING SUPPRESSION SECTION
C----------
      RDANUW = H
C
C----------
C SET INITIAL VALUES.  IF DIAMETER LIMITS NOT MET THEN RETURN.
C----------
       IF(IMC(I) .EQ. 1)THEN
          D1=A1(ISPC)
          D2=A2(ISPC)
          D3=A3(ISPC)
          D4=A4(ISPC)
         ELSE
          D1=C1(ISPC)
          D2=C2(ISPC)
          D3=C3(ISPC)
          D4=C4(ISPC)
        ENDIF
C----------
C  CALCULATE NET CUBIC FOOT VOLUME (VN)
C----------
       VN = D1*(SITEAR(ISPC)**D2)*(1.-EXP(-1.0*D3*(D**D4)))
C----------
C  CALCULATE MERCHANTABLE CUBIC FOOT VOLUME (VM)
C----------
       IF ((IMC(I) .GT. 1) .OR. (D .LT. BFMIND(ISPC))) GOTO 100
       VM = B1(ISPC)*SITEAR(ISPC)**B2(ISPC)*(1.-EXP(-1.0*B3(ISPC)*(D
     &        **B4(ISPC))))
  100  CONTINUE
       RETURN
       END                                    

