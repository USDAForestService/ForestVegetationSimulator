      SUBROUTINE FORKOD
      IMPLICIT NONE
C----------
C  **FORKOD--NI DATE OF LAST REVISION:  04/09/08
C----------
C
C     TRANSLATES FOREST CODE INTO A SUBSCRIPT, IFOR, AND IF
C     KODFOR IS ZERO, THE ROUTINE RETURNS THE DEFAULT CODE.
C
COMMONS
C
C
      INCLUDE 'PRGPRM.F77'
C
C
      INCLUDE 'PLOT.F77'
C
C
      INCLUDE 'CONTRL.F77'
C
C
COMMONS
C
C----------
C  NATIONAL FORESTS:
C  103 = BITTERROOT
C  104 = IDAHO PANHANDLE
C  105 = CLEARWATER
C  106 = COEUR D'ALENE
C  621 = COLVILLE
C  110 = FLATHEAD
C  113 = KANIKSU
C  114 = KOOTENAI
C  116 = LOLO
C  117 = NEZPERCE
C  118 = ST. JOE
C  613 = KANIKSU ADMINISTERED BY COLVILLE (MAPPED TO KANIKSU 113)
C  102 = BEAVERHEAD (MAPPED TO BITTERROOT 103)
C  109 = DEERLODGE (MAPPED TO BITTERROOT 103)
C  112 = HELENA (MAPPED TO LOLO 116)
C----------
      INTEGER JFOR(15),KFOR(15),NUMFOR,I
      DATA JFOR/103,104,105,106,621,110,113,114,116,117,118,613,
     &          102,109,112/,
     >          NUMFOR /15/
      DATA KFOR/1,1,3,2,1,1,1,1,1,3,2,1,1,1,1 /
C
      IF (KODFOR .EQ. 0) GOTO 30
      DO 10 I=1,NUMFOR
      IF (KODFOR .EQ. JFOR(I)) GOTO 20
   10 CONTINUE
      CALL ERRGRO (.TRUE.,3)
      WRITE(JOSTND,200) JFOR(IFOR)
 200  FORMAT(T12,'FOREST CODE USED FOR THIS PROJECTION IS',I4)
      GOTO 30
   20 CONTINUE
C
      IF(I .EQ. 12)THEN
        WRITE(JOSTND,22)
   22   FORMAT(T12,'KANIKSU NF (613) BEING MAPPED TO ',
     &  'KANIKSU (113) FOR FURTHER PROCESSING.')
        I=7
      ELSEIF(I .EQ. 13)THEN
        WRITE(JOSTND,24)
   24   FORMAT(T12,'BEAVERHEAD (102) BEING MAPPED TO ',
     &  'BITTERROOT (103) FOR FURTHER PROCESSING.')
        I=1
      ELSEIF(I .EQ. 14)THEN
        WRITE(JOSTND,26)
   26   FORMAT(T12,'DEERLODGE (109) BEING MAPPED TO ',
     &  'BITTERROOT (103) FOR FURTHER PROCESSING.')
        I=1
      ELSEIF(I .EQ. 15)THEN
        WRITE(JOSTND,28)
   28   FORMAT(T12,'HELENA (112) BEING MAPPED TO ',
     &  'LOLO (116) FOR FURTHER PROCESSING.')
        I=9
      ENDIF
      IFOR=I
      IGL=KFOR(I)
   30 CONTINUE
      KODFOR=JFOR(IFOR)
      RETURN
      END
