      SUBROUTINE INITRE
      IMPLICIT NONE
C----------
C VBASE $Id$
C----------
C
C  THIS ROUTINE PROCESSES OPTIONS AND INITIATES THE
C  PROGNOSIS RUN.  CALLED FROM **MAIN**.
C
COMMONS
C
C
      INCLUDE  'PRGPRM.F77'
C
C
      INCLUDE  'ARRAYS.F77'
C
C
      INCLUDE  'COEFFS.F77'
C
C
      INCLUDE  'CONTRL.F77'
C
C
      INCLUDE  'PLOT.F77'
C
C
      INCLUDE  'OUTCOM.F77'
C
C
      INCLUDE  'HTCAL.F77'
C
C
      INCLUDE  'ECON.F77'
C
C
      INCLUDE  'KEYCOM.F77'
C
C
      INCLUDE  'MULTCM.F77'
C
C
      INCLUDE  'VOLSTD.F77'
C
C
      INCLUDE  'SCREEN.F77'
C
C
      INCLUDE  'SNCOM.F77'
C
C
      INCLUDE  'VARCOM.F77'
C
C
      INCLUDE  'CWDCOM.F77'
C
C
      INCLUDE  'CALCOM.F77'
C
C
      INCLUDE  'WORKCM.F77'
C
C
COMMONS
C
      INTEGER IDUM1,IDUM2,IDUM3,IHAB,NEWYR,ISPEC,IFOREST,INTDIST,IFORST
      INTEGER IFSP,IREGN,IRDUM,INUM,IDFLG,IDTYPE,IXF,IXTMP,ITB,ITC,JJTAB
      REAL CAPHT,CAPFLG,CAPPRP,CAPDBH,DUM1,XTMP,X,TB,XXG
      REAL TC,SDHI,SDLO,ARRAY(7),PRMS(10)
      INTEGER ITOPD8,IACT,IRC,IDBCYC,NP,K,I1,IGSP,IG,IULIM,IGRP,ISETQFA
      INTEGER ISPC,ILEN,IS,IDT,JRECNT,ISDSP,IGNDEF,IPSI,KODE,IPRMPT
      INTEGER NUMBER,IPTKNT,I,IISP,J,I2
      INTEGER ERRFLAG,IRTNCD
      INTEGER POINTNO,IFLAG
      LOGICAL LTRERD,LFIRST,LNOTBK(7),LNOTRE
      LOGICAL DEBUG,LOPEVN,LKECHO
      LOGICAL RRGO,RRT
      CHARACTER*250 RECORD
      CHARACTER*10 KARD(7),PVRDUM
      CHARACTER*2 FORST,FORDUM,DIST,PROD
      CHARACTER*3 ONOFF
      CHARACTER*4 IEND
      CHARACTER*8 KEYWRD,IAGERF,IPLTRF,TPCOM
      CHARACTER*11 CTARGET
      DATA IEND/'END '/
C
C  KEYWRD= THE KEYWORD OF INTEREST
C  NUMBER= OPTION NUMBER AS DETERMINED BY ORDER IN 'TABLE' VECTOR.
C  ISIZE = THE TABLE SIZE
C  IPTKNT= LSTKNT-1, THE NUMBER OR POINTS COUNTED BY **INTREE**
C    ICL1= TEMPORARY STORAGE FOR REFERENCE NUMBER FOR PRIMARY
C          KEYWORD FILE WHEN REFERENCE NUMBER FOR SECONDARY KEYWORD
C          FILE IS INPUT ON ADDFILE RECORD.
C  NONSTK= NUMBER OF NON-STOCKABLE POINTS
C  LFIRST= TRUE IF NO KEYWORDS HAVE BEEN READ FOR THIS STAND
C  LTRERD= TRUE IF TREEFMT CARD WAS READ.
C  LECON = TRUE IF OUTPUTS FOR CHEAPO ANALYSIS ARE DESIRED
C  LKECHO= TRUE IF KEYWORDS AND PARAMETER VALUES ARE ECHOED
C          TO THE MAIN OUTPUT FILE. BY DEFAULT = .TRUE.
C          CONTROLED WITH ECHOK AND NOECHO KEYWORDS.
C  JOSUME= LOGICAL UNIT NUMBER FOR CHEAPO ANALYSIS OUTPUT
C  LNOTBK= TRUE IF CORRESPONDING KEYWORD CARD NUMERIC FIELD IS
C          NON-BLANK.
C  ARRAY = HOLDS VALUES READ FROM KEYWORD CARD NUMERIC FIELDS.
C  RECORD= HOLDS AN EIGHTY COLUMN RECORD.
C  LNOTRE= TRUE IF NOTREES OPTION SPECIFIED.
C    SDLO= LOWER DIAMETER LIMIT SCREEN FOR INPUT TREE RECORDS (ge)
C    SDHI= UPPER DIAMETER LIMIT SCREEN FOR INPUT TREE RECORDS (lt)
C   ISDSP= SPECIES SCREEN FOR INPUT RECORDS
C
C     **********          EXECUTION BEGINS          **********
C
      LKECHO=.TRUE.
      JRECNT=0
      DEBUG = .FALSE.
      SDLO = 0.0
      SDHI = 999.0
      ISDSP= 0
      IGNDEF = 0
C----------
C  READ KEYWORDS
C----------
      LFIRST = .TRUE.
      IPSI=0
   10 CONTINUE
      call fvsGetRtnCode(IRTNCD)
      if (IRTNCD.ne.0) return

      CALL KEYRDR (IREAD,JOSTND,DEBUG,KEYWRD,LNOTBK,
     >             ARRAY,IRECNT,KODE,KARD,LFLAG,LKECHO)
C----------
C  RETURN KODES 0=NO ERROR,1=COLUMN 1 BLANK OR ANOTHER ERROR,2=EOF
C               LESS THAN ZERO...USE OF PARMS STATEMENT IS PRESENT.
C----------
      IF (KODE.LT.0) THEN
         IPRMPT=-KODE
      ELSE
         IPRMPT=0
      ENDIF
      IF (KODE.EQ.3) THEN
        CALL fvsSetRtnCode (2)
        RETURN
      ENDIF
      IF (KODE.LE.0) GO TO 30
      IF (KODE.NE.2) GOTO 20
C     NO STOP KEYWORD, BUT EOF WAS REACHED.
      IF (ICL1.EQ.0) THEN
        CALL ERRGRO(.FALSE.,2)
        CALL fvsGetRtnCode(IRTNCD)
        IF (IRTNCD.NE.0) RETURN
      ENDIF
      IREAD=ICL1
      ICL1=0
      GOTO 10
   20 CONTINUE
      CALL ERRGRO (.TRUE.,6)
      GOTO 10
   30 CONTINUE
      CALL FNDKEY (NUMBER,KEYWRD,TABLE,ISIZE,KODE,DEBUG,JOSTND)
C----------
C  RETURN KODES 0=NO ERROR,1=KEYWORD NOT FOUND
C----------
      IF (KODE .EQ. 1) THEN
         CALL ERRGRO (.TRUE.,1)
         GOTO 10
      ENDIF
C----------
C  IF VARIABLES ARE INITIALIZED FOR THE CURRENT STAND, THEN:
C  BRANCH TO OPTION PROCESSING
C----------
      IF (.NOT.LFIRST) GO TO 90
      LFIRST = .FALSE.
C----------
C  ELSE: INITIALIZE VARIABLES AND, IF LFLAG IS TRUE,
C  WRITE A HEADER.
C----------
      LNOTRE=.FALSE.
      CALL GRINIT
      CALL OPINIT
      CALL RANSED(.FALSE.,WK6(1))
      CALL ESINIT
      CALL MPBINT
      CALL DFBINT
      CALL TMINIT
      CALL BWEINT
      CALL CVINIT
      CALL RDINIT
      CALL MISIN0
      CALL MISINT
      CALL BRINIT
      CALL ISSTAG
      CALL FMINIT
      CALL SVINIT
      CALL ECINIT
      CALL DBSINIT
      CALL CLINIT
C----------
C     CALL TO ROOT DISEASE MODEL SUBROUTINE TO CHANGE DEFAULT
C     VALUE OF MINREP WHEN ROOT DISEASE ACTIVE
C----------
      CALL RDATV (RRGO,RRT)
      IF (RRGO) CALL RDESIN
C----------
C  INITIALIZE INTERNAL VARIABLES
C----------
      ITITLE=' '
      LTRERD = .FALSE.
      GO TO 90
C----------
C  SPECIAL END-OF-FILE TARGET
C----------
   80 CONTINUE
      CALL ERRGRO(.FALSE.,2)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN

   90 CONTINUE
C----------
C  PROCESS OPTIONS
C----------
      GO TO(  100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000,
     >       2100, 2200, 2300, 2400, 2500, 2600, 2700, 2800, 2900, 3000,
     >       3100, 3200, 3300, 3400, 3500, 3600, 3700, 3800, 3900, 4000,
     >       4010, 4020, 4030, 4040, 4050, 4060, 4070, 4080, 4100, 4200,
     >       4300, 4400, 4500, 4600, 4700, 4800, 4900, 5000, 5100, 5200,
     >       5300, 5400, 5500, 5600, 5700, 5800, 5900, 6000, 6100, 6200,
     >       6300, 6400, 6500, 6600, 6700, 6800, 6900, 7000, 7100, 7200,
     >       7300, 7400, 7500, 7600, 7700, 7800, 7900, 8000, 8100, 8200,
     >       8300, 8400, 8500, 8600, 8700, 8800, 8900, 9000, 9100, 9200,
     >       9300, 9400, 9500, 9600, 9700, 9800, 9900, 9950, 9975, 9985,
     >       9995,10000,10100,10200,10300,10400,10500,10600,10900,11000,
     >      11100,11200,11300,11400,11500,11600,11700,11800,11900,12000,
     >      12100,12200,12300,12400,12500,12600,12700,12800,12900,13000,
     >      13100,13200,13300,13400,13500,13600,13700,13800,13900,14000,
     >      14100,14200,14300,14400,14500,14600)
     >   , NUMBER
C
C  ==========  OPTION NUMBER 1: PROCESS  ============================PROCESS
C
  100 CONTINUE
      IF(.NOT.LKECHO)THEN
        IF(IRECNT.GT.JRECNT)THEN
          JRECNT=IRECNT-JRECNT-1
        ELSE
          JRECNT=IRECNT
        ENDIF
      ENDIF
      IF(.NOT.LKECHO)WRITE(JOSTND,95)JRECNT
  95  FORMAT(/T12,'THERE WERE',I8,' KEYWORD RECORDS PROCESSED.')
      WRITE(JOSTND,105) KEYWRD
  105 FORMAT (/A8,'   PROCESS THE STAND.')
C----------
C  MAKE SURE THAT NO EVENTS WERE LEFT OPEN
C----------
      IPRMPT=-1
      CALL EVEND (DEBUG,JOSTND,IRECNT,KEYWRD,ARRAY,LNOTBK,KARD,IPRMPT,
     &             LKECHO)
C---------
C  IF TREES ARE NOT EXPECTED, AND IF NO TREE RECORDS WERE READ,
C  THEN SET THE POINT COUNTS EQUAL TO 0.
C---------
      IF (.NOT.MORDAT .AND. LNOTRE) THEN
         LSTKNT=1
         NSTKNT=0
         MORDAT=.TRUE.
      ENDIF
C----------
C  ENSURE INTREE WAS CALLED AT LEAST ONCE
C----------
      IF (.NOT.MORDAT) THEN
         CALL INTREE (RECORD,0,ISDSP,SDLO,SDHI,LKECHO)
         CALL fvsGetRtnCode(IRTNCD)
         IF (IRTNCD.NE.0) RETURN
         MORDAT = .TRUE.
      ENDIF
C----------
C  ENSURE THAT GT 1 PROJECTABLE TREE RECORD HAS BEEN READ.
C----------
      IF (IREC1.LT.1 .AND. .NOT.LNOTRE) THEN
C----------
C        TOO FEW PROJECTABLE TREES; THEN: WRITE WARNING MSG,
C        SET LNOTRE ON, CONTINUE PROCESSING.
C----------
         CALL ERRGRO (.TRUE.,8)
         WRITE(JOSTND,106)
  106    FORMAT (T12,'(NOTREES OPTION IS AUTOMATICALLY INVOKED.)')
         LNOTRE=.TRUE.
         CALL ESEZCR(JOSTND,LKECHO)
         IREC1=0
         ITRN=0
         LSTKNT=1
         NSTKNT=0
      ENDIF
C----------
C  PROCESS DAMAGE CODES STORED AT READING OF INPUT TREE DATA.
C----------
      CALL DAMPRO
C----------
C     CALL TRESOR TO MATCH TREE ID NUMBERS WITH TREE INDEX NUMBERS
C     ASSIGNED IN INTREE. THIS IS NEEDED TO INSURE THAT TREE DATA
C     NEEDED BY ANY EXTENSIONS THAT MAY BE ACTIVE ARE MAPPED TO THE
C     APPROPRIATE TREE RECORDS.
C----------
      CALL TRESOR
C----------
C     IF DATA CONFLICTS ARE PRESENT CONCERNING PLOT COUNTS
C     ASSUME THAT THE DESIGN CARD IS CORRECT AND WRITE A WARNING
C
C  ADDITIONAL TESTING AND VALIDATION OF PLOT COUNTS SPECIFIED ON DESIGN
C  KEYWORD OR NUM_PLOTS OF INPUT DATABASE STANDINIT TABLE TO ENSURE THAT
C  TREE RECORD PLOT ID CAN BE USED IN PROCESSES UTILITZING PLOT LEVEL
C  VARIABLES, SUCH AS DENSITIES, CAN BE USED AND TPA EXPANSIONS ARE CORRECT:
C    1 - IF NUM_PLOTS IS 1 ALL TREE RECORD PLOT IDS WILL BE SET TO 1.
C        (THIS IS HANDLED IN SUBROUTINE INTREE.F)
C    2 - IF NUM_PLOTS IS >1 AND COUNTED TREE RECORD PLOT IDS IS LESS THAN
C        THAT VALUE, PRESENCE OF NONSTOCKED PLOTS IS ASSUMED.
C        (THIS IS A DEFAULT BEHAVIOR)
C    3   IF NUM_PLOTS IS >1 AND COUNTED TREE RECORD PLOT IDS IS GREATER THAN
C        THAT VALUE, THE RUN WILL BE TERMINATED BECAUSE ACCURATE TPA VALUES
C        CAN NOT BE CALCULATED.
C----------
      IPTKNT = LSTKNT - 1
      IF ( IPTINV .EQ. -9999 ) IPTINV = IPTKNT
      IF ( NONSTK .EQ. -9999 ) NONSTK = NSTKNT
      IF (IPTINV.LE.0) IPTINV=1
      IF (IPTINV.GT.MAXPLT) IPTINV = IPTKNT
C
C     MORE THAN 1 PLOT SPECIFIED, BUT ADDITIONAL PLOTS FOUND IN TREEDATA
      IF (IPTINV.GT.1 .AND. IPTINV.LT.IPTKNT)
     >     CALL ERRGRO (.FALSE.,38)

      IF ((IPTINV.NE.IPTKNT.OR.NONSTK.NE.NSTKNT).AND. .NOT.LNOTRE)
     >     CALL ERRGRO (.TRUE.,9)

      PI = FLOAT ( IPTINV )
      IF (SAMWT .LT. 0.) SAMWT=FLOAT(IPTINV)
C----------
C  SET UP A STAND DENSITY AMPLIFIER. GROSPC IS USED TO ADJUST STAND
C  DENSITY ESTIMATES BY REMOVING THE AREA ASSOCIATED WITH NON-STOCKABLE
C  PLOTS FROM THE STAND AREA ESTIMATES.  FOR FIXED AREA PLOTS, THE NON-
C  STOCKABLE AREA SHOULD BE REMOVED FROM THE STAND AREA ESTIMATE PRIOR
C  TO INPUT.  IF GROSPC IS LT 0, COMPUTE IT HERE...ELSE ITS READ IN.
C----------
      IF (GROSPC.LT.0.0) THEN
         GROSPC=(PI-FLOAT(NONSTK))/PI
         IF (GROSPC.GT.1.0) GROSPC = 1.0
         IF((PI-FLOAT(NONSTK)).LE.0.)THEN
            GROSPC=1.
            CALL ERRGRO (.TRUE.,35)
         ENDIF
      ENDIF
C
C     WRITE THE END DELIMITER TO THE INPUT OPTIONS TABLE
C
      WRITE(JOSTND,120)
  120 FORMAT (130('-'))
C
C     WRITE THE STATUS OF THE DEFAULT OPTIONS.
C
      WRITE(JOSTND,130)
  130 FORMAT (/T49,'OPTIONS SELECTED BY DEFAULT'//130('-'))
      IF (.NOT.LTRERD)WRITE(JOSTND,133) TREFMT(1:80),
     &                                               TREFMT(81:160)
  133 FORMAT (/'TREEFMT    ',A80/T12,A80)
      WRITE(JOSTND,2010) 'DESIGN',BAF,FPA,BRK,IPTINV,NONSTK,
     >                     SAMWT,GROSPC
      IF (GROSPC.NE.1.0)WRITE(JOSTND,134) GROSPC
  134 FORMAT(T12,'STAND ATTRIBUTES ARE CALCULATED PER ACRE OF ',
     &   'STOCKABLE AREA.  STAND STATISTICS'/
     &  T12,'IN SUMMARY TABLE ARE MULTIPLIED BY ',F5.3,
     &     ' TO INCLUDE TOTAL STAND AREA.')
C
C     ACTUALLY, WE DIVIDE THE STATISTICS BY THE INVERSE!...
C
      GROSPC=1./GROSPC
C
      IF(KODFOR .EQ. 0)CALL FORKOD
      IF(KODTYP .EQ. 0)THEN
        ARRAY(2)=0
        KARD(2)='          '
        CALL HABTYP (KARD(2),ARRAY(2))
      ENDIF
C
      SELECT CASE (VARACD)
C
        CASE ('CR','UT','TT','WS')
          WRITE (JOSTND,139) KODFOR,KARD(2),KODTYP,IAGE,
     &    ASPECT,SLOPE,ELEV,ADJUSTL(CPVREF)
  139     FORMAT (/'STDINFO    FOREST-LOCATION CODE=',I6,
     >    '; HABITAT TYPE=',A10,' (CODE ',I3,')',
     >    '; AGE=',I5,'; ASPECT AZIMUTH IN DEGREES= ',F4.0,
     >    ';',/T12,' SLOPE= ' ,F4.0,'%',
     >    ';  ELEVATION(100''S FEET)=',F5.1,'; REFERENCE CODE= ',A4)
C
        CASE ('AK')
          WRITE (JOSTND,131) KODFOR,KODTYP,IAGE,ASPECT,
     >                     SLOPE,ELEV,ADJUSTL(CPVREF)
  131     FORMAT (/'STDINFO    FOREST-LOCATION CODE=',I8,
     >    '; HABITAT TYPE=',I3,
     >    '; AGE=',I5,'; ASPECT AZIMUTH IN DEGREES= ',F4.0,
     >    '; SLOPE= ' ,F4.0,'%'/
     >    T12,'ELEVATION(100''S FEET)=',F5.1,';  REFERENCE CODE= ',A4)
C
        CASE ('SN')
          WRITE(JOSTND,135) KODFOR,PCOM,
     >                    IAGE,ASPECT,SLOPE,ELEV,ADJUSTL(CPVREF)
  135     FORMAT (/'STDINFO    FOREST-LOCATION CODE=',I8,
     >    '; ECOLOGICAL UNIT=',A10,
     >    '; AGE=',I5,'; ASPECT AZIMUTH IN DEGREES= ',F4.0,
     >    '; SLOPE= ',F4.0,'%'/
     >    T12,'ELEVATION(100''S FEET)=',F5.1,';  REFERENCE CODE= ',A4)
C
        CASE DEFAULT
          WRITE (JOSTND,138) KODFOR,KODTYP,IAGE,ASPECT,
     >                     SLOPE,ELEV,ADJUSTL(CPVREF)
  138     FORMAT (/'STDINFO    FOREST-LOCATION CODE=',I8,
     >    '; HABITAT TYPE=',I3,
     >    '; AGE=',I5,'; ASPECT AZIMUTH IN DEGREES= ',F4.0,
     >    '; SLOPE= ' ,F4.0,'%'/
     >    T12,'ELEVATION(100''S FEET)=',F5.1,';  REFERENCE CODE= ',A4)
C
      END SELECT
C
C     SAVE INPUT SLOPE AND ASPECT VALUES IN NON-DECODED VALUES.
C
      IASPEC=IFIX(ASPECT)
      ISLOP=IFIX(SLOPE)
C
C   CALL SITSET TO SET CONTROLLING VALUES THAT HAVE NOT BEEN SET
C   USING KEYWORDS.  THEN DUMP SITE INDEX ARRAY.
C
      CALL SITSET
      IF(ISISP.GT.0 .AND. ISISP.LE.MAXSP)THEN
        STNDSI=SITEAR(ISISP)
      ELSE
        STNDSI=0.
      ENDIF
C----------
C  WIPE OUT DEFECT PERCENTAGES READ ON INPUT DATA IF REQUESTED.
C----------
      IF(IGNDEF .GT. 0)THEN
        DO 209 I=1,MAXTRE
        DEFECT(I)=0
 209    CONTINUE
      ENDIF
C----------
C  WRITE SITE INDEX CROSS REFERENCE TABLE
C----------
      IF (IPSI.GT.0 .OR. ISISP.GT.0) THEN
         WRITE(JOSTND,210) TABLE(94)
 210     FORMAT(/A8,'   SITE INDEX INFORMATION:')
         WRITE(JOSTND,211) (NSP(I,1)(1:2),SITEAR(I),I=1,MAXSP)
 211     FORMAT ((T12,8(A3,'=',F6.0,:,'; '),A,'=',F6.0))
         IF(ISISP.GT.0)THEN
           WRITE(JOSTND,212) NSP(ISISP,1)(1:2),ISISP
 212       FORMAT(T12,'SITE SPECIES=',A,' CODE=',I5)
         ELSE
           WRITE(JOSTND,213) ISISP
 213       FORMAT(T12,'SITE SPECIES NOT SPECIFIED.  CODE=',I5)
        ENDIF
        IF(VARACD.EQ.'NI' .OR. VARACD.EQ.'KT') THEN
          WRITE(JOSTND,214)
 214      FORMAT(T12,'NOTE: SITE INDEX IS NOT USED IN THIS VARIANT.',
     &    '  VALUES ARE PRINTED FOR INFORMATIONAL PURPOSES.' )
        ENDIF
        IF(NSITET.GT.0)THEN
          WRITE(JOSTND,2141)
 2141     FORMAT(/T12,'SITE INDEX TREE INPUT SUMMARY TABLE:',/,
     &    T12,'SPECIES',2X,'DIAMETER',4X,'HEIGHT',6X,'AGE',5X,'AGE REF',
     &    4X,'PLOT REF',/T12,'-------',2X,'--------',4X,'------',6X,
     &    '---',5X,'-------',4X,'--------')
          DO 2143 I=1,NSITET
          IAGERF='        '
          IPLTRF='        '
          IF(SITETR(I,5).EQ.1)IAGERF='   TOTAL'
          IF(SITETR(I,5).EQ.2)IAGERF='  BREAST'
          IF(SITETR(I,6).EQ.1)IPLTRF='      ON'
          IF(SITETR(I,6).EQ.2)IPLTRF='     OFF'
          IISP=INT(SITETR(I,1))
          WRITE(JOSTND,2142)IISP,NSP(IISP,1)(1:2),(SITETR(I,J),J=2,4),
     &                      IAGERF,IPLTRF
 2142     FORMAT(T11,I3,' ('A2,')',2F10.1,F10.0,3X,A8,2X,A8)
 2143     CONTINUE
        ENDIF
      ENDIF
C----------
C  WRITE INVENTORY POINT CROSS REFERENCE TABLE
C----------
        WRITE(JOSTND,215)
 215    FORMAT(/,'INVENTORY POINT CROSS REFERENCE ',
     &  '(FVS SEQUENTIAL POINT NUMBER = POINT NUMBER AS ENTERED IN THE',
     &  ' INPUT DATA):')
        WRITE(JOSTND,216) (I,IPVEC(I),I=1,IPTINV)
 216    FORMAT ((8(I3,'=',I8,:,'; '),I3,'=',I8))
C----------
C     WRITE THE END DELIMITER TO THE DEFAULT OPTIONS TABLE
C----------
      CALL LBDSET (JOSTND,LKECHO)
      IF(LKECHO)WRITE(JOSTND,120)
C----------
C  CALL TRNSLO TO TRANSFORM SLOPE CODE TO A RATIO.
C----------
      CALL TRNSLO
C----------
C  CALL TRNASP TO TRANSFORM ASPECT TO RADIANS.
C----------
      CALL TRNASP
*C----------
*C  CALL SDICAL TO CALCULATE MAX SDI FOR STAND AND PLOTS
*C     RECENT MORTALITY IS INCLUDED FOR THIS ONE.
*C----------
*      CALL SDICAL(1,SDIMAX)
C----------
C     CALL ESTAB PLOT-SPECIFIC PROCESSING.
C----------
      CALL ESPLT2 (IPTKNT)
      RETURN
C----------
C  **********          SET OPTIONS          **********
C----------
 9999 FORMAT (/A8)
C
C  ==========  OPTION NUMBER 2: TIMEINT  ============================TIMEINT
C
 1200 CONTINUE
      I2=10
      IF (LNOTBK(2)) I2 = IFIX(ARRAY(2))
      IF (.NOT.LNOTBK(1)) GO TO 1220
      I = IABS(IFIX(ARRAY(1))) + 1
      IF (I.EQ.1) GOTO 1220
      IF (I.GT.MAXCY1) THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
      IY(I) = I2
      I=I-1
      IF(LKECHO)WRITE(JOSTND,1215) KEYWRD,I,I2
 1215 FORMAT(/A8,3X,'CYCLE=',I3,'; PERIOD LENGTH=',I3)
      GO TO 10
 1220 CONTINUE
      DO 1230 I=2,MAXCY1
      IY(I) = I2
 1230 CONTINUE
      IF(LKECHO)WRITE(JOSTND,1235) KEYWRD,I2
 1235 FORMAT(/A8,3X,'ALL CYCLES;  PERIOD LENGTH=',I3)
      GO TO 10
C
C  ==========  OPTION NUMBER 3: FIXCW     =============================FIXCW
C
 1300 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,90,KEYWRD,KARD,
     >                   IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
      ELSE
C
C        SPECIES CODE PROCESSING.
C
         CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &                ARRAY,KARD)
         IF (IS.EQ.-999) GOTO 10
         IF(.NOT.LNOTBK(3))ARRAY(3)=1.
         IF(.NOT.LNOTBK(4))ARRAY(4)=0.
         IF(.NOT.LNOTBK(5))ARRAY(5)=999.
         ILEN=3
         IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
         IF(LKECHO)WRITE(JOSTND,1330) KEYWRD,IDT,KARD(2)(1:ILEN),
     >                                IS,ARRAY(3),ARRAY(4),ARRAY(5)
 1330    FORMAT (/A8,'   DATE/CYCLE=',I5,'; SPECIES=',A,' (CODE=',
     >   I3,'); CROWN WIDTH MULTIPLIER=',F10.4/
     >   T12,'ONLY TREES GREATER THAN OR EQUAL TO ',F7.2,
     >   ' AND LESS THAN ',
     >   F7.2,' INCHES DBH ARE AFFECTED.')
         CALL OPNEW (KODE,IDT,90,4,ARRAY(2))
         IF (KODE.GT.0) GOTO 10
      ENDIF
      GOTO 10
C
C  ==========  OPTION NUMBER 4: TREEDATA  ===========================TREEDATA
C
 1400 CONTINUE
      IF ( LNOTBK(1) ) ISTDAT = IFIX (ARRAY(1))
      I=0
      IF (LNOTBK(2)) I=1
      IF (LNOTBK(3)) SDLO=ARRAY(3)
      IF (LNOTBK(4)) SDHI=ARRAY(4)
C
C       SPECIES CODE PROCESSING.
C
      IS=0
      IF (LNOTBK(5))THEN
        CALL SPDECD (5,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
        IF (IS.EQ.-999) GOTO 10
        ISDSP=IS
      ENDIF
C
      IF(LKECHO)WRITE(JOSTND,1410) KEYWRD,ISTDAT
 1410 FORMAT (/A8,'   DATA SET REFERENCE NUMBER=',I3)
      IF(IS.NE.0) THEN
        ILEN=3
        IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
        IF(LKECHO .AND. LNOTBK(5))WRITE(JOSTND,1411) 'SPECIES= ',
     >   KARD(5)(1:ILEN),IS,'IS'
 1411   FORMAT (T12,A,A,' (CODE= ',I3,') ',A,
     >           ' TARGETED FOR SCREENING.')
      ELSE
         IF(LKECHO .AND. LNOTBK(5))WRITE(JOSTND,1411) 'ALL',' SPECIES',
     >   IS,'ARE'
      ENDIF
      IF((LNOTBK(3) .OR. LNOTBK(4)).AND.LKECHO)
     >WRITE(JOSTND,1405)SDLO,SDHI
 1405 FORMAT(T12,'ONLY RECORDS WITH DIAMETERS GE',F6.1,
     &      ' INCHES OR LT',F6.1,' INCHES WILL BE READ FROM THE DATA.',
     &      /T12,'ALL OTHER INPUT RECORDS WILL BE SCREENED OUT.')
      IF((I.EQ.1).AND.LKECHO)WRITE(JOSTND,1420)
 1420 FORMAT (T12,'PLOT SPECIFIC SITE DATA READ FROM TREE RECORDS.')
      CALL INTREE (RECORD,I,ISDSP,SDLO,SDHI,LKECHO)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN
      MORDAT = .TRUE.
      GO TO 10
C
C  ==========  OPTION NUMBER 5: TREEFMT  ============================TREEFMT
C
 1500 CONTINUE
      LTRERD = .TRUE.
      IF(LKECHO)WRITE(JOSTND,9999) KEYWRD
      READ (IREAD,1550,END=80) TREFMT(1:80),TREFMT(81:160)
 1550 FORMAT (A80/A80)
      IRECNT = IRECNT + 2
      IF(LKECHO)WRITE(JOSTND,1560) TREFMT (1:80), TREFMT (81:160)
 1560 FORMAT (T11,A80/T11,A80)
      IF (MORDAT) CALL ERRGRO (.TRUE.,7)
      GO TO 10
C
C  ==========  OPTION NUMBER 6: MPB  ================================MPB
C
 1600 CONTINUE
      IF(LKECHO)WRITE(JOSTND,1610) KEYWRD
 1610 FORMAT (/A8,'   MOUNTAIN PINE BEETLE OPTIONS:')
      CALL MPBIN (KEYWRD,ARRAY,LNOTBK,LKECHO)
      GO TO 10
C
C  ==========  OPTION NUMBER 7: DFTM  ===============================DFTM
C
 1700 CONTINUE
      IF(LKECHO)WRITE(JOSTND,1710) KEYWRD
 1710 FORMAT (/A8,'   DOUGLAS-FIR TUSSOCK MOTH OPTIONS:')
      CALL DFTMIN(LKECHO)
      GO TO 10
C
C  ==========  OPTION NUMBER 8: WSBW  ===============================WSBW
C
 1800 CONTINUE
      IF(LKECHO)WRITE(JOSTND,1810) KEYWRD
 1810 FORMAT (/A8,'   WESTERN SPRUCE BUDWORM OPTIONS:')
C
C     IF BUDLITE MODEL IS BEING RUN, THE FOLLOWING CALL IS USED
C
      CALL BWEIN(LKECHO)
      GO TO 10
C
C  ==========  OPTION NUMBER 9: CWEQN  ============================CWEQN
C
 1900 CONTINUE
C
C     READ COEFFICIENTS FROM A SUPPLEMENTAL RECORD.
C
      READ(IREAD,1905,END=80) (WK6(I),I=1,8)
 1905 FORMAT(8F10.0)
      IRECNT=IRECNT+1
C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (1,ISPC,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(ISPC.EQ.-999) GO TO 10
      TC=ARRAY(2)
C----------
C     IF (ISPC<0) CHANGE ALL SPECIES IN THE GROUP
C----------
      IF(ISPC .LT. 0) THEN
        IGRP = -ISPC
        IULIM = ISPGRP(IGRP,1)+1
        DO 1906 IG=2,IULIM
        IGSP = ISPGRP(IGRP,IG)
        LSPCWE(IGSP)=.TRUE.
        CWTDBH(IGSP)=TC
        CWDS0(IGSP)=WK6(1)
        CWDS1(IGSP)=WK6(2)
        CWDS2(IGSP)=WK6(3)
        CWDS3(IGSP)=WK6(4)
        CWDL0(IGSP)=WK6(5)
        CWDL1(IGSP)=WK6(6)
        CWDL2(IGSP)=WK6(7)
        CWDL3(IGSP)=WK6(8)
 1906   CONTINUE
        ILEN=ISPGRP(-ISPC,92)
        IF(LKECHO)WRITE(JOSTND,1918) KEYWRD,KARD(1)(1:ILEN),ISPC
C----------
C     IF (ISPC=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C----------
      ELSEIF(ISPC .EQ. 0)THEN
        DO 1907 I=1,MAXSP
        LSPCWE(I)=.TRUE.
        CWTDBH(I)=TC
        CWDS0(I)=WK6(1)
        CWDS1(I)=WK6(2)
        CWDS2(I)=WK6(3)
        CWDS3(I)=WK6(4)
        CWDL0(I)=WK6(5)
        CWDL1(I)=WK6(6)
        CWDL2(I)=WK6(7)
        CWDL3(I)=WK6(8)
 1907   CONTINUE
        IF(LKECHO)WRITE(JOSTND,1908) KEYWRD
 1908   FORMAT(/A8,T12,'DEFAULT COEFFICIENTS FOR CROWN WIDTH',
     &         ' EQUATIONS REPLACED FOR ALL SPECIES.')
C----------
C     SPECIES CODE IS SPECIFIED (IS>0).
C----------
      ELSE
        LSPCWE(ISPC)=.TRUE.
        CWTDBH(ISPC)=TC
        CWDS0(ISPC)=WK6(1)
        CWDS1(ISPC)=WK6(2)
        CWDS2(ISPC)=WK6(3)
        CWDS3(ISPC)=WK6(4)
        CWDL0(ISPC)=WK6(5)
        CWDL1(ISPC)=WK6(6)
        CWDL2(ISPC)=WK6(7)
        CWDL3(ISPC)=WK6(8)
        ILEN=3
        IF(LKECHO)WRITE(JOSTND,1918) KEYWRD,KARD(1)(1:ILEN),ISPC
 1918   FORMAT(/A8,T12,'DEFAULT COEFFICIENTS FOR CROWN WIDTH',
     &    ' EQUATIONS REPLACED FOR SPECIES= ',A,' (CODE= ',I3,').' )
      ENDIF
C
      IF(LKECHO)WRITE(JOSTND,1925) TC,(WK6(I),I=1,8)
 1925 FORMAT(T12,'TRANSITION SIZE = ',F10.2,' INCHES DBH.',
     &  '   EQUATION FORM: C0 + C1*DBH +C2*DBH**C3'/
     &  T12,'COEFFICIENTS FOR TREES THAT ARE SMALLER THAN',
     &  ' TRANSITION SIZE:'/T12,' C0= ',F12.5,'  C1= ',F12.5,'  C2= ',
     &  F12.5,'  C3= ',F12.5,/
     &        T12,'COEFFICIENTS FOR TREES THAT ARE LARGER THAN',
     &  ' TRANSITION SIZE:'/T12,' C0= ',F12.5,'  C1= ',F12.5,'  C2= ',
     &  F12.5,'  C3= ',F12.5)
      GO TO 10
C
C  ==========  OPTION NUMBER 10: DESIGN  ============================DESIGN
C
 2000 CONTINUE
      IF ( LNOTBK(1) ) BAF = ARRAY(1)
      IF ( LNOTBK(2) ) FPA = ARRAY(2)
      IF ( LNOTBK(3) ) BRK = ARRAY(3)
      IF ( LNOTBK(4) ) IPTINV = IFIX( ARRAY(4) )
      IF ( LNOTBK(5) ) NONSTK = IFIX( ARRAY(5) )
      IF ( LNOTBK(6) ) SAMWT = ARRAY(6)
      IF (SAMWT.LE.0. .AND. IPTINV.GT.0) SAMWT=FLOAT(IPTINV)
      IF (ARRAY(7).GT.1.0 .AND. ARRAY(7).LE.100.) ARRAY(7)=ARRAY(7)*.01
      IF (ARRAY(7).GT.0.0 .AND. ARRAY(7).LE.1.0)  GROSPC  =ARRAY(7)
      IF (GROSPC.LT.0.) THEN
         XXG=1.0
         IF (IPTINV.GT.0 .AND. NONSTK.GT.0 .AND.
     >       IPTINV-NONSTK.GT.0) XXG=(FLOAT(IPTINV)-FLOAT(NONSTK))/
     >                                FLOAT(IPTINV)
      ELSE
         XXG=GROSPC
      ENDIF
      IF(LKECHO)WRITE(JOSTND,2010) KEYWRD,BAF,FPA,BRK,
     >     MAX(0,IPTINV),MAX(0,NONSTK),MAX(0.,SAMWT),XXG
 2010 FORMAT (/A,T12,'BASAL AREA FACTOR= ',F6.1,
     >        '; INVERSE OF FIXED PLOT AREA= ',F6.1,
     >        '; BREAK DBH= ',F6.1/T12,'NUMBER OF PLOTS= ',I5,
     >        '; NON-STOCKABLE PLOTS= ',I5,
     >        '; STAND SAMPLING WEIGHT=',F12.5/T12,
     >        'PROPORTION OF STAND CONSIDERED STOCKABLE= ',F6.3)
      IF(LKECHO)WRITE(JOSTND,2030)
 2030 FORMAT (T12,'SEE "OPTIONS SELECTED BY DEFAULT" FOR FINAL ',
     >         'DESIGN VALUES.')
      GO TO 10
C
C  ==========  OPTION NUMBER 11: NUMCYCLE  ==========================NUMCYCLE
C
 2100 CONTINUE
      IF (ARRAY(1).GE.1. .AND. IFIX(ARRAY(1)).LE.MAXCYC) GOTO 2110
      CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
      CALL ERRGRO (.TRUE.,4)
      GOTO 10
 2110 CONTINUE
      NCYC = IFIX ( ARRAY(1) )
      IF(LKECHO)WRITE(JOSTND,2120) KEYWRD,NCYC
 2120 FORMAT (/A8,'   NUMBER OF CYCLES=',I3)
      GO TO 10
C
C  ==========  OPTION NUMBER 12: TFIXAREA  ==========================TFIXAREA
C
 2200 CONTINUE
      IF ( LNOTBK(1) ) TFPA = ARRAY(1)
      IF(LKECHO)WRITE(JOSTND,2210) KEYWRD,TFPA
 2210 FORMAT (/A8,'   TOTAL FIXED PLOT AREA=',F10.3)
      GO TO 10
C
C  ==========  OPTION NUMBER 13: GROWTH  ============================GROWTH
C
 2300 CONTINUE
      IF(LNOTBK(1)) IDG = IFIX(ARRAY(1))
      IF(LNOTBK(2).AND.ARRAY(2).GT.0.) IFINT = IFIX(ARRAY(2))
      FINT = FLOAT(IFINT)
      IF(LNOTBK(3)) IHTG = IFIX(ARRAY(3))
      IF(LNOTBK(4).AND.ARRAY(4).GT.0.) IFINTH = IFIX(ARRAY(4))
      FINTH = FLOAT(IFINTH)
      IF(LNOTBK(5).AND.ARRAY(5).GT.0.) FINTM=ARRAY(5)
      I=IFIX(FINTM)
      IF(LKECHO)WRITE(JOSTND,2310) KEYWRD,IDG,IFINT,IHTG,IFINTH,I
 2310 FORMAT (/A8,'   DIAMETER GROWTH DATA TYPE CODE= ',I1,
     >        ', ',I3,' YEAR MEASUREMENT PERIOD;' /
     >        T12,'HEIGHT GROWTH DATA TYPE CODE  = ',I1,
     >        ', ',I3,' YEAR MEASUREMENT PERIOD;'/
     >        T12,'MORTALITY MEASUREMENT PERIOD  =',I2)
      GO TO 10
C
C  ==========  OPTION NUMBER 14: STDINFO  ===========================STDINFO
C
 2400 CONTINUE
      KODFOR=IFIX(ARRAY(1))
      CALL FORKOD
      IF ( LNOTBK(7) )THEN
        WRITE(CPVREF,'(I10)')IFIX(ARRAY(7))
      ELSE
        CPVREF='          '
      ENDIF
      if(lnotbk(2))then
        KODTYP=IFIX(ARRAY(2))
        ICL5=KODTYP
        CALL HABTYP (KARD(2),ARRAY(2))
        IF (ICL5.LE.0) ICL5=KODTYP
      endif
      IF ( LNOTBK(3) ) IAGE = IFIX( ARRAY(3) )
      IF ( LNOTBK(4) ) ASPECT = ARRAY(4)
      IF ( LNOTBK(5) ) SLOPE = ARRAY(5)
      IF ( LNOTBK(6) .AND. ARRAY(6).GT.0) ELEV = ARRAY(6)
C
      SELECT CASE (VARACD)
C
        CASE ('CR','UT','TT','WS')
          IF(LKECHO)WRITE (JOSTND,2411) KEYWRD,KODFOR,KARD(2),KODTYP,
     >                    IAGE,ASPECT,SLOPE,ELEV,ADJUSTL(CPVREF)
 2411     FORMAT (/A8,'   FOREST-LOCATION CODE=',I6,
     >    '; HABITAT TYPE=',A10,' (CODE ',I3,')',
     >    '; AGE=',I5,'; ASPECT AZIMUTH IN DEGREES= ',F4.0,
     >    ';',/T12,' SLOPE= ' ,F4.0,'%',
     >    ';  ELEVATION(100''S FEET)=',F5.1,'; REFERENCE CODE= ',A4)
C
        CASE ('AK')
          IF(LKECHO)WRITE (JOSTND,2412) KEYWRD,KODFOR,KODTYP,
     >                    IAGE,ASPECT,SLOPE,ELEV,ADJUSTL(CPVREF)
 2412     FORMAT (/A8,'   FOREST-LOCATION CODE=',I8,
     >    '; HABITAT TYPE=',I3,
     >    '; AGE=',I5,'; ASPECT AZIMUTH IN DEGREES= ',F4.0,
     >    '; SLOPE= ',F4.0,'%'/
     >    T12,'ELEVATION(100''S FEET)=',F5.1,'; REFERENCE CODE= ',A4)
C
        CASE ('SN')
          IF(LKECHO)WRITE(JOSTND,2413) KEYWRD,KODFOR,PCOM,
     >                    IAGE,ASPECT,SLOPE,ELEV,ADJUSTL(CPVREF)
 2413     FORMAT (/A8,'   FOREST-LOCATION CODE=',I8,
     >    '; ECOLOGICAL UNIT=',A10,
     >    '; AGE=',I5,'; ASPECT AZIMUTH IN DEGREES= ',F4.0,
     >    '; SLOPE= ',F4.0,'%'/
     >    T12,'ELEVATION(100''S FEET)=',F5.1,'; REFERENCE CODE= ',A4)
C
        CASE DEFAULT
          IF(LKECHO)WRITE (JOSTND,2410) KEYWRD,KODFOR,KODTYP,
     >                    IAGE,ASPECT,SLOPE,ELEV,ADJUSTL(CPVREF)
 2410     FORMAT (/A8,'   FOREST-LOCATION CODE=',I8,
     >    '; HABITAT TYPE=',I3,
     >    '; AGE=',I5,'; ASPECT AZIMUTH IN DEGREES= ',F4.0,
     >    '; SLOPE= ',F4.0,'%'/
     >    T12,'ELEVATION(100''S FEET)=',F5.1,'; REFERENCE CODE= ',A4)
C
      END SELECT
      GO TO 10
C
C  ==========  OPTION NUMBER 15: STDIDENT  ==========================STDIDENT
C
 2500 CONTINUE
      IF(LKECHO)WRITE(JOSTND,9999) KEYWRD
      READ (IREAD,'(A)',END=80) RECORD
      I1=0
      DO K=1,26
      IF(RECORD(K:K).NE.' ') THEN
        I1=K
        GO TO 2505
      ENDIF
      ENDDO
 2505 CONTINUE
      I2=26
      IF(I1.GT.0) THEN
        DO K=I1,26
        IF(RECORD(K:K).EQ.' ') THEN
          I2=K
          GO TO 2506
        ENDIF
        ENDDO
 2506   CONTINUE
        NPLT=RECORD(I1:I2)
      ELSE
        NPLT=' '
      ENDIF
      ITITLE=RECORD(I2+1:)
      IRECNT = IRECNT + 1
      IF(LKECHO)WRITE(JOSTND,2510) NPLT,ITITLE
 2510 FORMAT (T12,'STAND ID= ',A,8X,A)
      GO TO 10
C
C  ==========  OPTION NUMBER 16: INVYEAR  ===========================INVYEAR
C
 2600 CONTINUE
      IF ( LNOTBK(1) ) IY(1) = IFIX(ARRAY(1))
      IF(LKECHO)WRITE(JOSTND,2610) KEYWRD,IY(1)
 2610 FORMAT (/A8,'   INVENTORY YEAR=',I5)
      GO TO 10
C
C  ==========  OPTION NUMBER 17: TREELIST  ==========================TREELIST
C
 2700 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
      IF (.NOT.LNOTBK(2)) ARRAY(2)=FLOAT(JOLIST)
      NP = 2
      IF (LNOTBK(4)) NP = 3
      IF(LNOTBK(5) .AND. ARRAY(5).GT.0) THEN
        NP = 4
      ENDIF
      IF(LNOTBK(6) .AND. ARRAY(6).GT.0) NP = 5
      IF(LNOTBK(7).AND.ARRAY(7).GT.0.AND.(IDT.EQ.0.OR.IDT.EQ.1)
     &.AND.(.NOT.(LNOTBK(4).AND.ARRAY(4).EQ.1)))NP=6
      CALL OPNEW (KODE,IDT,80,NP,ARRAY(2))
      IF (KODE.GT.0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,2710) KEYWRD,IDT,ARRAY(2),ARRAY(3)
 2710 FORMAT (/A8,'   DATE/CYCLE=',I5,'; DATA SET REFERENCE ',
     >        'NUMBER =',F4.0,'; HEADING SUPPRESSION CODE =',F3.0/
     >        T12,'(0=WITH HEADING, OTHER VALUES=SUPPRESS HEADING).')
      IF((NP.GE.3).AND.(ARRAY(4).EQ.1.).AND.LKECHO)WRITE(JOSTND,2720)
 2720 FORMAT (T12,'CYCLE ZERO TREELIST SUPPRESSED.')
      IF((NP.GE.3).AND.(ARRAY(4).EQ.2.).AND.LKECHO)WRITE(JOSTND,2721)
 2721 FORMAT (T12,'CYCLE ONE TREELIST SUPPRESSED.')
      IF((ARRAY(5).GT.0).AND.LKECHO)WRITE(JOSTND,2740)
 2740 FORMAT(T12,'TREELIST WILL REPORT DEAD TREE STATISTICS.')
      IF((NP.EQ.6).AND.LKECHO)WRITE(JOSTND,2745)
 2745 FORMAT(T12,'ESTIMATED DIAMETER GROWTHS WILL BE PRINTED ON THE',
     &' CYCLE 0 TREELIST FOR TREES WITH NO MEASURED DIAMETER GROWTH.')
      GOTO 10
C
C  ==========  OPTION NUMBER 18: REWIND  ============================REWIND
C
 2800 CONTINUE
      I = ISTDAT
      IF ( ARRAY(1) .GE. 1. ) I = IFIX ( ARRAY(1) )
      IF(LKECHO)WRITE(JOSTND,1410) KEYWRD,I
      REWIND I
      GO TO 10
C
C  ==========  OPTION NUMBER 19: NOSUM  =============================NOSUM
C
 2900 CONTINUE
      IF(LKECHO)WRITE(JOSTND,2910) KEYWRD
 2910 FORMAT (/A8,'   NO SUMMARY OUTPUT WILL BE WRITTEN.')
      LSUMRY = .FALSE.
      GO TO 10
C
C  ==========  OPTION NUMBER 20: DEBUG  =============================DEBUG
C
 3000 CONTINUE
      IF(LNOTBK(3)) JOSTND=IFIX(ARRAY(3))
      IDBCYC=IFIX(ARRAY(1))
      IF ((IDBCYC.LT.0).OR.(IDBCYC.GT.MAXCYC)) IDBCYC=0
      IF (IDBCYC.EQ.0) THEN
        IF(LKECHO)WRITE(JOSTND,3010) KEYWRD
 3010   FORMAT (/A8,'   DEBUG, ALL CYCLES. ')
      ELSE
        IF(LKECHO)WRITE(JOSTND,3020) KEYWRD,IDBCYC
 3020   FORMAT (/A8,'   DEBUG, CYCLE=',I2,'. ')
      ENDIF
      IF (LNOTBK(2)) THEN
        CALL DBPRSE (IREAD,RECORD,JOSTND,IDBCYC,IRC)
        IF (IRC.EQ.1) GOTO 80
      ELSE
        CALL DBALL (IDBCYC)
      ENDIF
C-----------
C  SEE IF WE NEED TO DO SOME DEBUG.
C-----------
      CALL DBCHK (DEBUG,'INITRE',6,0)
      GO TO 10
C
C  ==========  OPTION NUMBER 21: ECHOSUM  ===========================ECHOSUM
C
 3100 CONTINUE
      LSUMRY = .TRUE.
      IF (ARRAY(1) .GE. 1.) JOSUM=IFIX(ARRAY(1))
      IF(LKECHO)WRITE(JOSTND,3110) KEYWRD,JOSUM
 3110 FORMAT (/A8,'   SUMMARY OUTPUT WILL BE WRITTEN TO ',
     >        'FILE REFERENCED BY NUMBER ',I2)
      GO TO 10
C
C  ==========  OPTION NUMBER 22: ADDFILE  ===========================ADDFILE
C
 3200 CONTINUE
      IF (LNOTBK(1)) GOTO 3210
      CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
      CALL ERRGRO (.TRUE.,4)
      GOTO 10
 3210 CONTINUE
      ICL1=IREAD
      IREAD=IFIX(ARRAY(1))
      IF(LKECHO)WRITE(JOSTND,1410) KEYWRD,IREAD
      GO TO 10
C
C  ==========  OPTION NUMBER 23: THINAUTO  ==========================THINAUTO
C
 3300 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,222,KEYWRD,KARD,
     >                   IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
         GOTO 10
      ENDIF
      PRMS(1)=AUTMIN
      PRMS(2)=AUTMAX
      PRMS(3)=EFF
      IF(LNOTBK(2))PRMS(1)=ARRAY(2)
      IF(LNOTBK(3))PRMS(2)=ARRAY(3)
      IF(LNOTBK(4))PRMS(3)=ARRAY(4)
      CALL OPNEW (KODE,IDT,222,3,PRMS)
      IF (KODE .GT. 0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,3310) KEYWRD,IDT,(PRMS(I),I=1,3)
 3310 FORMAT (/A8,'   DATE/CYCLE=',I5,'; MIN=',F8.1,'; MAX=',
     >        F8.1,' PERCENT OF FULL STOCKING',
     >        ';  PROPORTION OF SELECTED TREES REMOVED=',F6.3)
      GOTO 10
C
C  ==========  OPTION NUMBER 24: THINBTA  ===========================THINBTA
C
 3400 CONTINUE
      ICFLAG = 223
      GO TO 4090
C
C  ==========  OPTION NUMBER 25: THINATA  ===========================THINATA
C
 3500 CONTINUE
      ICFLAG = 224
      GO TO 4090
C
C  ==========  OPTION NUMBER 26: THINBBA  ===========================THINBBA
C
 3600 CONTINUE
      ICFLAG = 225
      GO TO 4090
C
C  ==========  OPTION NUMBER 27: THINABA  ===========================THINABA
C
 3700 CONTINUE
      ICFLAG = 226
      GO TO 4090
C
C  ==========  OPTION NUMBER 28: THINPRSC  ==========================THINPRSC
C
 3800 CONTINUE
      ICFLAG=227
 3805 CONTINUE
      IDT = 1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,ICFLAG,KEYWRD,KARD,
     >                   IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
         GOTO 10
      ENDIF
      PRMS(1)=EFF
      IF (LNOTBK(2)) PRMS(1)=ARRAY(2)
      IF (PRMS(1).LT.0.) THEN
        CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
        CALL ERRGRO (.TRUE.,4)
        GOTO 10
      ENDIF
      IF (LNOTBK(3)) THEN
         PRMS(2)=ARRAY(3)
         I=2
      ELSE
         I=1
      ENDIF
      CALL OPNEW (KODE,IDT,ICFLAG,I,PRMS)
      IF (KODE.GT.0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,3810) KEYWRD,IDT,PRMS(1)
 3810 FORMAT (/A8,'   DATE/CYCLE=',I5,
     >        '; PROPORTION OF SELECTED TREES REMOVED=',F6.3)
      IF ((I.EQ.2).AND.LKECHO)WRITE(JOSTND,3820) IFIX(PRMS(2))
 3820 FORMAT (T12,'TREES CODED ',I4,' ARE SELECTED.')
      GO TO 10
C
C  ==========  OPTION NUMBER 29: THINDBH  ===========================THINDBH
C
 3900 CONTINUE
      ICFLAG=228
 3901 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,ICFLAG,KEYWRD,KARD,
     >                   IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
         GOTO 10
      ENDIF
      IF (.NOT.LNOTBK(3)) ARRAY(3)=999.
      IF (.NOT.LNOTBK(4)) ARRAY(4)=EFF
C
C     SPECIES CODE PROCESSING.
C
      CALL SPDECD (5,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF (IS.EQ.-999) GOTO 10
C
      IF (ARRAY(7).LT.0.0 .OR. ARRAY(6).GT.0.0) ARRAY(7)=0.0
      IF (ARRAY(6).LT.0.0) ARRAY(6)=0.0
      CALL OPNEW(KODE,IDT,ICFLAG,6,ARRAY(2))
      IF (KODE.GT.0) GOTO 10
      IF (ICFLAG.EQ.228) THEN
         IF(LKECHO)WRITE(JOSTND,3910)KEYWRD,IDT,'DBH=',ARRAY(2),'DBH=',
     >                      ARRAY(3),ARRAY(4)
      ELSE
         IF(LKECHO)WRITE(JOSTND,3910)KEYWRD,IDT,'HEIGHT=',ARRAY(2),
     >                      'HEIGHT=',ARRAY(3),ARRAY(4)
      ENDIF
 3910 FORMAT(/A8,'   DATE/CYCLE=',I5,'; MINIMUM ',A,F8.1,
     >        '; MAXIMUM ',A,F8.1,
     >        '; PROPORTION OF SELECTED TREES REMOVED=',F6.3)
      IF (IS.NE.0) THEN
         ILEN=3
         IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
         IF(LKECHO)WRITE(JOSTND,3920) 'SPECIES= ',KARD(5)(1:ILEN),
     >                                IS,'IS'
 3920    FORMAT (T12,A,A,' (CODE= ',I3,') ',A,
     >           ' TARGETED FOR THIS CUT.')
      ELSE
         IF(LKECHO)WRITE(JOSTND,3920) 'ALL',' SPECIES',IS,'ARE'
      ENDIF
      IF (((ARRAY(6).GT.0.0).OR.(ARRAY(7).GT.0.0))
     &   .AND.LKECHO)WRITE(JOSTND,3930) ARRAY(6), ARRAY(7)
 3930 FORMAT(T12,'RESIDUAL CLASS TPA =',F8.1,
     &          ' RESIDUAL CLASS BA =',F8.1)
      GOTO 10
C
C  ==========  OPTION NUMBER 30: xSALVAGE  ===========================xSALVAGE
C Taken out of service to avoid accidental use as same keyword in FFE extension 
 4000 CONTINUE
      ICFLAG=229
      GO TO 3805
C
C  ==========  OPTION NUMBER 31:  SPLABEL ===========================SPLABEL
C
 4010 CONTINUE
      CALL LBSPLR (KEYWRD,JOSTND,IREAD,IRECNT,RECORD,KODE,LKECHO)
      IF (KODE.GE.1) GOTO 80
      GO TO 10
C
C  ==========  OPTION NUMBER 32:  AGPLABEL ==========================AGPLABEL
C
 4020 CONTINUE
      CALL LBAGLR (KEYWRD,JOSTND,IREAD,IRECNT,RECORD,KODE)
      IF (KODE.GE.1) GOTO 80
      GO TO 10
C
C  ==========  OPTION NUMBER 33:  COMPUTE   =========================COMPUTE
C
 4030 CONTINUE
      CALL EVUSRV (RECORD,KEYWRD,ARRAY,LNOTBK,IREAD,JOSTND,
     >             DEBUG,IRECNT)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN
      GOTO 10
C
C  ==========  OPTION NUMBER 34:  FERTILIZE  ========================FERTILIZE
C
 4040 CONTINUE
      CALL FFIN (JOSTND,IRECNT,KEYWRD,ARRAY,LNOTBK,KARD,IPRMPT,
     &           ICYC,IREAD,LKECHO)
      GO TO 10
C
C  ==========  OPTION NUMBER 35:  THINHT  ===========================THINHT
C
 4050 CONTINUE
      ICFLAG=232
      GOTO 3901
C
C  ==========  OPTION NUMBER 36:  STATS =============================STATS
C
 4060 CONTINUE
      LSTATS=.TRUE.
      IF(LNOTBK(1))   ALPHA=ARRAY(1)
      IF(ALPHA.LE.0.0.OR.ALPHA.GE.1.0) GO TO 4068
 4067 IF(LKECHO)WRITE(JOSTND,4062) KEYWRD,ALPHA
 4062 FORMAT(/A8,'   STATISTICAL DESCRIPTION OF INPUT DATA WILL',
     &   ' BE PROVIDED; CONFIDENCE LIMITS AT ',F4.2,' LEVEL.')
      GO TO 10
 4068 CONTINUE
      ALPHA=0.05
      IF(LKECHO)WRITE(JOSTND,4069)
 4069 FORMAT(11X,'SPECIFIED PROBABILITY LEVEL IS INVALID; 0.05 WILL',
     &  ' BE USED.')
      GO TO 4067
C
C  ==========  OPTION NUMBER 37:  TOPKILL  ==========================TOPKILL
C
 4070 CONTINUE
      IACT=111
      GOTO 4081
C
C  ==========  OPTION NUMBER 38:  HTGSTOP   =========================HTGSTOP
C
 4080 CONTINUE
      IACT=110
 4081 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,IACT,KEYWRD,KARD,
     >                   IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
      ELSE
C
C        SPECIES CODE PROCESSING.
C
         CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     >                ARRAY,KARD)
         IF(IS.EQ.-999) GO TO 10
C
C        SPECIAL CASE FOR FIELD 6 AND HTGSTOP.
C
         IF (IACT.EQ.110 .AND. .NOT.LNOTBK(6)) ARRAY(6)=1.0
C
C        LOAD THE ACTIVITY CODE.
C
         CALL OPNEW (KODE,IDT,IACT,6,ARRAY(2))
         IF (KODE.GT.0) GOTO 10
C
         ILEN=3
         IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
         IF(LKECHO)WRITE(JOSTND,4082)KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >   (ARRAY(I),I=3,4),KEYWRD,ARRAY(5)
 4082    FORMAT (/A8,'   DATE/CYCLE=',I5,'; SPECIES= ',A,' (CODE= ',
     >      I3,'); LOWER TREE-HEIGHT LIMIT=',F5.1,'; UPPER LIMIT=',F5.1/
     >      T12,'PROBABILITY (',A8,') FOR TREES WITHIN ',
     >      'THE HEIGHT LIMITS=',F10.3)
         IF((IACT.GE.110).AND.LKECHO)WRITE(JOSTND,4083) 'HEIGHT GROWTH',
     >                    ARRAY(6),ARRAY(7)
         IF ((IACT.GE.111).AND.LKECHO)WRITE(JOSTND,4083) 'HEIGHT',
     >                                            ARRAY(6),ARRAY(7)
 4083    FORMAT (T12,'AVERAGE PROPORTION OF ',A,' LOST=',F6.3,
     >           '; STD DEV=',F6.3)
      ENDIF
      GOTO 10
C
C     STANDARD THINNING PROCESSING SECTION:
C
 4090 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.LE.0) GOTO 4091
      IF (IPRMPT.NE.2) THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,25)
      ELSE
         CALL OPNEWC (KODE,JOSTND,IREAD,IDT,ICFLAG,KEYWRD,KARD,IPRMPT,
     >                IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
      ENDIF
      GOTO 10
 4091 CONTINUE
      IF (LNOTBK(2)) THEN
         PRMS(1)=ARRAY(2)
      ELSE
C
C        REQUIRED RESIDUAL IS MISSING.
C
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
      PRMS(2)=EFF
      IF (LNOTBK(3)) PRMS(2)=ARRAY(3)
      PRMS(3)=0.0
      IF(LNOTBK(4)) PRMS(3)=ARRAY(4)
      PRMS(4)=999.0
      IF(LNOTBK(5)) PRMS(4)=ARRAY(5)
      PRMS(5)=0.0
      IF(LNOTBK(6)) PRMS(5)=ARRAY(6)
      PRMS(6)=999.0
      IF(LNOTBK(7)) PRMS(6)=ARRAY(7)
      CALL OPNEW (KODE,IDT,ICFLAG,6,PRMS)
      IF (KODE.GT.0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,4095) KEYWRD,IDT,(PRMS(I),I=1,6)
 4095 FORMAT (/A8,'   DATE/CYCLE=',I5,'; RESIDUAL=',F8.2,
     >        '; PROPORTION OF SELECTED TREES REMOVED=',F6.3/
     >   T12,'DBH OF REMOVED TREES WILL RANGE FROM ',F5.1,' TO ',
     >   F5.1,' INCHES, AND'/
     >   T12,'HEIGHT OF REMOVED TREES WILL RANGE FROM ',F5.1,' TO ',
     >   F5.1,' FEET.')
      GO TO 10
C
C  ==========  OPTION NUMBER 39: MCFDLN  ============================MCFDLN
C
 4100 CONTINUE
      LCVOLS=.TRUE.
      CALL SDEFLN(LNOTBK,ARRAY,KEYWRD,CFLA0,CFLA1,KARD,IS)
      IF(IS .EQ. -999) GO TO 10
C
      SELECT CASE (VARACD)
C
        CASE ('CS','LS','NE','SN')
          IF(LKECHO)WRITE(JOSTND,4110)
 4110     FORMAT(T12,'DEFECT CORRECTIONS WILL BE APPLIED TO ',
     &    'PULPWOOD VOLUME.')
C
        CASE DEFAULT
          IF(LKECHO)WRITE(JOSTND,4120)
 4120     FORMAT(T12,'DEFECT CORRECTIONS WILL BE APPLIED TO ',
     &    'MERCHANTABLE CUBIC FOOT VOLUME.')
C
      END SELECT
      GO TO 10
C
C  ==========  OPTION NUMBER 40: BFFDLN  ============================BFFDLN
C
 4200 CONTINUE
      LBVOLS=.TRUE.
      CALL SDEFLN(LNOTBK,ARRAY,KEYWRD,BFLA0,BFLA1,KARD,IS)
      IF(IS .EQ. -999) GO TO 10
C
      SELECT CASE (VARACD)
C
        CASE ('CS','LS','NE','SN')
          IF(LKECHO)WRITE(JOSTND,4210)
 4210     FORMAT(T12,'DEFECT CORRECTIONS WILL BE APPLIED TO ',
     &    'SAWLOG VOLUME.')
C
        CASE DEFAULT
        IF(LKECHO)WRITE(JOSTND,4220)
 4220   FORMAT(T12,'DEFECT CORRECTIONS WILL BE APPLIED TO ',
     &  'BOARD FOOT VOLUME.')
C
      END SELECT
      GO TO 10
C
C  ==========  OPTION NUMBER 41:  MCDEFECT  =========================MCDEFECT
C
 4300 CONTINUE
      LCVOLS=.TRUE.
C----------
C     IF THE DATE WAS NOT SPECIFIED (LNOTBK(1)=F), OR = 0;
C     THEN: CHANGE THE DEFAULT STANDARDS (DO NOT 'SCHEDULE' THE
C     REQUEST TO CHANGE THE STANDARDS).
C----------
      IF (LNOTBK(1) .AND. ARRAY(1).GT. 0.) GO TO 4350
C----------
C     SPECIES CODE PROCESSING.
C----------
      CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF (IS.EQ.-999) GO TO 10
C----------
C     IF (IS<0) CHANGE ALL SPECIES IN THE GROUP
C----------
      IF(IS .LT. 0) THEN
        IGRP = -IS
        IULIM = ISPGRP(IGRP,1)+1
        DO 4321 IG=2,IULIM
        IGSP = ISPGRP(IGRP,IG)
        IF (LNOTBK(3)) CFDEFT(2,IGSP)=ARRAY(3)
        IF (LNOTBK(4)) CFDEFT(3,IGSP)=ARRAY(4)
        IF (LNOTBK(5)) CFDEFT(4,IGSP)=ARRAY(5)
        IF (LNOTBK(6)) CFDEFT(5,IGSP)=ARRAY(6)
        IF (LNOTBK(7)) THEN
          CFDEFT(6,IGSP)=ARRAY(7)
          CFDEFT(7,IGSP)=ARRAY(7)
          CFDEFT(8,IGSP)=ARRAY(7)
          CFDEFT(9,IGSP)=ARRAY(7)
        ENDIF
 4321   CONTINUE
        ILEN=ISPGRP(-IS,92)
C
      SELECT CASE (VARACD)
C
        CASE ('CS','LS','NE','SN')
          IF(LKECHO)WRITE(JOSTND,4332) KEYWRD,KARD(2)(1:ILEN),IS,
     &                                 (ARRAY(I),I=3,7)
C
        CASE DEFAULT
          IF(LKECHO)WRITE(JOSTND,4340) KEYWRD,KARD(2)(1:ILEN),IS,
     &                                 (ARRAY(I),I=3,7)
C
        END SELECT
        GO TO 10
C----------
C     IF (IS=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C----------
      ELSEIF(IS .EQ. 0)THEN
        DO 4310 IS=1,MAXSP
        IF (LNOTBK(3)) CFDEFT(2,IS)=ARRAY(3)
        IF (LNOTBK(4)) CFDEFT(3,IS)=ARRAY(4)
        IF (LNOTBK(5)) CFDEFT(4,IS)=ARRAY(5)
        IF (LNOTBK(6)) CFDEFT(5,IS)=ARRAY(6)
        IF (LNOTBK(7)) THEN
          CFDEFT(6,IS)=ARRAY(7)
          CFDEFT(7,IS)=ARRAY(7)
          CFDEFT(8,IS)=ARRAY(7)
          CFDEFT(9,IS)=ARRAY(7)
        ENDIF
 4310   CONTINUE
C
      SELECT CASE (VARACD)
C
        CASE ('CS','LS','NE','SN')
          IF(LKECHO)WRITE(JOSTND,4312) KEYWRD,(ARRAY(I),I=3,7)
 4312     FORMAT(/A8,T12,'PULPWOOD VOLUME DEFECT',
     >    ' PROPORTIONS HAVE BEEN CHANGED FOR ALL SPECIES:',
     >    /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     >    '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     >    '; 25 INCH AND LARGER TREES=',F6.2)
C
        CASE DEFAULT
          IF(LKECHO)WRITE(JOSTND,4320) KEYWRD,(ARRAY(I),I=3,7)
 4320     FORMAT(/A8,T12,'CUBIC FOOT VOLUME DEFECT',
     >    ' PROPORTIONS HAVE BEEN CHANGED FOR ALL SPECIES:',
     >    /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     >    '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     >    '; 25 INCH AND LARGER TREES=',F6.2)
C
        END SELECT
        GOTO 10
C----------
C     SPECIES CODE IS SPECIFIED (IS>0).
C----------
      ELSE
        IF (LNOTBK(3)) CFDEFT(2,IS)=ARRAY(3)
        IF (LNOTBK(4)) CFDEFT(3,IS)=ARRAY(4)
        IF (LNOTBK(5)) CFDEFT(4,IS)=ARRAY(5)
        IF (LNOTBK(6)) CFDEFT(5,IS)=ARRAY(6)
        IF (LNOTBK(7)) THEN
          CFDEFT(6,IS)=ARRAY(7)
          CFDEFT(7,IS)=ARRAY(7)
          CFDEFT(8,IS)=ARRAY(7)
          CFDEFT(9,IS)=ARRAY(7)
        ENDIF
C
        SELECT CASE (VARACD)
C
        CASE ('CS','LS','NE','SN')
          ILEN=3
          IF(LKECHO)WRITE(JOSTND,4332) KEYWRD,KARD(2)(1:ILEN),IS,
     &                                 (ARRAY(I),I=3,7)
 4332     FORMAT(/A8,T12,'PULPWOOD VOLUME DEFECT PROPORTIONS HAVE ',
     >    'BEEN CHANGED FOR SPECIES:',A,' (CODE=',I3,')',
     >    /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     >    '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     >    '; 25 INCH AND LARGER TREES=',F6.2)
C
        CASE DEFAULT
          ILEN=3
          IF(LKECHO)WRITE(JOSTND,4340) KEYWRD,KARD(2)(1:ILEN),IS,
     &                                 (ARRAY(I),I=3,7)
 4340     FORMAT(/A8,T12,'CUBIC FOOT VOLUME DEFECT PROPORTIONS ',
     >    'HAVE BEEN CHANGED FOR SPECIES:',A,' (CODE=',I3,')',
     >    /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     >    '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     >    '; 25 INCH AND LARGER TREES=',F6.2)
C
        END SELECT
        GOTO 10
      ENDIF
C----------
C SCHEDULE THE ACTIVITY
C----------
 4350 CONTINUE
      CALL SDEFET (LNOTBK,ARRAY,KEYWRD,LOPEVN,215,KARD,IPRMPT)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN
      GO TO 10
C
C  ==========  OPTION NUMBER 42:  BFDEFECT  =========================BFDEFECT
C
 4400 CONTINUE
      LBVOLS=.TRUE.
C----------
C     IF THE DATE WAS NOT SPECIFIED (LNOTBK(1)=F), OR = 0;
C     THEN: CHANGE THE DEFAULT STANDARDS (DO NOT 'SCHEDULE' THE
C     REQUEST TO CHANGE THE STANDARDS).
C----------
      IF (LNOTBK(1) .AND. ARRAY(1).GT. 0.) GO TO 4450
C----------
C     SPECIES CODE PROCESSING.
C----------
      CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF (IS.EQ.-999) GOTO 10
C----------
C     IF (IS<0) CHANGE ALL SPECIES IN THE GROUP
C----------
      IF(IS .LT. 0) THEN
        IGRP = -IS
        IULIM = ISPGRP(IGRP,1)+1
        DO 4021 IG=2,IULIM
        IGSP = ISPGRP(IGRP,IG)
        IF (LNOTBK(3)) BFDEFT(2,IGSP)=ARRAY(3)
        IF (LNOTBK(4)) BFDEFT(3,IGSP)=ARRAY(4)
        IF (LNOTBK(5)) BFDEFT(4,IGSP)=ARRAY(5)
        IF (LNOTBK(6)) BFDEFT(5,IGSP)=ARRAY(6)
        IF (LNOTBK(7)) THEN
          BFDEFT(6,IGSP)=ARRAY(7)
          BFDEFT(7,IGSP)=ARRAY(7)
          BFDEFT(8,IGSP)=ARRAY(7)
          BFDEFT(9,IGSP)=ARRAY(7)
        ENDIF
 4021   CONTINUE
        ILEN=ISPGRP(-IS,92)
C
        SELECT CASE (VARACD)
C
        CASE ('CS','LS','NE','SN')
          IF(LKECHO)WRITE(JOSTND,4432) KEYWRD,KARD(2)(1:ILEN),IS,
     &                                 (ARRAY(I),I=3,7)
C
        CASE DEFAULT
          IF(LKECHO)WRITE(JOSTND,4440) KEYWRD,KARD(2)(1:ILEN),IS,
     &                                 (ARRAY(I),I=3,7)
C
        END SELECT
        GO TO 10
C----------
C     IF (IS=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C----------
      ELSEIF(IS .EQ. 0)THEN
        DO 4410 IS=1,MAXSP
        IF (LNOTBK(3)) BFDEFT(2,IS)=ARRAY(3)
        IF (LNOTBK(4)) BFDEFT(3,IS)=ARRAY(4)
        IF (LNOTBK(5)) BFDEFT(4,IS)=ARRAY(5)
        IF (LNOTBK(6)) BFDEFT(5,IS)=ARRAY(6)
        IF (LNOTBK(7)) THEN
          BFDEFT(6,IS)=ARRAY(7)
          BFDEFT(7,IS)=ARRAY(7)
          BFDEFT(8,IS)=ARRAY(7)
          BFDEFT(9,IS)=ARRAY(7)
        ENDIF
 4410   CONTINUE
C
        SELECT CASE (VARACD)
C
        CASE ('CS','LS','NE','SN')
          IF(LKECHO)WRITE(JOSTND,4412) KEYWRD,(ARRAY(I),I=3,7)
 4412     FORMAT(/A8,T12,'SAWLOG VOLUME DEFECT',
     &      ' PROPORTIONS HAVE BEEN CHANGED FOR ALL SPECIES:',
     &      /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     &      '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     &      '; 25 INCH AND LARGER TREES=',F6.2)
C
        CASE DEFAULT
          IF(LKECHO)WRITE(JOSTND,4420) KEYWRD,(ARRAY(I),I=3,7)
 4420     FORMAT(/A8,T12,'BOARD FOOT VOLUME DEFECT',
     &      ' PROPORTIONS HAVE BEEN CHANGED FOR ALL SPECIES:',
     &      /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     &      '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     &      '; 25 INCH AND LARGER TREES=',F6.2)
C
        END SELECT
        GOTO 10
C----------
C     SPECIES CODE IS SPECIFIED (IS > 0).
C----------
      ELSE
        IF (LNOTBK(3)) BFDEFT(2,IS)=ARRAY(3)
        IF (LNOTBK(4)) BFDEFT(3,IS)=ARRAY(4)
        IF (LNOTBK(5)) BFDEFT(4,IS)=ARRAY(5)
        IF (LNOTBK(6)) BFDEFT(5,IS)=ARRAY(6)
        IF (LNOTBK(7)) THEN
          BFDEFT(6,IS)=ARRAY(7)
          BFDEFT(7,IS)=ARRAY(7)
          BFDEFT(8,IS)=ARRAY(7)
          BFDEFT(9,IS)=ARRAY(7)
        ENDIF
C
        SELECT CASE (VARACD)
C
        CASE ('CS','LS','NE','SN')
          ILEN=3
          IF(LKECHO)WRITE(JOSTND,4432) KEYWRD,KARD(2)(1:ILEN),IS,
     &                                 (ARRAY(I),I=3,7)
 4432     FORMAT(/A8,T12,'SAWLOG VOLUME DEFECT PROPORTIONS HAVE ',
     &      'BEEN CHANGED FOR SPECIES:',A,' (CODE=',I3,')',
     &      /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     &      '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     &      '; 25 INCH AND LARGER TREES=',F6.2)
C
        CASE DEFAULT
          ILEN=3
          IF(LKECHO)WRITE(JOSTND,4440) KEYWRD,KARD(2)(1:ILEN),IS,
     &                                 (ARRAY(I),I=3,7)
 4440     FORMAT(/A8,T12,'BOARD FOOT VOLUME DEFECT PROPORTIONS ',
     &      'HAVE BEEN CHANGED FOR SPECIES:',A,' (CODE=',I3,')',
     &      /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     &      '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     &      '; 25 INCH AND LARGER TREES=',F6.2)
C
        END SELECT
        GOTO 10
      ENDIF
C----------
C  SCHEDULE THE ACTIVITY
C----------
 4450 CONTINUE
      CALL SDEFET (LNOTBK,ARRAY,KEYWRD,LOPEVN,216,KARD,IPRMPT)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN
      GO TO 10
C
C  ==========  OPTION NUMBER 43:  VOLUME  ===========================VOLUME
C
 4500 CONTINUE
      LCVOLS=.TRUE.
C
C  SET ITOPD8=1 TO DISSALLOW MODIFICATION OF TOP MERCH. SPEC.
C  IN R8 VARIANTS
C
      SELECT CASE (VARACD)
C
        CASE ('SN')
C  Updates to fvsvol.f now allow for this option in R8 (Q1 2023)
          ITOPD8=0
C
        CASE DEFAULT
          ITOPD8=0
C
      END SELECT
C
C     SPECIES CODE PROCESSING.
C
      CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF (IS.EQ.-999) GOTO 10
C
C     IF THE DATE WAS NOT SPECIFIED (LNOTBK(1)=F), OR = 0;
C     THEN: CHANGE THE DEFAULT STANDARDS (DO NOT 'SCHEDULE' THE
C     REQUEST TO CHANGE THE STANDARDS).
C
      IF (LNOTBK(1) .AND. ARRAY(1).GT. 0.) GOTO 4540
C----------
C     IF (IS<0) CHANGE ALL SPECIES IN THE GROUP
C----------
      IF(IS .LT. 0) THEN
        IGRP = -IS
        IULIM = ISPGRP(IGRP,1)+1
        DO 4505 IG=2,IULIM
        IGSP = ISPGRP(IGRP,IG)
        IF (LNOTBK(3)) DBHMIN(IGSP)=ARRAY(3)
        IF(LNOTBK(4).AND.(ITOPD8.LE.0))THEN
           TOPD(IGSP)=ARRAY(4)
        ENDIF
        IF (LNOTBK(5)) STMP(IGSP)  =ARRAY(5)
        IF (LNOTBK(6)) FRMCLS(IGSP)=ARRAY(6)
        IF (LNOTBK(7)) METHC(IGSP) =INT(ARRAY(7))
        ILEN=ISPGRP(IGRP,92)
        IF (VARACD .EQ. 'AK') THEN
          IF(LKECHO)WRITE(JOSTND,4534) KEYWRD,KARD(2)(1:ILEN),
     &      IGSP,DBHMIN(IGSP),TOPD(IGSP),STMP(IGSP),FRMCLS(IGSP)
        ELSEIF(ITOPD8.GT.0)THEN
           WRITE(JOSTND,4537) KEYWRD,KARD(2)(1:ILEN),
     &         IGSP,DBHMIN(IGSP),STMP(IGSP),FRMCLS(IGSP)
        ELSE
          IF(LKECHO)WRITE(JOSTND,4535) KEYWRD,KARD(2)(1:ILEN),IGSP,
     &      DBHMIN(IGSP),TOPD(IGSP),STMP(IGSP),FRMCLS(IGSP)
        ENDIF
        IF(LNOTBK(7).AND.LKECHO)WRITE(JOSTND,4536)METHC(IGSP)
 4505   CONTINUE
        GOTO 10
C----------
C     IF (IS=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C----------
      ELSEIF(IS .EQ. 0)THEN
        DO 4510 IS=1,MAXSP
        IF (LNOTBK(3)) DBHMIN(IS)=ARRAY(3)
        IF(LNOTBK(4).AND.(ITOPD8.LE.0))TOPD(IS)=ARRAY(4)
        IF (LNOTBK(5)) STMP(IS)  =ARRAY(5)
        IF (LNOTBK(6)) FRMCLS(IS)=ARRAY(6)
        IF (LNOTBK(7)) METHC(IS) =INT(ARRAY(7))
 4510   CONTINUE
        IF(LKECHO)WRITE(JOSTND,4520) KEYWRD
 4520   FORMAT (/A8,'   THE FOLLOWING MERCHANTABILITY ',
     >        'STANDARDS HAVE BEEN CHANGED FOR ALL SPECIES:')
        IF (LNOTBK(3).AND.LKECHO)WRITE(JOSTND,4521) ARRAY(3)
        IF (ITOPD8.GT.0)THEN
          WRITE(JOSTND,4527)
        ELSEIF(LNOTBK(4).AND.LKECHO)THEN
          WRITE(JOSTND,4522) ARRAY(4)
        ENDIF
        IF (LNOTBK(5).AND.LKECHO)WRITE(JOSTND,4523) ARRAY(5)
        IF (LNOTBK(6)) THEN
C
          SELECT CASE (VARACD)
C
            CASE ('AK')
              IF(LKECHO)WRITE(JOSTND,4526)ARRAY(6)
C
            CASE DEFAULT
              IF(LKECHO)WRITE(JOSTND,4524) ARRAY(6)
C
          END SELECT
        ENDIF
        IF (LNOTBK(7).AND.LKECHO)WRITE(JOSTND,4525) ARRAY(7)
 4521   FORMAT (T22,'MINIMUM DBH =',F6.2)
 4522   FORMAT (T22,'TOP DIAMETER=',F6.2)
 4523   FORMAT (T22,'STUMP HEIGHT=',F6.2)
 4524   FORMAT (T22,'FORM CLASS  =',F6.2)
 4525   FORMAT (T22,'METHOD OF VOLUME CALCULATION IS ',F5.0)
 4526   FORMAT (T22,'LOG LENGTH  =',F6.2)
 4527   FORMAT (T22,'TOP DIAMETER CAN NOT BE MODIFIED. IT WILL BE ',
     &   'SET TO DEFAULT VALUE')
        GOTO 10
      ELSE
C----------
C     SPECIES CODE IS SPECIFIED (IS>0).
C----------
        IF (LNOTBK(3)) DBHMIN(IS)=ARRAY(3)
        IF(LNOTBK(4).AND.(ITOPD8.LE.0))THEN
           TOPD(IS)=ARRAY(4)
        ENDIF
        IF (LNOTBK(5)) STMP(IS)  =ARRAY(5)
        IF (LNOTBK(6)) FRMCLS(IS)=ARRAY(6)
        IF (LNOTBK(7)) METHC(IS) =INT(ARRAY(7))
        ILEN=3
        IF (VARACD .EQ. 'AK') THEN
          IF(LKECHO)WRITE(JOSTND,4534) KEYWRD,KARD(2)(1:ILEN),IS,
     &      DBHMIN(IS),TOPD(IS),STMP(IS),FRMCLS(IS)
 4534     FORMAT (/A8,'   MERCHANTABILITY STANDARDS FOR ',
     >        'SPECIES= ',A,' (CODE=',I3,') ARE:  MINIMUM DBH=',F6.2,
     >        '; TOP DIAMETER=',F6.2,'; STUMP HEIGHT=',F6.2,/T12,
     >        'LOG LENGTH=',F6.2)
        ELSEIF(ITOPD8.GT.0)THEN
          IF(LKECHO)WRITE(JOSTND,4537) KEYWRD,KARD(2)(1:ILEN),
     &      IS,DBHMIN(IS),STMP(IS),FRMCLS(IS)
        ELSE
          IF(LKECHO)WRITE(JOSTND,4535) KEYWRD,KARD(2)(1:ILEN),IS,
     &      DBHMIN(IS),TOPD(IS),STMP(IS),FRMCLS(IS)
 4535     FORMAT (/A8,'   MERCHANTABILITY STANDARDS FOR ',
     >        'SPECIES= ',A,' (CODE=',I3,') ARE:  MINIMUM DBH=',F6.2,
     >        '; TOP DIAMETER=',F6.2,'; STUMP HEIGHT=',F6.2,/T12,
     >        'FORM CLASS=',F6.2)
        ENDIF
        IF(LNOTBK(7).AND.LKECHO)WRITE(JOSTND,4536)METHC(IS)
 4536   FORMAT (T12,'METHOD OF VOLUME CALCULATION IS ',I6)
 4537   FORMAT (/A8,'   MERCHANTABILITY STANDARDS FOR ',
     >        'SPECIES= ',A,' (CODE=',I3,') ARE:  MINIMUM DBH=',F6.2,
     >        '; TOP DIAMETER'/T12,'CAN NOT BE MODIFIED. IT WILL BE ',
     >        'SET TO DEFAULT VALUE; STUMP HEIGHT=',F6.2,
     >        ' FORM CLASS=',F6.2)
        GOTO 10
      ENDIF
C----------
C     DATE WAS SPECIFIED;  SCHEDULE THE CHANGING OF MERCH-
C     ABILITY STANDARDS.
C----------
 4540 CONTINUE
      IDT=IFIX(ARRAY(1))
C----------
C     IF (IS<0) SCHEDULE CHANGE FOR THE SPECIES GROUP
C
C     SET DEFAULTS TO THOSE FOR THE FIRST SPECIES IN THE GROUP
C----------
      IF(IS .LT. 0) THEN
        IGRP = -IS
        IFSP = ISPGRP(IGRP,2)
        IF (.NOT.LNOTBK(3)) ARRAY(3)=DBHMIN(IFSP)
        IF (.NOT.LNOTBK(4)) ARRAY(4)=TOPD(IFSP)
        IF(LNOTBK(4).AND.(ITOPD8.GT.0))
     &    ARRAY(4)=TOPD(IFSP)
        IF (.NOT.LNOTBK(5)) ARRAY(5)=STMP(IFSP)
        IF (.NOT.LNOTBK(6)) ARRAY(6)=FRMCLS(IFSP)
        IF (.NOT.LNOTBK(7)) ARRAY(7)=METHC(IFSP)
        CALL OPNEW(KODE,IDT,217,6,ARRAY(2))
        IF (KODE.GT.0) GOTO 10
        ILEN=ISPGRP(IGRP,92)
        IF(VARACD .EQ. 'AK') THEN
          IF(LKECHO)WRITE(JOSTND,4544) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >                    (ARRAY(I),I=3,7)
        ELSEIF(ITOPD8.GT.0)THEN
          WRITE(JOSTND,4547) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >                    ARRAY(3),(ARRAY(I),I=5,7)
        ELSE
          IF(LKECHO)WRITE(JOSTND,4545) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >                    (ARRAY(I),I=3,7)
        ENDIF
C----------
C     IF (IS=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C
C     SPECIES CODE IS BLANK; SET ALL SPECIES DEFAULTS TO DEFAULT
C     WHICH IS CURRENTLY IN FORCE FOR SPECIES 1.
C----------
      ELSEIF(IS .EQ. 0)THEN
        IF (.NOT.LNOTBK(3)) ARRAY(3)=DBHMIN(1)
        IF (.NOT.LNOTBK(4)) ARRAY(4)=TOPD(1)
        IF(LNOTBK(4).AND.(ITOPD8.GT.0))
     &    ARRAY(4)=TOPD(1)
        IF (.NOT.LNOTBK(5)) ARRAY(5)=STMP(1)
        IF (.NOT.LNOTBK(6)) ARRAY(6)=FRMCLS(1)
        IF (.NOT.LNOTBK(7)) ARRAY(7)=METHC(1)
        ARRAY(2)=0.
        CALL OPNEW(KODE,IDT,217,6,ARRAY(2))
        IF (KODE.GT.0) GOTO 10
        IF(VARACD.EQ.'AK')THEN
          IF(LKECHO)WRITE(JOSTND,4574) KEYWRD,IDT,(ARRAY(I),I=3,7)
 4574     FORMAT(/A8,'   DATE/CYCLE=',I5,'; ALL SPECIES (CODE= 0)',
     >       '; MINIMUM DBH=',F6.2,'; TOP DIAMETER=',F6.2,
     >       '; STUMP HEIGHT=',F6.2,/T12,'LOG LENGTH=',F6.2,
     >       '; METH OF VOL CALC=',F6.0)
        ELSEIF(ITOPD8.GT.0)THEN
          WRITE(JOSTND,4547) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >                    ARRAY(3),(ARRAY(I),I=5,7)
        ELSE
          IF(LKECHO)WRITE(JOSTND,4575) KEYWRD,IDT,(ARRAY(I),I=3,7)
 4575     FORMAT(/A8,'   DATE/CYCLE=',I5,'; ALL SPECIES (CODE= 0)',
     >       '; MINIMUM DBH=',F6.2,'; TOP DIAMETER=',F6.2,
     >       '; STUMP HEIGHT=',F6.2,/T12,' FORM CLASS=',F6.2,
     >       '; METH OF VOL CALC=',F6.0)
        ENDIF
      ELSE
C----------
C     SPECIES CODE IS SPECIFIED (IS>0).
C----------
        IF (.NOT.LNOTBK(3)) ARRAY(3)=DBHMIN(IS)
        IF (.NOT.LNOTBK(4)) ARRAY(4)=TOPD(IS)
        IF(LNOTBK(4).AND.(ITOPD8.GT.0))
     &    ARRAY(4)=TOPD(IS)
        IF (.NOT.LNOTBK(5)) ARRAY(5)=STMP(IS)
        IF (.NOT.LNOTBK(6)) ARRAY(6)=FRMCLS(IS)
        IF (.NOT.LNOTBK(7)) ARRAY(7)=METHC(IS)
        CALL OPNEW(KODE,IDT,217,6,ARRAY(2))
        IF (KODE.GT.0) GOTO 10
        ILEN=3
        IF(VARACD .EQ. 'AK') THEN
          IF(LKECHO)WRITE(JOSTND,4544) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >                    (ARRAY(I),I=3,7)
 4544     FORMAT(/A8,'   DATE/CYCLE=',I5,'; SPECIES= ',A,
     >       ' (CODE= ',I3,
     >       '); MINIMUM DBH=',F6.2,'; TOP DIAMETER=',F6.2,
     >       '; STUMP HEIGHT=',F6.2,/T12,'LOG LENGTH=',F6.2,
     >       ';  METH OF VOL CALC=',F6.0)
        ELSEIF(ITOPD8.GT.0)THEN
          WRITE(JOSTND,4547) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >                    ARRAY(3),(ARRAY(I),I=5,7)
        ELSE
          IF(LKECHO)WRITE(JOSTND,4545) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >                    (ARRAY(I),I=3,7)
 4545     FORMAT(/A8,'   DATE/CYCLE=',I5,'; SPECIES= ',A,
     >       ' (CODE= ',I3,
     >       '); MINIMUM DBH=',F6.2,'; TOP DIAMETER=',F6.2,
     >       '; STUMP HEIGHT=',F6.2,/T12,'FORM CLASS=',F6.2,
     >       ';  METH OF VOL CALC=',F6.0)

 4547     FORMAT(/A8,'   DATE/CYCLE=',I5,'; SPECIES= ',A,
     >       ' (CODE= ',I3,
     >       '); MINIMUM DBH=',F6.2,'; TOP DIAMETER CAN NOT BE ',
     >       'MODIFIED.'/T12,'IT WILL BE SET TO DEFAULT VALUE',
     >       '; STUMP HEIGHT=',F6.2,' FORM CLASS=',F6.2,
     >       ';  METH OF VOL CALC=',F6.0)
        ENDIF
      ENDIF
      GOTO 10
C
C  ==========  OPTION NUMBER 44: BFVOLUME ===========================BFVOLUME
C
 4600 CONTINUE
      LBVOLS=.TRUE.
C
C  SET ITOPD8=1 TO DISSALLOW MODIFICATION OF TOP MERCH. SPEC.
C  IN R8 VARIANTS RESPECTIVELY
C
      SELECT CASE (VARACD)
C
        CASE ('SN')
C          ITOPD8=1
C  Updates to fvsvol.f now allow for this option in R8 (Q1 2023)
          ITOPD8=0
C
        CASE DEFAULT
          ITOPD8=0
C
      END SELECT
C
C     SPECIES CODE PROCESSING.
C
      CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF (IS.EQ.-999) GOTO 10
C
C     IF THE DATE WAS NOT SPECIFIED (LNOTBK(1)=F), OR = 0;
C     THEN: CHANGE THE DEFAULT STANDARDS (DO NOT 'SCHEDULE' THE
C     REQUEST TO CHANGE THE STANDARDS).
C
      IF (LNOTBK(1) .AND. ARRAY(1).GT.0.) GOTO 4640
C----------
C     IF (IS<0) CHANGE ALL SPECIES IN THE GROUP
C----------
      IF(IS .LT. 0) THEN
        IGRP = -IS
        IULIM = ISPGRP(IGRP,1)+1
        DO 4605 IG=2,IULIM
        IGSP = ISPGRP(IGRP,IG)
        IF (LNOTBK(3)) BFMIND(IGSP)=ARRAY(3)
        IF(LNOTBK(4).AND.(ITOPD8.LE.0))THEN
           BFTOPD(IGSP)=ARRAY(4)
        ENDIF
        IF (LNOTBK(5)) BFSTMP(IGSP)=ARRAY(5)
        IF (LNOTBK(6)) FRMCLS(IGSP)=ARRAY(6)
        IF (LNOTBK(7)) METHB(IGSP) =INT(ARRAY(7))
        ILEN=ISPGRP(IGRP,92)
        IF (VARACD .EQ. 'AK') THEN
          IF(LKECHO)WRITE(JOSTND,4634) KEYWRD,KARD(2)(1:ILEN),IGSP,
     &       BFMIND(IGSP),BFTOPD(IGSP),BFSTMP(IGSP),FRMCLS(IGSP)
        ELSEIF(ITOPD8.GT.0)THEN
           WRITE(JOSTND,4537) KEYWRD,KARD(2)(1:ILEN),IGSP,
     &       BFMIND(IGSP),BFSTMP(IGSP),FRMCLS(IGSP)
        ELSE
          IF(LKECHO)WRITE(JOSTND,4635) KEYWRD,KARD(2)(1:ILEN),IGSP,
     &       BFMIND(IGSP),BFTOPD(IGSP),BFSTMP(IGSP),FRMCLS(IGSP)
        ENDIF
        IF(LNOTBK(7).AND.LKECHO)WRITE(JOSTND,4536)METHB(IGSP)
 4605   CONTINUE
        GOTO 10
C----------
C     IF (IS=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C----------
      ELSEIF(IS .EQ. 0)THEN
        DO 4615 IS=1,MAXSP
        IF (LNOTBK(3)) BFMIND(IS)=ARRAY(3)
        IF(LNOTBK(4).AND.(ITOPD8.LE.0))
     &  BFTOPD(IS)=ARRAY(4)
        IF (LNOTBK(5)) BFSTMP(IS)=ARRAY(5)
        IF (LNOTBK(6)) FRMCLS(IS)=ARRAY(6)
        IF (LNOTBK(7)) METHB(IS)=INT(ARRAY(7))
 4615   CONTINUE
        IF(LKECHO)WRITE(JOSTND,4620) KEYWRD
 4620   FORMAT (/A8,'   THE FOLLOWING MERCHANTABILITY ',
     >        'STANDARDS HAVE BEEN CHANGED FOR ALL SPECIES:')
        IF (LNOTBK(3).AND.LKECHO)WRITE(JOSTND,4621) ARRAY(3)
        IF (ITOPD8.GT.0)THEN
          WRITE(JOSTND,4527)
        ELSEIF(LNOTBK(4).AND.LKECHO)THEN
          WRITE(JOSTND,4522) ARRAY(4)
        ENDIF
        IF (LNOTBK(5).AND.LKECHO)WRITE(JOSTND,4623) ARRAY(5)
        IF (LNOTBK(6)) THEN
          IF(VARACD .EQ. 'AK') THEN
            IF(LKECHO)WRITE(JOSTND,4626) ARRAY(6)
          ELSE
            IF(LKECHO)WRITE(JOSTND,4624) ARRAY(6)
          ENDIF
        ENDIF
        IF (LNOTBK(7).AND.LKECHO)WRITE(JOSTND,4625) ARRAY(7)
 4621   FORMAT (T22,'MINIMUM DBH =',F6.2)
 4623   FORMAT (T22,'STUMP HEIGHT=',F6.2)
 4624   FORMAT (T22,'FORM CLASS  =',F6.2)
 4625   FORMAT (T22,'METHOD OF VOLUME CALCULATION IS ',F5.0)
 4626   FORMAT (T22,'LOG LENGTH  =',F6.2)
        GOTO 10
      ELSE
C----------
C     SPECIES CODE IS SPECIFIED (IS>0).
C----------
        IF (LNOTBK(3)) BFMIND(IS)=ARRAY(3)
        IF(LNOTBK(4).AND.(ITOPD8.LE.0))THEN
           BFTOPD(IS)=ARRAY(4)
        ENDIF
        IF (LNOTBK(5)) BFSTMP(IS)=ARRAY(5)
        IF (LNOTBK(6)) FRMCLS(IS)=ARRAY(6)
        IF (LNOTBK(7)) METHB(IS) =INT(ARRAY(7))
        ILEN=3
        IF (VARACD .EQ. 'AK') THEN
          IF(LKECHO)WRITE(JOSTND,4634) KEYWRD,KARD(2)(1:ILEN),IS,
     &       BFMIND(IS),BFTOPD(IS),BFSTMP(IS),FRMCLS(IS)
 4634     FORMAT (/A8,'   MERCHANTABILITY STANDARDS FOR ',
     >        'SPECIES= ',A,' (CODE=',I3,') ARE:  MINIMUM DBH=',F6.2,
     >        '; TOP DIAMETER=',F6.2,'; STUMP HEIGHT=',F6.2/T12,
     >        'LOG LENGTH=',F6.2)
        ELSEIF(ITOPD8.GT.0)THEN
          IF(LKECHO)WRITE(JOSTND,4537) KEYWRD,KARD(2)(1:ILEN),
     &      IS,BFMIND(IS),STMP(IS),FRMCLS(IS)
        ELSE
          IF(LKECHO)WRITE(JOSTND,4635) KEYWRD,KARD(2)(1:ILEN),IS,
     &       BFMIND(IS),BFTOPD(IS),BFSTMP(IS),FRMCLS(IS)
 4635     FORMAT (/A8,'   MERCHANTABILITY STANDARDS FOR ',
     >        'SPECIES= ',A,' (CODE=',I3,') ARE:  MINIMUM DBH=',F6.2,
     >        '; TOP DIAMETER=',F6.2,'; STUMP HEIGHT=',F6.2/T12,
     >        'FORM CLASS=',F6.2)
        ENDIF
        IF(LNOTBK(7).AND.LKECHO)WRITE(JOSTND,4536)METHB(IS)
        GOTO 10
      ENDIF
C
C     DATE WAS SPECIFIED;  SCHEDULE THE CHANGING OF MERCH-
C     ABILITY STANDARDS.
C
 4640 CONTINUE
      IDT=IFIX(ARRAY(1))
C----------
C     IF (IS<0) SCHEDULE CHANGE FOR THE SPECIES GROUP
C
C     SET DEFAULTS TO THOSE FOR THE FIRST SPECIES IN THE GROUP
C----------
      IF(IS .LT. 0) THEN
        IGRP = -IS
        IFSP = ISPGRP(IGRP,2)
        IF (.NOT.LNOTBK(3)) ARRAY(3)=BFMIND(IFSP)
        IF (.NOT.LNOTBK(4)) ARRAY(4)=BFTOPD(IFSP)
        IF(LNOTBK(4).AND.(ITOPD8.GT.0))
     &    ARRAY(4)=BFTOPD(IFSP)
        IF (.NOT.LNOTBK(5)) ARRAY(5)=BFSTMP(IFSP)
        IF (.NOT.LNOTBK(6)) ARRAY(6)=FRMCLS(IFSP)
        IF (.NOT.LNOTBK(7)) ARRAY(7)=METHB (IFSP)
        CALL OPNEW(KODE,IDT,218,6,ARRAY(2))
        IF (KODE.GT.0) GOTO 10
        ILEN=ISPGRP(IGRP,92)
        IF(VARACD.EQ.'AK')THEN
          IF(LKECHO)WRITE(JOSTND,4645) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >                    (ARRAY(I),I=3,7)
        ELSEIF(ITOPD8.GT.0)THEN
          WRITE(JOSTND,4547) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >                    (ARRAY(3),ARRAY(I),I=5,7)
        ELSE
          IF(LKECHO)WRITE(JOSTND,4646) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >                    (ARRAY(I),I=3,7)
        ENDIF
C----------
C     IF (IS=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C
C     SPECIES CODE IS BLANK; SET ALL SPECIES DEFAULTS TO DEFAULT
C     WHICH IS CURRENTLY IN FORCE FOR SPECIES 1.
C----------
      ELSEIF(IS .EQ. 0)THEN
        IF (.NOT.LNOTBK(3)) ARRAY(3)=BFMIND(1)
        IF (.NOT.LNOTBK(4)) ARRAY(4)=BFTOPD(1)
        IF(LNOTBK(4).AND.(ITOPD8.GT.0))
     &    ARRAY(4)=BFTOPD(1)
        IF (.NOT.LNOTBK(5)) ARRAY(5)=BFSTMP(1)
        IF (.NOT.LNOTBK(6)) ARRAY(6)=FRMCLS(1)
        IF (.NOT.LNOTBK(7)) ARRAY(7)=METHB(1)
        ARRAY(2)=0.
        CALL OPNEW(KODE,IDT,218,6,ARRAY(2))
        IF (KODE.GT.0) GOTO 10
        IF(VARACD.EQ.'AK')THEN
          IF(LKECHO)WRITE(JOSTND,4674) KEYWRD,IDT,(ARRAY(I),I=3,7)
 4674     FORMAT(/A8,'   DATE/CYCLE=',I5,'; ALL SPECIES (CODE= 0)',
     >       '; MINIMUM DBH=',F6.2,'; TOP DIAMETER=',F6.2,
     >       '; STUMP HEIGHT=',F6.2/T12,'LOG LENGTH=',F6.2,
     >       '; METH OF VOL CALC=',F6.0)
        ELSEIF(ITOPD8.GT.0)THEN
          WRITE(JOSTND,4547) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >                    ARRAY(3),(ARRAY(I),I=5,7)
        ELSE
          IF(LKECHO)WRITE(JOSTND,4675) KEYWRD,IDT,(ARRAY(I),I=3,7)
 4675     FORMAT(/A8,'   DATE/CYCLE=',I5,'; ALL SPECIES (CODE= 0)',
     >       '; MINIMUM DBH=',F6.2,'; TOP DIAMETER=',F6.2,
     >       '; STUMP HEIGHT=',F6.2/T12,'FORM CLASS=',F6.2,
     >       '; METH OF VOL CALC=',F6.0)
        ENDIF
      ELSE
C----------
C     SPECIES CODE IS SPECIFIED (IS>0).
C----------
        IF (.NOT.LNOTBK(3)) ARRAY(3)=BFMIND(IS)
        IF(LNOTBK(4).AND.(ITOPD8.LE.0))THEN
           BFTOPD(IS)=ARRAY(4)
        ENDIF
        IF (.NOT.LNOTBK(5)) ARRAY(5)=BFSTMP(IS)
        IF (.NOT.LNOTBK(6)) ARRAY(6)=FRMCLS(IS)
        IF (.NOT.LNOTBK(7)) ARRAY(7)=METHB (IS)
        CALL OPNEW(KODE,IDT,218,6,ARRAY(2))
        IF (KODE.GT.0) GOTO 10
        ILEN=3
        IF(VARACD.EQ.'AK')THEN
          IF(LKECHO)WRITE(JOSTND,4645) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >                    (ARRAY(I),I=3,7)
 4645     FORMAT(/A8,'   DATE/CYCLE=',I5,'; SPECIES= ',A,
     >       ' (CODE= ',I3,
     >       '); MINIMUM DBH=',F6.2,'; TOP DIAMETER=',F6.2,
     >       '; STUMP HEIGHT=',F6.2,/T12,'LOG LENGTH=',F6.2,
     >       '; METH OF VOL CALC=',F6.0)
        ELSEIF(ITOPD8.GT.0)THEN
          IF(LKECHO)WRITE(JOSTND,4537) KEYWRD,KARD(2)(1:ILEN),
     &      IS,BFMIND(IS),STMP(IS),FRMCLS(IS)
        ELSE
          IF(LKECHO)WRITE(JOSTND,4646) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >                    (ARRAY(I),I=3,7)
 4646     FORMAT(/A8,'   DATE/CYCLE=',I5,'; SPECIES= ',A,
     >       ' (CODE= ',I3,
     >       '); MINIMUM DBH=',F6.2,'; TOP DIAMETER=',F6.2,
     >       '; STUMP HEIGHT=',F6.2,/T12,'FORM CLASS=',F6.2,
     >       '; METH OF VOL CALC=',F6.0)
        ENDIF
      ENDIF
      GOTO 10
C
C  ==========  OPTION NUMBER 45: REGDMULT ===========================REGDMULT
C
 4700 CONTINUE
      I=96
      GOTO 6005
C
C  ==========  OPTION NUMBER 46:  COVER =============================COVER
C
 4800 CONTINUE
      CALL CVIN  (KEYWRD,ARRAY,LNOTBK,LKECHO)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN
      GO TO 10
C
C  ==========  OPTION NUMBER 47:  ESTAB  ============================ESTAB
C
 4900 CONTINUE
      IF(LKECHO)WRITE(JOSTND,4910) KEYWRD
 4910 FORMAT (/A8,'   REGENERATION ESTABLISHMENT OPTIONS:')
      CALL ESIN (KEYWRD,ARRAY,LNOTBK,KARD,LKECHO)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN
      GO TO 10
C
C  ==========  OPTION NUMBER 48:   MINHARV  =========================MINHARV
C
 5000 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,200,KEYWRD,KARD,
     >                   IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
         GOTO 10
      ENDIF
      CALL OPNEW(KODE,IDT,200,4,ARRAY(2))
      IF (KODE.GT.0) GOTO 10
C
      SELECT CASE (VARACD)
C
        CASE ('CS','LS','NE','SN')
          IF(LKECHO)WRITE(JOSTND,5010) KEYWRD,IDT,(ARRAY(I),I=2,5)
 5010     FORMAT (/A8,'   DATE/CYCLE=',I5,'; CUTTING MUST EXCEED ',
     >        'THE FOLLOWING:',/,29X,F8.1,' SAWLOG CUFT,',F8.1,
     >        ' SAWLOG BDFT,',F6.1,' SQFT BASAL AREA, AND',
     >        F8.1,' TOTAL MERCH CUFT.')
C
        CASE DEFAULT
          IF(LKECHO)WRITE(JOSTND,5011) KEYWRD,IDT,(ARRAY(I),I=2,5)
 5011     FORMAT (/A8,'   DATE/CYCLE=',I5,'; CUTTING MUST EXCEED ',
     >        'THE FOLLOWING:',/,29X,F8.1,' MERCH CUFT,',F8.1,
     >        ' MERCH BDFT,',F6.1,' SQFT BASAL AREA, AND',
     >        F8.1,' TOTAL CUFT.')
C
      END SELECT
      GO TO 10
C
C  ==========  OPTION NUMBER 49: SPECPREF  ==========================SPECPREF
C
C
 5100 CONTINUE
      IDT=1
      IF(LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,201,KEYWRD,KARD,
     >                      IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
         GOTO 10
       ENDIF
C
C     SPECIES CODE PROCESSING.
C
      CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF (IS.EQ.-999) GOTO 10
C
C     IF THE SELECTION VALUE IS NOT PRESENT;
C     THEN:  WRITE ERROR MSG AND SKIP PROCESSING KEYWORD CARD.
C
      IF (.NOT.LNOTBK(3)) THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
C
C     SCHEDULE THE ACTIVITY
C
      CALL OPNEW(KODE,IDT,201,2,ARRAY(2))
      IF (KODE .GT. 0) GOTO 10
      ILEN=3
      IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
      IF(LKECHO)WRITE(JOSTND,5160) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     &                             ARRAY(3)
 5160 FORMAT (/A8,'   DATE/CYCLE=',I5,'; SPECIES= ',A,' (CODE=',
     >           I3,'); THINNING SELECTION PRIORITY=',F6.0)
      GOTO 10
C
C  ==========  OPTION NUMBER 50: SPCODES  ===========================SPCODES
C
 5200 CONTINUE
C
C     SPECIES CODE PROCESSING.
C
      CALL SPDECD (1,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(IS.LT.0) THEN
        CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
        CALL ERRGRO (.TRUE.,4)
        GO TO 10
      ENDIF
      IF (IS.EQ.0) THEN
        IF(LKECHO)WRITE(JOSTND,5210) KEYWRD,JSP
 5210   FORMAT(/A8,'   PREVIOUS CODES:',
     >        ((T32,10('''',A4,''';'),'''',A4,''''))/)
        READ (IREAD,5250,END=80) JSP
 5250   FORMAT  (20A4)
        IRECNT = IRECNT + 1
        IF(LKECHO)WRITE(JOSTND,5260) JSP
 5260   FORMAT (T12,'NEW CODES:',
     >        ((T32,10('''',A4,''';'),'''',A4,''''))/)
        IF (MORDAT) CALL ERRGRO (.TRUE.,7)
        GO TO 10
      ENDIF
      IF(LKECHO)WRITE(JOSTND,5275) KEYWRD,KARD(1)(1:3),IS,JSP(IS)
 5275 FORMAT(/A8,'   PREVIOUS CODE FOR SPECIES= ',A,' (CODE= ',I3,
     >       ') IS= ''',A4,'''')
      READ (IREAD,5250,END=80) JSP(IS)
      IRECNT=IRECNT+1
      IF(LKECHO)WRITE(JOSTND,5280) KARD(1)(1:3),IS,JSP(IS)
 5280 FORMAT(T17,'NEW CODE FOR SPECIES= ',A,' (CODE= ',I3,
     &       ') IS= ''',A4,'''')
      IF (MORDAT) CALL ERRGRO (.TRUE.,7)
      GOTO 10
C
C  ==========  OPTION NUMBER 51: NODEBUG  ===========================NODEBUG
C
 5300 CONTINUE
      CALL DBINIT
      DEBUG=.FALSE.
      IF(LKECHO)WRITE(JOSTND,9999) KEYWRD
      GO TO 10
C
C  ==========  OPTION NUMBER 52: CUTEFF  ============================CUTEFF
C
 5400 CONTINUE
      IF ( LNOTBK(1) ) EFF = ARRAY(1)
      IF(LKECHO)WRITE(JOSTND,5410) KEYWRD,EFF
 5410 FORMAT (/A8,'   PROPORTION OF SELECTED TREES REMOVED=',
     >        F6.3,' (REPLACES THE DEFAULT)')
      GO TO 10
C
C  ==========  OPTION NUMBER 53: NOTRIPLE  ==========================NOTRIPLE
C
 5500 CONTINUE
      NOTRIP = .TRUE.
      IF(LKECHO)WRITE(JOSTND,9999) KEYWRD
      GO TO 10
C
C  ==========  OPTION NUMBER 54: READCORD  ==========================READCORD
C
 5600 CONTINUE
      LDCOR2 = .TRUE.
      IF(LKECHO)WRITE(JOSTND,5610) KEYWRD
 5610 FORMAT (/A8,'   LARGE TREE DIAMETER GROWTH MODELS ',
     >   'ARE MODIFIED WITH CORRECTION TERMS PRIOR TO CALIBRATION.')
      READ (IREAD,5650,END=80) COR2
 5650 FORMAT (8F10.0)
      I=MAXSP/8
      IF (MOD(MAXSP,8).GT.0) I=I+1
      IRECNT = IRECNT + I
      IF(LKECHO)WRITE(JOSTND,5660)
 5660 FORMAT (T12,'LARGE TREE DIAMETER GROWTH MODEL ',
     >        'CORRECTION TERMS BY SPECIES:')
      IF(LKECHO)WRITE(JOSTND,5670) (NSP(I,1),COR2(I),I=1,MAXSP)
 5670 FORMAT((T12,7(A2,' =',F5.2,:,'; '),A2,' =',F5.2))
      GO TO 10
C
C  ==========  OPTION NUMBER 55: REUSCORD ===========================REUSCORD
C
 5700 CONTINUE
      IF(LKECHO)WRITE(JOSTND,5610) KEYWRD
      LDCOR2 = .TRUE.
      GO TO 10
C
C  ==========  OPTION NUMBER 56: NOCALIB  ===========================NOCALIB
C
 5800 CONTINUE
C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (1,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(IS.EQ.-999) GO TO 10
C----------
C     IF (IS<0) CHANGE ALL SPECIES IN THE GROUP
C----------
      IF(IS .LT. 0) THEN
        IGRP = -IS
        IULIM = ISPGRP(IGRP,1)+1
        DO 5801 IG=2,IULIM
        IGSP = ISPGRP(IGRP,IG)
        LDGCAL(IGSP)=.FALSE.
        LHTCAL(IGSP)=.FALSE.
 5801   CONTINUE
        ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,5808) KEYWRD,KARD(1)(1:ILEN),IS
C----------
C     IF (IS=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C----------
      ELSEIF(IS .EQ. 0)THEN
        DO 5803 J=1,MAXSP
        LDGCAL(J) = .FALSE.
        LHTCAL(J) = .FALSE.
 5803   CONTINUE
        IF(LKECHO)WRITE(JOSTND,5804) KEYWRD
 5804   FORMAT(/A8,'   CALIBRATION USING GROWTH DATA FROM TREE',
     >        ' RECORDS HAS BEEN SUPPRESSED FOR ALL SPECIES')
C----------
C     SPECIES CODE IS SPECIFIED (IS>0).
C----------
      ELSE
        LDGCAL(IS)=.FALSE.
        LHTCAL(IS)=.FALSE.
        ILEN=3
        IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,5808) KEYWRD,KARD(1)(1:ILEN),IS
 5808   FORMAT (/A8,'   CALIBRATION USING GROWTH DATA FROM TREE',
     > ' RECORDS WILL BE SUPPRESSED FOR SPECIES= ',A,' (CODE= ',I3,')')
      ENDIF
      GO TO 10
C
C  ==========  OPTION NUMBER 57: DGSTDEV  ===========================DGSTDEV
C
 5900 CONTINUE
      IF ( LNOTBK(1) ) DGSD = ARRAY(1)
      IF(LKECHO)WRITE(JOSTND,5910) KEYWRD,DGSD
 5910 FORMAT (/A8,'   RANDOM VARIATION THAT IS ADDED TO PREDICTED ',
     > 'DIAMETER GROWTH IS BOUNDED TO ',F4.1,' STANDARD DEVIATIONS.')
      IF ((DGSD.LT.1.0).AND.LKECHO)WRITE(JOSTND,5920)
 5920 FORMAT (T12,'NO RANDOM VARIATION IS ADDED TO DIAMETER ',
     >       'GROWTH PREDICTIONS.')
      GO TO 10
C
C  ==========  OPTION NUMBER 58: BAIMULT  ===========================BAIMULT
C
 6000 CONTINUE
      I=91
 6005 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.LE.0) GOTO 6010
      IF (IPRMPT.NE.2) THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,25)
      ELSE
         CALL OPNEWC (KODE,JOSTND,IREAD,IDT,I,KEYWRD,KARD,
     >                IPRMPT,IRECNT,ICYC)
         CALL fvsGetRtnCode(IRTNCD)
         IF (IRTNCD.NE.0) RETURN
      ENDIF
      GOTO 10
 6010 CONTINUE
      IF (.NOT.LNOTBK(3)) ARRAY(3)=1.0
C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(IS.EQ.-999) GO TO 10
      CALL OPNEW(KODE,IDT,I,2,ARRAY(2))
      IF (KODE.GT.0) GOTO 10
      ILEN=3
      IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
      IF(LKECHO)WRITE(JOSTND,6030) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     &                             ARRAY(3)
 6030 FORMAT (/A8,'   DATE/CYCLE=',I5,'; SPECIES=',A,' (CODE= ',
     >        I3,'); MULTIPLIER=',F10.4)
      GOTO 10
C
C  ==========  OPTION NUMBER 59: MORTMULT  ==========================MORTMULT
C
 6100 CONTINUE
      LMORT=.TRUE.
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.GT.0) THEN
         IF(IPRMPT.NE.2)THEN
           CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
           CALL ERRGRO (.TRUE.,25)
         ELSE
           CALL OPNEWC (KODE,JOSTND,IREAD,IDT,94,KEYWRD,KARD,IPRMPT,
     >                IRECNT,ICYC)
           CALL fvsGetRtnCode(IRTNCD)
           IF (IRTNCD.NE.0) RETURN
         ENDIF
         GO TO 10
      ENDIF
C
C     SPECIES CODE PROCESSING.
C
      CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
         IF (IS.EQ.-999) GOTO 10
         IF(.NOT.LNOTBK(3)) ARRAY(3)=1.0
         IF(.NOT.LNOTBK(5)) ARRAY(5)=999.0
         ARRAY(6)=0.
         IF(ARRAY(4).GE.ARRAY(5))THEN
            CALL ERRGRO (.TRUE.,4)
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         ELSE
            CALL OPNEW (KODE,IDT,94,4,ARRAY(2))
            IF (KODE.GT.0) GOTO 10
            ILEN=3
            IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
            IF(LKECHO)WRITE(JOSTND,6131) KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     >            ARRAY(3)
 6131       FORMAT(/A8,'   DATE/CYCLE=',I5,'; SPECIES= ',A,
     >          ' (CODE= ',I3,'); MULTIPLIER=',F10.2)
            IF ((ARRAY(3).GT.0.0).AND.LKECHO)WRITE(JOSTND,6130)
     >                             ARRAY(4),ARRAY(5)
 6130       FORMAT (T12,'ONLY TREES GREATER THAN ',F7.2,
     >        ' AND LESS THAN ',F7.2,' INCHES DBH ARE AFFECTED.')
         ENDIF
      GOTO 10
C
C  ==========  OPTION NUMBER 60: NOHTDREG ===========================NOHTDREG
C
 6200 CONTINUE
C
C     PROCESS BASED ON SPECIES CODE.
C
      CALL SPDECD (1,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF (IS.EQ.-999) GOTO 10
C----------
C     IF (IS<0) CHANGE ALL SPECIES IN THE GROUP
C----------
      IF(IS .LT. 0) THEN
        IGRP = -IS
        IULIM = ISPGRP(IGRP,1)+1
        DO 6201 IG=2,IULIM
        IGSP = ISPGRP(IGRP,IG)
         IF(LNOTBK(2).AND.ARRAY(2).GT.0.) THEN
           LHTDRG(IGSP)=.TRUE.
         ELSE
           LHTDRG(IGSP)=.FALSE.
         ENDIF
 6201   CONTINUE
         ILEN=ISPGRP(-IS,92)
         IF(LNOTBK(2).AND.ARRAY(2).GT.0.) THEN
           IF(LKECHO)WRITE(JOSTND,6215) KEYWRD,KARD(1)(1:ILEN),IS
         ELSE
           IF(LKECHO)WRITE(JOSTND,6230) KEYWRD,KARD(1)(1:ILEN),IS
         ENDIF
C----------
C     IF (IS=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C----------
      ELSEIF(IS .EQ. 0)THEN
C
C        IF FIELD 2 IS BLANK OR ZERO SUPPRESS CALIBRATION FOR ALL
C        SPECIES, OTHERWISE INVOKE CALIBRATION FOR ALL SPECIES.
C
         IF(LNOTBK(2).AND.ARRAY(2).GT.0) THEN
           DO 6205 J=1,MAXSP
           LHTDRG(J) = .TRUE.
 6205      CONTINUE
           IF(LKECHO)WRITE(JOSTND,6206) KEYWRD
 6206      FORMAT(/A8,'   CALIBRATION OF HEIGHT-DIAMETER',
     >        ' RELATIONSHIP WILL BE  INVOKED   FOR ALL SPECIES')
         ELSE
           DO 6210 J=1,MAXSP
           LHTDRG(J) = .FALSE.
 6210      CONTINUE
           IF(LKECHO)WRITE(JOSTND,6220) KEYWRD
 6220      FORMAT(/A8,'   CALIBRATION OF HEIGHT-DIAMETER',
     >        ' RELATIONSHIP WILL BE SUPPRESSED FOR ALL SPECIES')
         ENDIF
C----------
C     SPECIES CODE IS SPECIFIED (IS>0).
C----------
      ELSE
C
C        IF FIELD 2 IS BLANK OR ZERO ONLY ONE SPECIES GETS SUPPRESSED;
C        OTHERWISE ONE SPECIES GETS INVOKED.
C
         ILEN=3
         IF(LNOTBK(2).AND.ARRAY(2).GT.0.) THEN
           LHTDRG(IS)=.TRUE.
           IF(LKECHO)WRITE(JOSTND,6215) KEYWRD,KARD(1)(1:ILEN),IS
 6215      FORMAT (/A8,'   CALIBRATION OF HEIGHT-DIAMETER ',
     >           'RELATIONSHIP WILL BE  INVOKED   FOR SPECIES= ',A,
     >           ' (CODE= ',I3,')')
         ELSE
           LHTDRG(IS)=.FALSE.
           IF(LKECHO)WRITE(JOSTND,6230) KEYWRD,KARD(1)(1:ILEN),IS
 6230      FORMAT (/A8,'   CALIBRATION OF HEIGHT-DIAMETER ',
     >           'RELATIONSHIP WILL BE SUPPRESSED FOR SPECIES= ',A,
     >           ' (CODE= ',I3,')')
         ENDIF
      ENDIF
      GO TO 10
C
C  ==========  OPTION NUMBER 61: RANNSEED  ==========================RANNSEED
C
 6300 CONTINUE
      IF (LNOTBK(1).AND.ARRAY(1).EQ.0.0) CALL GETSED (ARRAY(1))
      CALL RANSED (LNOTBK(1),ARRAY(1))
      IF(LKECHO)WRITE(JOSTND,6310) KEYWRD,ARRAY(1)
 6310 FORMAT (/A8,'   RANDOM SEED IS:',F14.1)
      GO TO 10
C
C  ==========  OPTION NUMBER 62: HTGMULT  ===========================HTGMULT
C
 6400 CONTINUE
      I=92
      GOTO 6005
C
C  ==========  OPTION NUMBER 63: CHEAPO  ============================CHEAPO
C
 6500 CONTINUE
      IF ( LNOTBK(1) ) JOSUME = IFIX(ARRAY(1))
      LECBUG = LNOTBK(6)
      LECON =.TRUE.
      IF(LKECHO)WRITE(JOSTND,1410) KEYWRD,JOSUME
      LECON = .TRUE.
      IF (LECBUG.AND.LKECHO)WRITE(JOSTND,6510) LECBUG
 6510 FORMAT (T12,'ECONOMIC SUMMARY DEBUG REQUESTED.  LECBUG=',L2)
      CALL ECAVAL
      GO TO 10
C
C  ==========  OPTION NUMBER 64: NUMTRIP  ===========================NUMTRIP
C
 6600 CONTINUE
      IF (LNOTBK(1)) ICL4 = IFIX ( ARRAY(1) )
      IF(LKECHO)WRITE(JOSTND,6610) KEYWRD,ICL4
 6610 FORMAT (/A8,'   NUMBER OF TRIPLES LIMITED TO',I3)
      GO TO 10
C
C  ==========  OPTION NUMBER 65: ENDFILE  ===========================ENDFILE
C
 6700 CONTINUE
      I = JOSUM
      IF ( ARRAY(1) .GE. 1. ) I = IFIX ( ARRAY(1) )
      END FILE I
      IF(LKECHO)WRITE(JOSTND,1410) KEYWRD,I
      GO TO 10
C
C  ==========  OPTION NUMBER 66: BAMAX  =============================BAMAX
C
 6800 CONTINUE
      LMORT=.TRUE.
      IF(ARRAY(1).GT.0.0) THEN
        BAMAX=ARRAY(1)
        LBAMAX=.TRUE.
      ENDIF
      IF(LKECHO)WRITE(JOSTND,6810) KEYWRD,BAMAX
 6810 FORMAT (/A8,'   MAXIMUM BASAL AREA=',F10.2)
      GO TO 10
C
C  ==========  OPTION NUMBER 67: READCORH  ==========================READCORH
C
 6900 CONTINUE
      LHCOR2 = .TRUE.
      IF(LKECHO)WRITE(JOSTND,6910) KEYWRD
 6910 FORMAT (/A8,'   LARGE TREE HEIGHT GROWTH MODELS ',
     >   'ARE MODIFIED WITH CORRECTION TERMS PRIOR TO CALIBRATION.')
      READ (IREAD,5650,END=80) HCOR2
      I=MAXSP/8
      IF (MOD(MAXSP,8).GT.0) I=I+1
      IRECNT = IRECNT + I
      IF(LKECHO)WRITE(JOSTND,6920)
 6920 FORMAT (T12,'LARGE TREE HEIGHT GROWTH MODEL ',
     >        'CORRECTION TERMS BY SPECIES:')
      IF(LKECHO)WRITE(JOSTND,5670) (NSP(I,1),HCOR2(I),I=1,MAXSP)
      GO TO 10
C
C  ==========  OPTION NUMBER 68: REUSCORH  ==========================REUSCORH
C
 7000 CONTINUE
      LHCOR2 = .TRUE.
      IF(LKECHO)WRITE(JOSTND,6910) KEYWRD
      GO TO 10
C
C  ==========  OPTION NUMBER 69: MGMTID    ==========================MGMTID
C
 7100 CONTINUE
      IF(LKECHO)WRITE(JOSTND,9999) KEYWRD
      READ (IREAD,7105,END=80) MGMID
 7105 FORMAT (A4)
      IRECNT = IRECNT+1
      IF(LKECHO)WRITE(JOSTND,7110) MGMID
 7110 FORMAT (T12,'MANAGEMENT ID= ',A4)
      GO TO 10
C
C  ==========  OPTION NUMBER 70: REGHMULT  ==========================REGHMULT
C
 7200 CONTINUE
      I=93
      GOTO 6005
C
C  ==========  OPTION NUMBER 71: TCONDMLT  ==========================TCONDMLT
C
 7300 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,202,KEYWRD,KARD,
     >                   IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
         GOTO 10
      ENDIF
      IF (LNOTBK(2).OR.LNOTBK(3).OR.LNOTBK(4).OR.LNOTBK(5).OR.
     & LNOTBK(6)) GOTO 7320
      CALL KEYDMP(JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
      CALL ERRGRO (.TRUE.,4)
      GOTO 10
 7320 CONTINUE
      CALL OPNEW(KODE,IDT,202,5,ARRAY(2))
      IF (KODE .GT. 0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,7330) KEYWRD,IDT,ARRAY(2),ARRAY(3),
     &ARRAY(4),ARRAY(5),ARRAY(6)
 7330 FORMAT (/A8,'   DATE/CYCLE=',I5,
     >        '; TREE SUBCLASS MULTIPLIER=',F6.1,
     >        '; SPECIAL TREE STATUS MULTIPLIER=',F8.1,
     >        ';',/T12,'POINT BASAL AREA MULTIPLIER=',F8.1,
     >        '; POINT CCF MULTIPLIER=',F8.1,
     >        '; POINT TPA MULTIPLIER=',F8.1)
      GOTO 10
C
C  ==========  OPTION NUMBER 72: NOAUTOES  ==========================NOAUTOES
C
 7400 CONTINUE
C
C     CALL ESNOAU (ENTRY IN ESIN) TO SET NO AUTOMATIC ESTAB.
C
      CALL ESNOAU (KEYWRD,LKECHO)
      GOTO 10
C
C  ==========  OPTION NUMBER 73: READCORR  ==========================READCORR
C
 7500 CONTINUE
      LRCOR2 = .TRUE.
      IF(LKECHO)WRITE(JOSTND,7510) KEYWRD
 7510 FORMAT (/A8,'   SMALL TREE HEIGHT GROWTH MODELS ',
     >   'ARE MODIFIED WITH CORRECTION TERMS PRIOR TO CALIBRATION.')
      READ (IREAD,5650,END=80) RCOR2
      I=MAXSP/8
      IF (MOD(MAXSP,8).GT.0) I=I+1
      IRECNT = IRECNT + I
      IF(LKECHO)WRITE(JOSTND,7520)
 7520 FORMAT (T12,'SMALL TREE HEIGHT GROWTH MODEL ',
     >        'CORRECTION TERMS BY SPECIES:')
      IF(LKECHO)WRITE(JOSTND,5670) (NSP(I,1),RCOR2(I),I=1,MAXSP)
      GO TO 10
C
C  ==========  OPTION NUMBER 74: REUSCORR  ==========================REUSCORR
C
 7600 CONTINUE
      LRCOR2=.TRUE.
      IF(LKECHO)WRITE(JOSTND,7510) KEYWRD
      GO TO 10
C
C  ==========  OPTION NUMBER 75: BRUST     ==========================BRUST
C
 7700 CONTINUE
      IF(LKECHO)WRITE(JOSTND,7710) KEYWRD
 7710 FORMAT(/A8,'   BLISTER RUST KEYWORDS:')
      CALL BRIN (KEYWRD,ARRAY,LNOTBK,LKECHO)
      GO TO 10
C
C  ==========  OPTION NUMBER 76: IF        ==========================IF
C
 7800 CONTINUE
      CALL EVIF (KEYWRD,ARRAY,LNOTBK,IRECNT,IREAD,RECORD,KARD,
     >           JOSTND,DEBUG,LKECHO)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN
      GO TO 10
C
C  ==========  OPTION NUMBER 77: SCREEN    ==========================SCREEN
C
 7900 CONTINUE
      LSCRN=.TRUE.
      IF (LNOTBK(1)) JOSCRN=INT(ARRAY(1))
      IF(LKECHO)WRITE(JOSTND,7910) KEYWRD,JOSCRN
 7910 FORMAT (/A8,'   SUMMARY TABLE WILL BE PRINTED TO DATA SET ',
     >               'REFERENCE NUMBER ',I5,' AS RUN PROGRESSES.')
      GO TO 10
C
C  ==========  OPTION NUMBER 78: COMPRESS  ==========================COMPRESS
C
 8000 CONTINUE
      IF (.NOT.LNOTBK(2)) ARRAY(2)= MAXTRE/2
      IF (.NOT.LNOTBK(3)) ARRAY(3)=  50.
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
      CALL OPNEW (KODE,IDT,250,2,ARRAY(2))
      IF (KODE.GT.0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,8020) KEYWRD,IDT,(ARRAY(I),I=2,3)
 8020 FORMAT(/A8,'   DATE/CYCLE=',I5,'; TARGET TREE RECORDS=',F5.0,
     >       '; FIND ',F5.0,' PERCENT OF THE NEW RECORDS BY DEFINING'/
     >       T12,'TREE-CLASS BOUNDARIES WHERE THE LARGEST ',
     >       'DIFFERENCES ARE BETWEEN TREES.  DEFINE THE REMAINING'/
     >       T12,'CLASSES BY SPLITTING THOSE WHICH HAVE THE LARGEST ',
     >       'RANGES.')
      GO TO 10
C
C  ==========  OPTION NUMBER 79:  THEN     ==========================THEN
C
 8100 CONTINUE
      CALL EVTHEN (DEBUG,JOSTND,IREAD,IRECNT,KEYWRD,ARRAY,LNOTBK,
     >             KARD,IPRMPT,LKECHO)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN

      GOTO 10
C
C  ==========  OPTION NUMBER 80:  ALSOTRY  ==========================ALSOTRY
C
 8200 CONTINUE
      CALL EVALSO (DEBUG,JOSTND,IREAD,IRECNT,KEYWRD,ARRAY,LNOTBK,
     >             KARD,IPRMPT)
      GOTO 10
C
C  ==========  OPTION NUMBER 81:  ENDIF    ==========================ENDIF
C
 8300 CONTINUE
      IPRMPT=0
      CALL EVEND  (DEBUG,JOSTND,IRECNT,KEYWRD,ARRAY,LNOTBK,KARD,IPRMPT,
     &             LKECHO)
      GOTO 10
C
C  ==========  OPTION NUMBER 82:  NOTREES  ==========================NOTREES
C
 8400 CONTINUE
      LNOTRE=.TRUE.
      IF(LKECHO)WRITE(JOSTND,8410) KEYWRD
 8410 FORMAT (/A8,'   NO PROJECTABLE TREE RECORDS EXPECTED.')
      CALL ESEZCR(JOSTND,LKECHO)
      GOTO 10
C
C  ==========  OPTION NUMBER 83:  CALBSTAT ==========================CALBSTAT
C
 8500 CONTINUE
      JOCALB=JOSUME
      IF (LNOTBK(1)) JOCALB=IFIX(ARRAY(1))
      IF (LNOTBK(2)) FNMIN=ARRAY(2)
      IF (FNMIN.LT.3.)FNMIN=3.
      IF (LNOTBK(3)) NCALHT=IFIX(ARRAY(3))
      IF (NCALHT.LT.3) NCALHT=3
      IF(LKECHO)WRITE(JOSTND,8510) KEYWRD,JOCALB,FNMIN,NCALHT
 8510 FORMAT (/A8,'   CALIBRATION STATISTICS WILL BE ',
     >        'WRITTEN TO FILE REFERENCED BY NUMBER ',I2/
     >        T12,'MINIMUM NUMBER OF DIA. GROWTH OBSERVATIONS PER ',
     >        'SPECIES TO CALIBRATE '/
     >        T12,'THE LARGE TREE DIAMETER INCREMENT ',
     >        'MODEL FOR LOCAL CONDITIONS= ',F6.0/
     >        T12,'MINIMUM NUMBER OF HEIGHT GROWTH OBSERVATIONS PER ',
     >        'SPECIES TO CALIBRATE '/
     >        T12,'THE SMALL TREE HEIGHT INCREMENT ',
     >        'MODEL FOR LOCAL CONDITIONS= ',I6)
      GOTO 10
C
C  ==========  OPTION NUMBER 84: OPEN      ==========================OPEN
C
 8600 CONTINUE
      CALL KEYOPN (IREAD,RECORD,JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN

      GOTO 10
C
C  ==========  OPTION NUMBER 85: CLOSE     ==========================CLOSE
C
 8700 CONTINUE
      IF (ARRAY(1).GT.0.0) GOTO 8710
      CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
      CALL ERRGRO (.TRUE.,4)
      GOTO 10
 8710 CONTINUE
      I=INT(ARRAY(1))
      IF(LKECHO)WRITE(JOSTND,8720) KEYWRD,I
 8720 FORMAT (/A8,'   DATA SET REFERENCE NUMBER = ',I5)
      CLOSE (UNIT=I)
      GOTO 10
C
C  ==========  OPTION NUMBER 86: NOSCREEN  ==========================NOSCREEN
C
 8800 CONTINUE
      LSCRN=.FALSE.
      IF(LKECHO)WRITE(JOSTND,8810) KEYWRD
 8810 FORMAT (/A8,'   SCREEN OUTPUT DEACTIVATED.')
      GOTO 10
C
C  ==========  OPTION NUMBER 87: RRIN      ==========================RRIN
C
 8900 CONTINUE
      IF(LKECHO)WRITE(JOSTND,8910) KEYWRD
 8910 FORMAT (/A8,'   ROOT DISEASE MODEL IS OBSOLETE, USE',/,
     &                ' WESTERN ROOT DISEASE MODEL VER. 3.0:')
      GOTO 10
C
C  ==========  OPTION NUMBER 88:  FIXMORT  ==========================FIXMORT
C
 9000 CONTINUE
      LMORT=.TRUE.
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,97,KEYWRD,KARD,
     >                   IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
      ELSE
C
C        SPECIES CODE PROCESSING.
C
         CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &                ARRAY,KARD)
         IF (IS.EQ.-999) GOTO 10
         IF(.NOT.LNOTBK(3))ARRAY(3)=0.
         IF(.NOT.LNOTBK(4))ARRAY(4)=0.
         IF(.NOT.LNOTBK(5))ARRAY(5)=999.
         IF ((ARRAY(3) .GT. 1) .AND. (ARRAY(6) .LT. 3)) ARRAY(3) = 1.0
         IF ((ARRAY(3) .LT. 0) .AND. (ARRAY(6) .LT. 3)) ARRAY(3) = 0.0              
         ILEN=3
         IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
         IF(LKECHO)WRITE(JOSTND,9030) KEYWRD,IDT,KARD(2)(1:ILEN),
     >                       IS,ARRAY(3),ARRAY(4),ARRAY(5),ARRAY(6)
 9030    FORMAT (/A8,'   DATE/CYCLE=',I5,'; SPECIES=',A,' (CODE=',
     >   I3,'); MORTALITY RATE=',F10.4/
     >   T12,'ONLY TREES GREATER THAN ',F7.2,' AND LESS THAN ',
     >   F7.2,' INCHES DBH ARE AFFECTED.'/T12,'TYPE CODE = ',
     >   F3.0,'; (0=REPLACE MODEL PREDICTION, 1=ADD TO MODEL',
     >   ' PREDICTION, 2=USE MAXIMUM RATE, 3=MULTIPLY MODEL BY).')
         IF(LNOTBK(7).AND.ARRAY(7).GT.0.)THEN
           IF(ARRAY(7) .EQ. 1)THEN
             IF(LKECHO)WRITE(JOSTND,9032)ARRAY(7)
 9032        FORMAT(T12,'FIXMORT MORTALITY CONCENTRATION CODE = ',F4.0,
     >       '; (BY POINT)')
           ELSEIF(ARRAY(7).EQ.10)THEN
             IF(LKECHO)WRITE(JOSTND,9033)ARRAY(7)
 9033        FORMAT(T12,'FIXMORT MORTALITY CONCENTRATION CODE = ',F4.0,
     >       '; (BY SIZE: SMALLEST TO LARGEST DBH)')
           ELSEIF(ARRAY(7).EQ.11)THEN
             IF(LKECHO)WRITE(JOSTND,9034)ARRAY(7)
 9034        FORMAT(T12,'FIXMORT MORTALITY CONCENTRATION CODE = ',F4.0,
     >       '; (BY POINT BY SIZE: SMALLEST TO LARGEST DBH)')
           ELSEIF(ARRAY(7).EQ.20)THEN
             IF(LKECHO)WRITE(JOSTND,9035)ARRAY(7)
 9035        FORMAT(T12,'FIXMORT MORTALITY CONCENTRATION CODE = ',F4.0,
     >       '; (BY SIZE: LARGEST TO SMALLEST DBH)')
           ELSEIF(ARRAY(7).EQ.21)THEN
             IF(LKECHO)WRITE(JOSTND,9036)ARRAY(7)
 9036        FORMAT(T12,'FIXMORT MORTALITY CONCENTRATION CODE = ',F4.0,
     >       '; (BY POINT BY SIZE: LARGEST TO SMALLEST DBH)')
           ELSE
             WRITE(JOSTND,9037)ARRAY(7)
 9037        FORMAT(T12,'FIXMORT MORTALITY CONCENTRATION CODE = ',F4.0,
     >       '; (CODE NOT RECOGNIZED, IT WILL BE IGNORED)')
           ENDIF
         ENDIF
         CALL OPNEW (KODE,IDT,97,6,ARRAY(2))
         IF (KODE.GT.0) GOTO 10
      ENDIF
      GOTO 10
C
C  ==========  OPTION NUMBER 89: SDIMAX    ==========================SDIMAX
C
 9100 CONTINUE
C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (1,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(IS.EQ.-999) GO TO 10
      LMORT=.TRUE.
      IF(LKECHO)WRITE(JOSTND,9101) KEYWRD
 9101 FORMAT(/A8)
C
C   PROCESS MAX SDI IF NON-ZERO VALUE ENTERED.
C
      IF (ARRAY(2) .GT. 0.0) THEN
C----------
C     IF (IS<0) CHANGE ALL SPECIES IN THE GROUP
C----------
        IF(IS .LT. 0) THEN
          IGRP = -IS
          IULIM = ISPGRP(IGRP,1)+1
          DO 9102 IG=2,IULIM
          IGSP = ISPGRP(IGRP,IG)
          SDIDEF(IGSP)=ARRAY(2)
          MAXSDI(IGSP)=1
 9102     CONTINUE
          ILEN=ISPGRP(-IS,92)
          IF(LKECHO)WRITE(JOSTND,9108) KARD(1)(1:ILEN),IS,ARRAY(2)
C----------
C     IF (IS=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C----------
        ELSEIF(IS .EQ. 0)THEN
          DO 9103 J=1,MAXSP
          SDIDEF(J) = ARRAY(2)
          MAXSDI(J)=1
 9103     CONTINUE
          IF(LKECHO)WRITE(JOSTND,9104) ARRAY(2)
 9104     FORMAT(/8X,'   MAXIMUM PERMISSABLE STAND DENSITY INDEX',
     >        ' WILL BE CHANGED FOR ALL SPECIES ; MAX SDI=',F6.0)
C----------
C     SPECIES CODE IS SPECIFIED (IS>0).
C----------
        ELSE
          SDIDEF(IS)=ARRAY(2)
          MAXSDI(IS)=1
          ILEN=3
          IF(LKECHO)WRITE(JOSTND,9108) KARD(1)(1:ILEN),IS,ARRAY(2)
 9108     FORMAT (/8X,'   MAXIMUM PERMISSABLE STAND DENSITY INDEX',
     >    ' WILL BE CHANGED FOR SPECIES= ',A,' (CODE= ',I3,
     >    '); MAX SDI=',F6.0)
        ENDIF
      ENDIF
C
C   PROCESS OTHER PARAMETER FIELDS. FIELDS 3 & 4 NO LONGER USED.
C
      IF (LNOTBK(5)) PMSDIL=ARRAY(5)
      IF(PMSDIL .LT. 10.) PMSDIL=10.
      IF (LNOTBK(6)) PMSDIU=ARRAY(6)
      IF(PMSDIU .GT. 95.) PMSDIU=95.
C
      IF(LKECHO)WRITE(JOSTND,9109) PMSDIL,PMSDIU
 9109 FORMAT (T12,
     >  'PERCENT OF MAX SDI TO',
     >  ' INVOKE DENSITY RELATED MORTALITY=',F5.1,'; PERCENT OF MAX',
     >  ' SDI WHERE STAND REACHES MAX DENSITY=',F5.1)
C
C   PROCESS STAGNATION INDICATOR (CENTRAL ROCKIES VARIANT)
C
      SELECT CASE (VARACD)
C
        CASE ('CR','TT','UT')
C
          IF(LNOTBK(7)) THEN
            IF(IS .LT. 0) THEN
              IGRP = -IS
              IULIM = ISPGRP(IGRP,1)+1
              DO 9112 IG=2,IULIM
              IGSP = ISPGRP(IGRP,IG)
              ISTAGF(IGSP)=INT(ARRAY(7))
 9112         CONTINUE
              ILEN=ISPGRP(-IS,92)
              IF(LKECHO)WRITE(JOSTND,9117) KARD(1)(1:ILEN),IS,ARRAY(7)
            ELSEIF(IS .EQ. 0) THEN
              DO 9115 J=1,MAXSP
              ISTAGF(J) = INT(ARRAY(7))
 9115         CONTINUE
              IF(LKECHO)WRITE(JOSTND,9116) ARRAY(7)
 9116         FORMAT(8X,'   STAGNATION EFFECTS INDICATOR',
     >        ' WILL BE CHANGED FOR ALL SPECIES ; INDICATOR =',F4.0)
            ELSE
C
C   ONLY ONE SPECIES GETS CHANGED
C
              ISTAGF(IS)=INT(ARRAY(7))
              ILEN=3
              IF(LKECHO)WRITE(JOSTND,9117) KARD(1)(1:ILEN),IS,ARRAY(7)
 9117         FORMAT (8X,'   STAGNATION EFFECTS INDICATOR',
     >        ' WILL BE CHANGED FOR SPECIES= ',A,' (CODE= ',I3,
     >        '); INDICATOR =',F4.0)
            ENDIF
          ENDIF
C
        CASE DEFAULT
          IF(LNOTBK(7)) THEN
            IF(LKECHO)WRITE(JOSTND,9120)
 9120       FORMAT(8X,'   STAGNATION EFFECTS NOT USED IN THIS VARIANT.')
          ENDIF
C
      END SELECT
      GOTO 10
C
C  ==========  OPTION NUMBER 90: DELOTAB   ==========================DELOTAB
C
 9200 CONTINUE
      JJTAB = 0
      IF(LNOTBK(1)) JJTAB = IFIX(ARRAY(1))
C
      IF(JJTAB .EQ. 0) THEN
        DO 9210 I=1,5
        ITABLE(I) = 1
 9210   CONTINUE
        IF(LKECHO)WRITE(JOSTND,9215)KEYWRD
 9215   FORMAT(/A8,'   NO TABLE SPECIFIED, ALL OPTIONAL TABLES',
     &  ' WILL BE DELETED.')
        GO TO 10
      ENDIF
C
      IF(JJTAB .GT. 4) THEN
        IF(LKECHO)WRITE(JOSTND,9220) KEYWRD,JJTAB
 9220   FORMAT(/A8,'   TABLE NUMBER',I4,'  SPECIFIED. THIS IS',
     &  ' AN INVALID TABLE NUMBER. KEYWORD IGNORED.')
        GO TO 10
      ENDIF
C
      ITABLE(JJTAB)=1
      IF((JJTAB.EQ.1).AND.LKECHO)WRITE(JOSTND,9226)KEYWRD,JJTAB
 9226 FORMAT(/A8,'   TABLE NUMBER',I4,'  SPECIFIED. ',
     &' STAND COMPOSITION TABLE WILL BE DELETED.')
      IF((JJTAB.EQ.2).AND.LKECHO)WRITE(JOSTND,9225)KEYWRD,JJTAB
 9225 FORMAT(/A8,'   TABLE NUMBER',I4,'  SPECIFIED. ',
     &' SAMPLE TREE TABLE WILL BE DELETED.')
      IF((JJTAB.EQ.3).AND.LKECHO)WRITE(JOSTND,9227)KEYWRD,JJTAB
 9227 FORMAT(/A8,'   TABLE NUMBER',I4,'  SPECIFIED. ',
     &' SUMMARY OUTPUT TABLE WILL BE DELETED.')
      IF((JJTAB.EQ.4).AND.LKECHO)WRITE(JOSTND,9228)KEYWRD,JJTAB
 9228 FORMAT(/A8,'   TABLE NUMBER',I4,'  SPECIFIED. ',
     &' ACTIVITY SCHEDULE TABLE WILL BE DELETED.')
      IF((JJTAB.EQ.5).AND.LKECHO)WRITE(JOSTND,9229)KEYWRD,JJTAB
 9229 FORMAT(/A8,'   TABLE NUMBER',I4,'  SPECIFIED. ',
     &' THIS IS NOT FUNCTIONAL AT THIS TIME.')
      GO TO 10
C
C  ==========  OPTION NUMBER 91: SERLCORR  ==========================SERLCORR
C
 9300 CONTINUE
      IF(LNOTBK(1)) BJPHI=ARRAY(1)
      IF(LNOTBK(2)) BJTHET=ARRAY(2)
      IF(LKECHO)WRITE(JOSTND,9310) KEYWRD,BJPHI,BJTHET
 9310 FORMAT (/A8,'   ARMA(1,1) SERIAL CORRELATION PARAMETERS:',
     >      ' PHI=',F5.2,'; THETA=',F5.2)
      GOTO 10
C
C  ==========  OPTION NUMBER 92: CUTLIST   ==========================CUTLIST
C
 9400 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
      NP = 2
      IF (LNOTBK(4)) NP = 3
      IF (LNOTBK(6)) NP = 5
      IF (.NOT.LNOTBK(2)) ARRAY(2)=FLOAT(JOLIST)
      CALL OPNEW (KODE,IDT,199,NP,ARRAY(2))
      IF (KODE.GT.0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,9410) KEYWRD,IDT,ARRAY(2),ARRAY(3)
 9410 FORMAT (/A8,'   DATE/CYCLE=',I5,'; DATA SET REFERENCE ',
     >        'NUMBER =',F4.0,'; HEADING SUPPRESSION CODE =',F3.0/
     >        T12,'(0=WITH HEADING, OTHER VALUES=SUPPRESS HEADING).')
      IF((NP.EQ.3).AND.(ARRAY(4).EQ.2).AND.LKECHO)WRITE(JOSTND,9411)
 9411 FORMAT(T12,'CYCLE ONE CUTLIST SUPRESSED')
      IF((NP.EQ.5).AND.(ARRAY(6).GT.0).AND.LKECHO)WRITE(JOSTND,9412)
 9412 FORMAT(T12,'CUTLIST WILL BE IN OLD FORMAT')
      GOTO 10
C
C  ==========  OPTION NUMBER 93: RESETAGE  ==========================RESETAGE
C
 9500 CONTINUE
      IDT=1
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,443,KEYWRD,KARD,
     >                   IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
         GOTO 10
      ENDIF
C
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
      CALL OPNEW (KODE,IDT,443,1,ARRAY(2))
      IF (KODE.GT.0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,9510) KEYWRD,IDT,ARRAY(2)
 9510 FORMAT (/A8,'   DATE/CYCLE=',I5,'; NEW AGE=',F6.0)
      GOTO 10
C
C  ==========  OPTION NUMBER 94: SITECODE  ==========================SITECODE
C
 9600 CONTINUE
C
C   SITE SPECIES IS OBTAINED FROM THE FIRST SITECODE CARD WHICH
C   CONTAINS A VALUE IN FIELD 1 BETWEEN 1 AND MAXSP, OR CAN BE
C   SPECIFIED USING FIELD 3.  IF NONE OF THE SITECODE KEYWORDS HAVE A
C   SITE SPECIES SPECIFIED, THE DEFAULT IN **SITSET** WILL BE USED.
C   MAKE SURE THAT SITE SPECIES IS SET BEFORE LSITE IS SET TO TRUE.
C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (1,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(IS.EQ.-999) GO TO 10
      IPSI=1
C----------
C     IF (IS<0) CHANGE ALL SPECIES IN THE GROUP
C     IF SITE SPECIES HAS NOT BEEN SET, SET IT TO THE FIRST SPECIES
C     IN THE GROUP.
C----------
      IF(IS .LT. 0) THEN
        IGRP = -IS
        IULIM = ISPGRP(IGRP,1)+1
        IF (ISISP .EQ. 0) ISISP=ISPGRP(IGRP,2)
        LSITE=.TRUE.
        DO 9605 IG=2,IULIM
        IGSP = ISPGRP(IGRP,IG)
        IF (LNOTBK(2) .AND. ARRAY(2) .GT. 5.) SITEAR(IGSP)=ARRAY(2)
 9605   CONTINUE
        ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,9610) KEYWRD,KARD(1)(1:ILEN),IS,ARRAY(2)
C----------
C     IF (IS=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C----------
      ELSEIF(IS .EQ. 0)THEN
        IF (LNOTBK(2)) THEN
          IF (ARRAY(2) .LE. 5.) GO TO 9617
          DO 9616 K=1,MAXSP
          SITEAR(K)=ARRAY(2)
 9616     CONTINUE
 9617     CONTINUE
          IF(LKECHO)WRITE(JOSTND,9618) KEYWRD,ARRAY(2)
 9618     FORMAT(/A8,'   SITE CODE CHANGED FOR ALL SPECIES; ',
     >         ' SITE CODE FOR LARGE AND SMALL TREES=',F8.1)
        ELSE
          CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
          CALL ERRGRO (.TRUE.,4)
          GOTO 10
        ENDIF
C----------
C     SPECIES CODE IS SPECIFIED (IS>0).
C----------
      ELSE
        IF (ISISP .EQ. 0) ISISP=IS
        LSITE=.TRUE.
C
C   LOAD SITE ARRAY ONLY IF DUNNING CODES NOT BEING USED IE VALUES
C   GREATER THAN 7. THIS IS NECESSARY SO CALLS TO DUNN WILL SET ALL
C   SITE INDEX VALUES PROPERLY.
C
        IF (LNOTBK(2) .AND. ARRAY(2) .GT. 7.) SITEAR(IS)=ARRAY(2)
C
        ILEN=3
        IF(LKECHO)WRITE(JOSTND,9610) KEYWRD,KARD(1)(1:ILEN),IS,ARRAY(2)
 9610   FORMAT(/A8,'   SITE INDEX SPECIES= ',A,' (CODE= ',I3,
     >    ');  SITE CODE FOR LARGE AND SMALL TREES=',F8.1)
C
C   FIELD 3 INDICATES USE THIS SPECIES FOR SITE SPECIES. LSITE SET ABOVE
C
        IF(LNOTBK(3).AND.ARRAY(3).GT.0) THEN
          ISISP=IS
          IF(LKECHO)WRITE(JOSTND,9611)
 9611     FORMAT(8X,'   SITE INDEX SPECIES WILL BE USED AS THE SITE',
     &         ' SPECIES.')
        ENDIF
      ENDIF
C
C     CALL DUNN TO PROCESS ANY DUNNING SITE CODE INFORMATION.
C
      IF(LNOTBK(2) .AND. ARRAY(2) .LE. 7)THEN
C
        SELECT CASE (VARACD)
C
          CASE('CA','NC','SO','WS','OC')
            IF(LKECHO)WRITE(JOSTND,9620)
 9620       FORMAT(8X,'   FIELD 2 OF THE SITECODE KEWORD IS LESS',
     &      ' THAN 8 AND WILL BE INTERPRETED AS A DUNNING CODE.')
C
        END SELECT
        CALL DUNN(ARRAY(2))
      ENDIF
C
      GO TO 10
C
C  ==========  OPTION NUMBER 95:  MISTOE    =========================MISTOE
C
 9700 CONTINUE
      IF(LKECHO)WRITE(JOSTND,9710) KEYWRD
 9710 FORMAT(/A8,'   MISTLETOE KEYWORDS:')
      CALL MISIN (KEYWRD,ARRAY,LNOTBK,LKECHO)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN
      GOTO 10
C
C  ==========  OPTION NUMBER 96:  CRNMULT ===========================CRNMULT
C
 9800 CONTINUE
      IDT=1
      IF(LNOTBK(1))IDT=IFIX(ARRAY(1))
      IF (IPRMPT.GT.0) THEN
        IF(IPRMPT.NE.2) THEN
          CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
          CALL ERRGRO (.TRUE.,25)
        ELSE
          CALL OPNEWC (KODE,JOSTND,IREAD,IDT,81,KEYWRD,KARD,
     >                 IPRMPT,IRECNT,ICYC)
          CALL fvsGetRtnCode(IRTNCD)
          IF (IRTNCD.NE.0) RETURN
        ENDIF
        GO TO 10
      ENDIF
C
C   SPECIES CODE PROCESSING.
C
         CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
         IF(IS.EQ.-999) GO TO 10
         CALL OPNEW (KODE,IDT,81,5,ARRAY(2))
         IF (KODE.GT.0) GOTO 10
         IF (ARRAY(5) .LE. 0.0) ARRAY(5)=99.0
         ILEN=3
         IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
      IF(LKECHO)WRITE(JOSTND,9854)KEYWRD,IDT,KARD(2)(1:ILEN),IS,
     &                            (ARRAY(J),J=3,6)
 9854 FORMAT(/A8,'   DATE/CYCLE=',I5,';  SPECIES=',A,' (CODE= ',I3,
     &');  MULTIPLIER=',F7.2,';  LOWER DBH=',F6.1,';  UPPER DBH=',F6.1,
     &';  DUB FLAG=',F6.0)
      GOTO 10
C
C  ==========  OPTION NUMBER 97   CFVOLEQU  =========================CFVOLEQU
C
 9900 CONTINUE
C
C     READ COEFFICIENTS FROM 2 SUPPLEMENTAL RECORDS.
C
      READ(IREAD,9901,END=80) (WK6(I),I=1,14)
 9901 FORMAT(7F10.0/7F10.0)
      IRECNT=IRECNT+2
      LCVOLS=.TRUE.
C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (1,ISPC,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(ISPC.EQ.-999) GO TO 10
      ITC=IFIX(ARRAY(2))
      TC=ARRAY(3)
C----------
C     IF (ISPC<0) CHANGE ALL SPECIES IN THE GROUP
C----------
      IF(ISPC .LT. 0) THEN
        IGRP = -ISPC
        IULIM = ISPGRP(IGRP,1)+1
        DO 9905 IG=2,IULIM
        IGSP = ISPGRP(IGRP,IG)
        ICTRAN(IGSP)=ITC
        CTRAN(IGSP)=TC
        DO 9904 K=1,7
        J=K+7
        CFVEQS(K,IGSP)=WK6(K)
        CFVEQL(K,IGSP)=WK6(J)
 9904   CONTINUE
 9905   CONTINUE
        ILEN=ISPGRP(-ISPC,92)
        IF(LKECHO)WRITE(JOSTND,9968) KEYWRD,KARD(1)(1:ILEN),ISPC
C----------
C     IF (ISPC=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C----------
      ELSEIF(ISPC .EQ. 0) THEN
        DO 9907 I=1,MAXSP
        ICTRAN(I)=ITC
        CTRAN(I)=TC
        DO 9906 K=1,7
        J=K+7
        CFVEQS(K,I)=WK6(K)
        CFVEQL(K,I)=WK6(J)
 9906   CONTINUE
 9907   CONTINUE
        IF(LKECHO)WRITE(JOSTND,9908) KEYWRD
 9908   FORMAT(/A8,T12,'DEFAULT COEFFICIENTS FOR CUBIC FOOT VOLUME'/
     &              T12,'EQUATIONS REPLACED FOR ALL SPECIES.')
C----------
C     SPECIES CODE IS SPECIFIED (ISPC>0).
C----------
      ELSE
        ICTRAN(ISPC)=ITC
        CTRAN(ISPC)=TC
        DO 9915 K=1,7
        J=K+7
        CFVEQS(K,ISPC)=WK6(K)
        CFVEQL(K,ISPC)=WK6(J)
 9915   CONTINUE
        ILEN=3
        IF(LKECHO)WRITE(JOSTND,9918) KEYWRD,KARD(1)(1:ILEN),ISPC
 9918   FORMAT(/A8,T12,'DEFAULT COEFFICIENTS FOR CUBIC FOOT VOLUME'/
     &    T12,'EQUATIONS REPLACED FOR SPECIES= ',A,' (CODE= ',I3,').' )
      ENDIF
C
      IF(LKECHO)WRITE(JOSTND,9925) ITC,TC,(WK6(I),I=1,14)
 9925 FORMAT(T12,'TRANSITION SIZE CODE = ',I4,';   TRANSITION SIZE = ',
     &  F10.2/T12,'COEFFICIENTS FOR TREE THAT IS SMALLER THAN',
     &  ' TRANSITION SIZE:'/T12,7F12.5/
     &        T12,'COEFFICIENTS FOR TREE THAT IS LARGER THAN',
     &  ' TRANSITION SIZE:'/T12,7F12.5)
      GO TO 10
C
C  ==========  OPTION NUMBER 98: BFVOLEQU   =========================BFVOLEQU
C
 9950 CONTINUE
C
C     READ COEFFICIENTS FROM 2 SUPPLEMENTAL RECORDS.
C
      READ(IREAD,9901,END=80) (WK6(I),I=1,14)
      IRECNT=IRECNT+2
      LBVOLS=.TRUE.
C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (1,ISPC,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(ISPC.EQ.-999) GO TO 10
      ITB=IFIX(ARRAY(2))
      TB=ARRAY(3)
C----------
C     IF (ISPC<0) CHANGE ALL SPECIES IN THE GROUP
C----------
      IF(ISPC .LT. 0) THEN
        IGRP = -ISPC
        IULIM = ISPGRP(IGRP,1)+1
        DO 9955 IG=2,IULIM
        IGSP = ISPGRP(IGRP,IG)
        IBTRAN(IGSP)=ITB
        BTRAN(IGSP)=TB
        DO 9954 K=1,7
        J=K+7
        BFVEQS(K,IGSP)=WK6(K)
        BFVEQL(K,IGSP)=WK6(J)
 9954   CONTINUE
 9955   CONTINUE
        ILEN=ISPGRP(-ISPC,92)
        IF(LKECHO)WRITE(JOSTND,9968) KEYWRD,KARD(1)(1:ILEN),ISPC
C----------
C     IF (ISPC=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C----------
      ELSEIF(ISPC .EQ. 0) THEN
        DO 9957 I=1,MAXSP
        IBTRAN(I)=ITB
        BTRAN(I)=TB
        DO 9956 K=1,7
        J=K+7
        BFVEQS(K,I)=WK6(K)
        BFVEQL(K,I)=WK6(J)
 9956   CONTINUE
 9957   CONTINUE
        IF(LKECHO)WRITE(JOSTND,9958) KEYWRD
 9958   FORMAT(/A8,T12,'DEFAULT COEFFICIENTS FOR BOARD FOOT VOLUME'/
     &              T12,'EQUATIONS REPLACED FOR ALL SPECIES.')
C----------
C     SPECIES CODE IS SPECIFIED (ISPC>0).
C----------
      ELSE
        IBTRAN(ISPC)=ITB
        BTRAN(ISPC)=TB
        DO 9965 K=1,7
        J=K+7
        BFVEQS(K,ISPC)=WK6(K)
        BFVEQL(K,ISPC)=WK6(J)
 9965   CONTINUE
        ILEN=3
        IF(LKECHO)WRITE(JOSTND,9968) KEYWRD,KARD(1)(1:ILEN),ISPC
 9968   FORMAT(/A8,T12,'DEFAULT COEFFICIENTS FOR BOARD FOOT VOLUME'/
     &    T12,'EQUATIONS REPLACED FOR SPECIES= ',A,' (CODE= ',I3,').' )
      ENDIF
C
      IF(LKECHO)WRITE(JOSTND,9972) ITB,TB,(WK6(I),I=1,14)
 9972 FORMAT(T12,'TRANSITION SIZE CODE = ',I4,';   TRANSITION SIZE = ',
     &  F10.2/T12,'COEFFICIENTS FOR TREE THAT IS SMALLER THAN',

     &  ' TRANSITION SIZE:'/T12,7F12.5/
     &        T12,'COEFFICIENTS FOR TREE THAT IS LARGER THAN',
     &  ' TRANSITION SIZE:'/T12,7F12.5)
      GO TO 10
C
C  ==========  OPTION NUMBER 99: ANIN      ==========================ANIN
C
 9975 CONTINUE
      IF(LKECHO)WRITE(JOSTND,9977) KEYWRD
 9977 FORMAT (/A8,'   ANNOSUS ROOT DISEASE MODEL IS OBSOLETE, USE',/
     &                ' WESTERN ROOT DISEASE MODEL VER. 3.0:')
      GOTO 10
C
C  ==========  OPTION NUMBER 100: DFB      ==========================DFB
C
 9985 CONTINUE
      IF(LKECHO)WRITE(JOSTND,9987) KEYWRD
 9987 FORMAT (/A8,'   DOUGLAS-FIR BEETLE OPTIONS:')
      CALL DFBIN (KEYWRD,ARRAY,LNOTBK,LKECHO)
      GOTO 10
C
C  ==========  OPTION NUMBER 101: RDIN     ==========================RDIN
C
 9995 CONTINUE
      IF(LKECHO)WRITE(JOSTND,9997) KEYWRD
 9997 FORMAT (/A8,'   WESTERN ROOT DISEASE MODEL OPTIONS:')
      CALL RDIN (KEYWRD,ARRAY,LNOTBK,LKECHO)
      GOTO 10
C
C  ==========  OPTION NUMBER 102: MANAGED  ==========================MANAGED
C
10000 CONTINUE
      IDT=0
      IF(LNOTBK(1)) IDT=IFIX(ARRAY(1))
      IF(IDT .GT. 0) THEN
        CALL OPNEW (KODE,IDT,82,1,ARRAY(2))
        IF(KODE.GT.0) GO TO 10
        IF(LKECHO)WRITE(JOSTND,10010) KEYWRD,IDT,ARRAY(2)
10010   FORMAT(/A8,'   DATE/CYCLE=',I5,'; MANAGED = ',F5.0)
      ELSE
        IF(LNOTBK(2) .AND. ARRAY(2).EQ.0.) THEN
          IF(LKECHO)WRITE(JOSTND,10015) KEYWRD,IDT
10015     FORMAT(/A8,'   DATE/CYCLE=',I5,'; MANAGED = 0 (NO)')
        ELSE
          IF(LKECHO)WRITE(JOSTND,10020) KEYWRD,IDT
10020     FORMAT(/A8,'   DATE/CYCLE=',I5,'; MANAGED = 1 (YES)')
          ARRAY(2)=1.
        ENDIF
      ENDIF
      IF(IDT .LE. 0) MANAGD=IFIX(ARRAY(2))
      GO TO 10
C
C  ==========  OPTION NUMBER 103: YARDLOSS  =========================YARDLOSS
C
10100 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,203,KEYWRD,KARD,
     >                   IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
         GOTO 10
      ENDIF
C
C     PROPORTION OF HARVEST NOT REMOVED FROM STAND
C
      X = 0.
      IF (LNOTBK(2)) THEN
        X = AMAX1(0.,ARRAY(2))
        X = AMIN1(1.,X)
      ENDIF
      ARRAY(2) = X
C
C     PROPORTION OF NON-REMOVED HARVEST THAT IS DOWN
C
      X = 0.
      IF (LNOTBK(3)) THEN
        X = AMAX1(0.,ARRAY(3))
        X = AMIN1(1.,X)
      ENDIF
      ARRAY(3) = X
C
C     PROPORTION OF HARVESTED CROWNS LEFT IN STAND
C
      X = 1.
      IF (LNOTBK(4)) THEN
        X = AMAX1(0.,ARRAY(4))
        X = AMIN1(1.,X)
      ENDIF
      ARRAY(4) = X
C
      CALL OPNEW(KODE,IDT,203,3,ARRAY(2))
      IF (KODE .GT. 0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,10110) KEYWRD,IDT,ARRAY(2),ARRAY(3),
     &                              ARRAY(4)
10110 FORMAT (/A8,'   DATE/CYCLE=',I5,
     >  '; PROPORTION OF HARVESTED STEMS LEFT IN STAND = ',F6.4/T12,
     >  'PROPORTION OF NON-REMOVED HARVEST THAT IS DOWN = ',F6.4/T12,
     >  'PROPORTION OF CROWNS REMAINING IN STAND FROM ',
     >  'REMOVED STEMS = ',F6.4)
      GOTO 10
C
C  ==========  OPTION NUMBER 104: FMIN      =========================FMIN
C
10200 CONTINUE
      IF(LKECHO)WRITE(JOSTND,10210) KEYWRD
10210 FORMAT (/A8,'   FIRE MODEL KEYWORDS:')
      CALL FMIN (1,NSP,LKECHO)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN
      GOTO 10
C
C  ==========  OPTION NUMBER 105: STRCLASS  =========================STRCLASS
C
10300 CONTINUE
      CALL KSSTAG (JOSTND,KEYWRD,LNOTBK,ARRAY,LKECHO)
      GOTO 10
C
C  ==========  OPTION NUMBER 106: MODTYPE   =========================MODTYPE
C
10400 CONTINUE
C----------
C  VALUES ARE STORED AND THEN DIGESTED IN SITSET.
C  CENTRAL ROCKIES AND ORGANON VARIANTS, USE MODEL TYPE (FIELD 1).
C  FIELD 2 IS NOT USED.
C  ALL VARIANTS HAVE FOREST TYPE (FIELD 3) AVAILABLE, BUT MAY HAVE NO EFFECT.
C----------

      SELECT CASE (VARACD)

        CASE ('CR')
          IF(LNOTBK(1)) IMODTY=IFIX(ARRAY(1))
          IF(LKECHO)WRITE(JOSTND,10430) KEYWRD,IMODTY
10430     FORMAT(/A8,'   MODEL TYPE =',I5)
          IF(LKECHO)WRITE(JOSTND,10450)
10450     FORMAT(T12,'(SEE MODTYPE KEYWORD DISCUSSION FOLLOWING',
     &    ' --- PROCESS --- KEYWORD.)')

        CASE DEFAULT
          CONTINUE
      END SELECT

      IF(LNOTBK(3)) IFORTP=IFIX(ARRAY(3))
      IF(IFORTP .GT. 999) THEN
C----------
C  THE LAST 3 CHARACTERS INDICATE THE FOREST TYPE AND THE FIRST
C  CHARACTER INDICATES THAT THE USER SET THE FOREST TYPE TO BE
C  CONSTANT FOR ALL CYCLES.  THE FIELD 3 INPUT IS DECODED
C  AND LFLAGV IS SET TO TRUE TO INDICATE CONSTANT FOREST TYPE
C----------
        XTMP= FLOAT(IFORTP)
        XTMP= XTMP/1000. + 0.00001
        IXTMP= INT(XTMP)
        IFORTP= INT((XTMP-REAL(IXTMP))*1000.)
        LFLAGV= .TRUE.
      ENDIF
C----------
C  CALL FORTYP TO CHECK FOR VALID USER INPUT OF IFORTP VALUE
C----------
      DUM1=0.
      IXF=1
      CALL FORTYP(IXF,DUM1)

      IF(LKECHO)WRITE(JOSTND,10455) KEYWRD,IFORTP
10455 FORMAT(/A8,T12,'FOREST TYPE =',I5)

      GO TO 10
C
C  ==========  OPTION NUMBER 107: FVSSTAND  =========================FVSSTAND
C
10500 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
      NP=1
      IF(LNOTBK(2)) NP=2
      CALL OPNEW (KODE,IDT,204,NP,ARRAY(2))
      IF (KODE.GT.0) GOTO 10
      IF(NP.EQ.2 .AND. ARRAY(2).EQ.1) THEN
        IF(LKECHO)WRITE(JOSTND,10510) KEYWRD,IDT
10510   FORMAT (/A8,'   DATE/CYCLE=',I5,
     &'; CYCLE 0 FVSSTAND SUPPRESSED; CYCLE 1 FVSSTAND DONE')
      ELSEIF (NP.EQ.2 .AND. ARRAY(2).EQ.2) THEN
        IF(LKECHO)WRITE(JOSTND,10515) KEYWRD,IDT
10515   FORMAT (/A8,'   DATE/CYCLE=',I5,
     &'; CYCLE 0 FVSSTAND DONE; CYCLE 1 FVSSTAND SUPPRESSED')
      ELSE
        IF(LKECHO)WRITE(JOSTND,10520) KEYWRD,IDT
10520   FORMAT (/A8,'   DATE/CYCLE=',I5)
      ENDIF
C     NOTRIP = .TRUE.
C     IF(LKECHO)WRITE(JOSTND,10530)
C0530 FORMAT(11X,'** RECORD TRIPLING TURNED OFF **')
      GOTO 10
C
C  ==========  OPTION NUMBER 108: PRUNE   ===========================PRUNE
C
10600 CONTINUE
      IDT=1
      IF(LNOTBK(1))IDT=IFIX(ARRAY(1))
      IF(ARRAY(2) .LE. 0.) ARRAY(2)=2.
      IF(ARRAY(4) .LE. 0.) ARRAY(4)=0.5
      IF(ARRAY(4) .GT. 1.) ARRAY(4)=1.
      IF(ARRAY(7) .LE. 0.) ARRAY(7)=99.0
      IF(IPRMPT.GT.0) THEN
        IF(IPRMPT.NE.2) THEN
          CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
          CALL ERRGRO (.TRUE.,25)
        ELSE
          CALL OPNEWC (KODE,JOSTND,IREAD,IDT,249,KEYWRD,KARD,
     >               IPRMPT,IRECNT,ICYC)
          CALL fvsGetRtnCode(IRTNCD)
          IF (IRTNCD.NE.0) RETURN
        ENDIF
        GO TO 10
      ENDIF
C
C   SPECIES CODE PROCESSING.
C
        CALL SPDECD (5,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
        IF(IS.EQ.-999) GO TO 10
        CALL OPNEW (KODE,IDT,249,6,ARRAY(2))
        IF(KODE.GT.0) GO TO 10
        ILEN=3
        IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,10605)KEYWRD,IDT,(ARRAY(J),J=2,4),
     &  KARD(5)(1:ILEN),IS,(ARRAY(J),J=6,7)
10605   FORMAT(/A8,'   DATE/CYCLE=',I5,';  METHOD=',F5.0,
     &  ';  FEET=',F7.2,';  MAX CR REMOVAL PROPORTION=',F6.1,
     &  ';'/T12,'SPECIES=',A,' (CODE= ',I3,
     &  ');  LOWER DBH=',F6.1,';  UPPER DBH=',F6.1)
      GOTO 10
C
C  ==========  OPTION NUMBER 109: SVS   =============================SVS
C
10900 CONTINUE
      CALL SVKEY (KEYWRD,LNOTBK,ARRAY)
      GOTO 10
C
C  ==========  OPTION NUMBER 110:  FIXDG   ==========================FIXDG
C
11000 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,98,KEYWRD,KARD,
     >                   IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
      ELSE
C
C        SPECIES CODE PROCESSING.
C
         CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &                ARRAY,KARD)
         IF (IS.EQ.-999) GOTO 10
         IF(.NOT.LNOTBK(3))ARRAY(3)=1.
         IF(.NOT.LNOTBK(4))ARRAY(4)=0.
         IF(.NOT.LNOTBK(5))ARRAY(5)=999.
         ILEN=3
         IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
         IF(LKECHO)WRITE(JOSTND,11030) KEYWRD,IDT,KARD(2)(1:ILEN),
     >                       IS,ARRAY(3),ARRAY(4),ARRAY(5)
11030    FORMAT (/A8,'   DATE/CYCLE=',I5,'; SPECIES=',A,' (CODE=',
     >   I3,'); DIAMETER GROWTH MULTIPLIER=',F10.4/
     >   T12,'ONLY TREES GREATER THAN OR EQUAL TO ',F7.2,
     >   ' AND LESS THAN ',
     >   F7.2,' INCHES DBH ARE AFFECTED.')
         CALL OPNEW (KODE,IDT,98,4,ARRAY(2))
         IF (KODE.GT.0) GOTO 10
      ENDIF
      GOTO 10
C
C  ==========  OPTION NUMBER 111:  FIXHTG  ==========================FIXHTG
C
11100 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,99,KEYWRD,KARD,
     >                   IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
      ELSE
C
C        SPECIES CODE PROCESSING.
C
         CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &                ARRAY,KARD)
         IF (IS.EQ.-999) GOTO 10
         IF(.NOT.LNOTBK(3))ARRAY(3)=1.
         IF(.NOT.LNOTBK(4))ARRAY(4)=0.
         IF(.NOT.LNOTBK(5))ARRAY(5)=999.
         ILEN=3
         IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
         IF(LKECHO)WRITE(JOSTND,11130) KEYWRD,IDT,KARD(2)(1:ILEN),
     >                       IS,ARRAY(3),ARRAY(4),ARRAY(5)
11130    FORMAT (/A8,'   DATE/CYCLE=',I5,'; SPECIES=',A,' (CODE=',
     >   I3,'); HEIGHT GROWTH MULTIPLIER=',F10.4/
     >   T12,'ONLY TREES GREATER THAN OR EQUAL TO ',F7.2,
     >   ' AND LESS THAN ',
     >   F7.2,' INCHES DBH ARE AFFECTED.')
         CALL OPNEW (KODE,IDT,99,4,ARRAY(2))
         IF (KODE.GT.0) GOTO 10
      ENDIF
      GOTO 10
C
C  ==========  OPTION NUMBER 112: THINSDI  ==========================THINSDI
C
11200 CONTINUE
      ICFLAG=230
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.LE.0) GOTO 11210
      IF (IPRMPT.NE.2) THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,25)
      ELSE
         CALL OPNEWC (KODE,JOSTND,IREAD,IDT,ICFLAG,KEYWRD,KARD,IPRMPT,
     >                IRECNT,ICYC)
         CALL fvsGetRtnCode(IRTNCD)
         IF (IRTNCD.NE.0) RETURN
      ENDIF
      GOTO 10
11210 CONTINUE
      IF (LNOTBK(2)) THEN
         PRMS(1)=ARRAY(2)
      ELSE
C
C        REQUIRED RESIDUAL IS MISSING.
C
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
C
C   PROCESS REMAINING PARAMETER FIELDS
C
      PRMS(2)=EFF
      IF(LNOTBK(3)) PRMS(2)=ARRAY(3)
C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (4,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(IS.EQ.-999) GO TO 10
      PRMS(3)=IS
      PRMS(4)=0.0
      IF(LNOTBK(5)) PRMS(4)=ARRAY(5)
      PRMS(5)=999.0
      IF(LNOTBK(6)) PRMS(5)=ARRAY(6)
      IF(PRMS(5) .LE. PRMS(4))THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
      PRMS(6)=0.
      IF(LNOTBK(7)) PRMS(6)=ARRAY(7)
      IF(PRMS(6).EQ.0. .AND. PRMS(2).GT.0.)PRMS(2)=0.
      CALL OPNEW (KODE,IDT,ICFLAG,6,PRMS)
      IF (KODE.GT.0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,11220) KEYWRD,IDT,PRMS(1)
11220 FORMAT (/A8,'   DATE/CYCLE=',I5,'; RESIDUAL=',F8.2)
      IF(PRMS(2).EQ.0.)THEN
        ILEN=3
        IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,11221)KARD(4)(1:ILEN),IS,PRMS(4),PRMS(5)
11221   FORMAT(T12,
     >   'PROPORTION OF SELECTED TREES REMOVED WILL BE ',
     >   'COMPUTED BY THE MODEL'/,
     >   T12,'SPECIES=',A,' (CODE=',I3,');',
     >   ' DBH OF REMOVED TREES WILL RANGE FROM ',F5.1,' TO ',
     >   F5.1,' INCHES.')
      ELSE
        ILEN=3
        IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,11222)PRMS(2),KARD(4)(1:ILEN),
     &                               IS,PRMS(4),PRMS(5)
11222   FORMAT(T12,
     >   'PROPORTION OF SELECTED TREES REMOVED= ',F6.3,';',/,
     >   T12,'SPECIES=',A,' (CODE=',I3,');',
     >   ' DBH OF REMOVED TREES WILL RANGE FROM ',F5.1,' TO ',
     >   F5.1,' INCHES.')
      ENDIF
      IF(PRMS(6) .EQ. 0) THEN
        IF(LKECHO)WRITE(JOSTND,11223)
11223   FORMAT(T12,'CUTTING WILL BE DISTRIBUTED THROUGHOUT THE ',
     >                'SPECIFIED DIAMETER CLASS.')
      ELSEIF (PRMS(6) .EQ. 1) THEN
        IF(LKECHO)WRITE(JOSTND,11224)
11224   FORMAT(T12,'CUTTING WILL BE FROM BELOW IN THE SPECIFIED ',
     >                'DIAMETER CLASS.')
      ELSE
        IF(LKECHO)WRITE(JOSTND,11225)
11225   FORMAT(T12,'CUTTING WILL BE FROM ABOVE IN THE SPECIFIED ',
     >                'DIAMETER CLASS.')
      ENDIF
      GOTO 10
C
C  ==========  OPTION NUMBER 113: LOCATE  ============================LOCATE
C
11300 CONTINUE
      IF(LNOTBK(1)) TLAT=ARRAY(1)
      IF(LNOTBK(2)) TLONG=ARRAY(2)
      IF(LNOTBK(3)) ISTATE=IFIX(ARRAY(3))
      IF(LNOTBK(4)) ICNTY=IFIX(ARRAY(4))
      IF(LKECHO)WRITE(JOSTND,11310) KEYWRD,TLAT,TLONG,ISTATE,ICNTY
11310 FORMAT (/A8,'   LATITUDE =',F9.4,';  LONGITUDE = ',F9.4,
     >';  STATE CODE = ',I2,';  COUNTY CODE = ',I3)
      GOTO 10
C
C  ==========  OPTION NUMBER 114: available =======================available
C
11400 CONTINUE
C
C     PROCESS OPTION 114 CODE HERE.
C     BGCIN KEYWORD WAS HERE AND INITIATED CALL TO SUBROUTINE BGCIN.
C     BGC EXTENSION HAS BEEN RETIRED.
C
      GOTO 10
C
C  ==========  OPTION NUMBER 115: THINCC  ===========================THINCC
C
11500 CONTINUE
      ICFLAG=231
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.LE.0) GOTO 11510
      IF (IPRMPT.NE.2) THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,25)
      ELSE
         CALL OPNEWC (KODE,JOSTND,IREAD,IDT,ICFLAG,KEYWRD,KARD,IPRMPT,
     >                IRECNT,ICYC)
         CALL fvsGetRtnCode(IRTNCD)
         IF (IRTNCD.NE.0) RETURN
      ENDIF
      GOTO 10
11510 CONTINUE
      IF (LNOTBK(2)) THEN
         PRMS(1)=ARRAY(2)
      ELSE
C
C        REQUIRED RESIDUAL IS MISSING.
C
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
C
C   PROCESS REMAINING PARAMETER FIELDS
C
      PRMS(2)=EFF
      IF(LNOTBK(3)) PRMS(2)=ARRAY(3)
C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (4,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(IS.EQ.-999) GO TO 10
      PRMS(3)=IS
      PRMS(4)=0.0
      IF(LNOTBK(5)) PRMS(4)=ARRAY(5)
      PRMS(5)=999.0
      IF(LNOTBK(6)) PRMS(5)=ARRAY(6)
      IF(PRMS(5) .LE. PRMS(4))THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
      PRMS(6)=0.
      IF(LNOTBK(7)) PRMS(6)=ARRAY(7)
      IF(PRMS(6).EQ.0. .AND. PRMS(2).GT.0.)PRMS(2)=0.
      CALL OPNEW (KODE,IDT,ICFLAG,6,PRMS)
      IF (KODE.GT.0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,11520) KEYWRD,IDT,PRMS(1)
11520 FORMAT (/A8,'   DATE/CYCLE=',I5,'; RESIDUAL=',F8.2)
      IF(PRMS(2).EQ.0.)THEN
        ILEN=3
        IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,11521)KARD(4)(1:ILEN),IS,PRMS(4),PRMS(5)
11521   FORMAT(T12,
     >   'PROPORTION OF SELECTED TREES REMOVED WILL BE ',
     >   'COMPUTED BY THE MODEL'/,
     >   T12,'SPECIES=',A,' (CODE=',I3,');',
     >   ' DBH OF REMOVED TREES WILL RANGE FROM ',F5.1,' TO ',
     >   F5.1,' INCHES.')
      ELSE
        ILEN=3
        IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,11522)PRMS(2),KARD(4)(1:ILEN),
     &                               IS,PRMS(4),PRMS(5)
11522   FORMAT(T12,
     >   'PROPORTION OF SELECTED TREES REMOVED= ',F6.3,';',/,
     >   T12,'SPECIES=',A,' (CODE=',I3,');',
     >   ' DBH OF REMOVED TREES WILL RANGE FROM ',F5.1,' TO ',
     >   F5.1,' INCHES.')
      ENDIF
      IF(PRMS(6) .EQ. 0) THEN
        IF(LKECHO)WRITE(JOSTND,11523)
11523   FORMAT(T12,'CUTTING WILL BE DISTRIBUTED THROUGHOUT THE ',
     >                'SPECIFIED DIAMETER CLASS.')
      ELSEIF (PRMS(6) .EQ. 1) THEN
        IF(LKECHO)WRITE(JOSTND,11524)
11524   FORMAT(T12,'CUTTING WILL BE FROM BELOW IN THE SPECIFIED ',
     >                'DIAMETER CLASS.')
      ELSE
        IF(LKECHO)WRITE(JOSTND,11525)
11525   FORMAT(T12,'CUTTING WILL BE FROM ABOVE IN THE SPECIFIED ',
     >                'DIAMETER CLASS.')
      ENDIF
      GOTO 10
C
C  ==========  OPTION NUMBER 116: ECON    ============================ECON
C
11600 CONTINUE
      IF(LKECHO)WRITE(JOSTND,11610) KEYWRD
11610 FORMAT (/A8,'   ECONOMIC EXTENSION KEYWORDS:')
      CALL ECIN(IRECNT,IREAD,JOSTND,NSP,ICYC,LKECHO,ISPGRP)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN
      GOTO 10
C
C  ==========  OPTION NUMBER 117: DATABASE ============================DATABASE
C
11700 CONTINUE
      IF(LKECHO)WRITE(JOSTND,11710) KEYWRD
11710 FORMAT (/A8,'   DATABASE KEYWORDS:')
      CALL DBSIN (KEYWRD,ARRAY,ISDSP,SDLO,SDHI,LNOTBK,LKECHO)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN
      GOTO 10
C
C  ==========  OPTION NUMBER 118: available  =========================available
C
11800 CONTINUE

C
C     PROCESS OPTION 118 CODE HERE. PREVIOUS OPTION WAS AN ACTIVITY AND USED
C     ACTIVITY CODE 100.
C

      GOTO 10
C
C  ==========  OPTION NUMBER 119: DEFECT  =========================DEFECT
C
11900 CONTINUE
C
C     READ COEFFICIENTS FROM A SUPPLEMENTAL RECORD.
C
      READ(IREAD,1905,END=80) (WK6(I),I=1,8)
      IRECNT=IRECNT+1
C----------
C     DETERMINE THE TYPE OF DEFALUT FACTOR SPECIFIED: 0 OR BLANK FOR
C     BOTH TYPES, 1 FOR WEST CUBIC OR EAST PULPWOOD, 2 FOR WEST BOARDS
C     OR EAST SAWTIMBER.
C----------
      IDTYPE=0
      IF(LNOTBK(1) .AND. ARRAY(1).EQ.1.) THEN
        IDTYPE=1
        LCVOLS=.TRUE.
      ELSEIF(LNOTBK(1) .AND. ARRAY(1).EQ.2.)THEN
        IDTYPE=2
        LBVOLS=.TRUE.
      ELSEIF(LNOTBK(1) .AND. (ARRAY(1).GT.2. .OR. ARRAY(1).LT.0.))THEN
        CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
        CALL ERRGRO (.TRUE.,25)
        GO TO 10
      ELSE
        LCVOLS=.TRUE.
        LBVOLS=.TRUE.
      ENDIF
      IF(LNOTBK(3) .AND. ARRAY(3).GT.0.)IGNDEF=1
C----------
C     SPECIES CODE PROCESSING.
C----------
      CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF (IS.EQ.-999) GO TO 10
C----------
C     IF (IS<0) CHANGE ALL SPECIES IN THE GROUP
C----------
      IF(IS .LT. 0) THEN
        IGRP = -IS
        IULIM = ISPGRP(IGRP,1)+1
        DO 11901 IG=2,IULIM
        IGSP = ISPGRP(IGRP,IG)
        IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.1)THEN
          CFDEFT(2,IGSP)=WK6(1)
          CFDEFT(3,IGSP)=WK6(2)
          CFDEFT(4,IGSP)=WK6(3)
          CFDEFT(5,IGSP)=WK6(4)
          CFDEFT(6,IGSP)=WK6(5)
          CFDEFT(7,IGSP)=WK6(6)
          CFDEFT(8,IGSP)=WK6(7)
          CFDEFT(9,IGSP)=WK6(8)
        ENDIF
        IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.2)THEN
          BFDEFT(2,IGSP)=WK6(1)
          BFDEFT(3,IGSP)=WK6(2)
          BFDEFT(4,IGSP)=WK6(3)
          BFDEFT(5,IGSP)=WK6(4)
          BFDEFT(6,IGSP)=WK6(5)
          BFDEFT(7,IGSP)=WK6(6)
          BFDEFT(8,IGSP)=WK6(7)
          BFDEFT(9,IGSP)=WK6(8)
        ENDIF
11901   CONTINUE
        ILEN=ISPGRP(-IS,92)
C
        SELECT CASE (VARACD)
C
          CASE ('CS','LS','NE','SN')
            IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.1)THEN
              IF(LKECHO)WRITE(JOSTND,11932) KEYWRD,KARD(2)(1:ILEN),
     &                                    IS,(WK6(I),I=1,8)
            ENDIF
            IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.2)THEN
              IF(LKECHO)WRITE(JOSTND,11933) KEYWRD,KARD(2)(1:ILEN),
     &                                    IS,(WK6(I),I=1,8)
            ENDIF
C
          CASE DEFAULT
            IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.1)THEN
              IF(LKECHO)WRITE(JOSTND,11934) KEYWRD,KARD(2)(1:ILEN),
     &                                    IS,(WK6(I),I=1,8)
            ENDIF
            IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.2)THEN
              IF(LKECHO)WRITE(JOSTND,11935) KEYWRD,KARD(2)(1:ILEN),
     &                                    IS,(WK6(I),I=1,8)
            ENDIF
C
        END SELECT
C----------
C     IF (IS=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C----------
      ELSEIF(IS .EQ. 0)THEN
        DO 11910 IS=1,MAXSP
        IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.1)THEN
          CFDEFT(2,IS)=WK6(1)
          CFDEFT(3,IS)=WK6(2)
          CFDEFT(4,IS)=WK6(3)
          CFDEFT(5,IS)=WK6(4)
          CFDEFT(6,IS)=WK6(5)
          CFDEFT(7,IS)=WK6(6)
          CFDEFT(8,IS)=WK6(7)
          CFDEFT(9,IS)=WK6(8)
        ENDIF
        IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.2)THEN
          BFDEFT(2,IS)=WK6(1)
          BFDEFT(3,IS)=WK6(2)
          BFDEFT(4,IS)=WK6(3)
          BFDEFT(5,IS)=WK6(4)
          BFDEFT(6,IS)=WK6(5)
          BFDEFT(7,IS)=WK6(6)
          BFDEFT(8,IS)=WK6(7)
          BFDEFT(9,IS)=WK6(8)
        ENDIF
11910   CONTINUE
C
        SELECT CASE (VARACD)
C
          CASE ('CS','LS','NE','SN')
            IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.1)THEN
              IF(LKECHO)WRITE(JOSTND,11912) KEYWRD,(WK6(I),I=1,8)
11912         FORMAT(/A8,T12,'PULPWOOD VOLUME DEFECT',
     >        ' PROPORTIONS HAVE BEEN CHANGED FOR ALL SPECIES:',
     >        /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     >        '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     >        '; 25 INCH TREES=',F6.2,'; 30 INCH TREES=',F6.2,/T12,
     >        '35 INCH TREES=',F6.2,'; 40 INCH AND LARGER TREES=',F6.2)
              IF(LKECHO .AND. IGNDEF.GT.0)WRITE(JOSTND,11909)
11909         FORMAT(/T12,'DEFECT PERCENTAGES READ AS PART OF THE TRE',
     >        'E RECORD INPUT FOR ALL SPECIES WILL BE IGNORED.')
            ENDIF
            IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.2)THEN
              IF(LKECHO)WRITE(JOSTND,11913) KEYWRD,(WK6(I),I=1,8)
11913         FORMAT(/A8,T12,'SAWLOG VOLUME DEFECT',
     &        ' PROPORTIONS HAVE BEEN CHANGED FOR ALL SPECIES:',
     &        /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     &        '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     >        '; 25 INCH TREES=',F6.2,'; 30 INCH TREES=',F6.2,/T12,
     >        '35 INCH TREES=',F6.2,'; 40 INCH AND LARGER TREES=',F6.2)
              IF(LKECHO .AND. IGNDEF.GT.0)WRITE(JOSTND,11909)
            ENDIF
C
          CASE DEFAULT
            IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.1)THEN
              IF(LKECHO)WRITE(JOSTND,11920) KEYWRD,(WK6(I),I=1,8)
11920         FORMAT(/A8,T12,'CUBIC FOOT VOLUME DEFECT',
     >        ' PROPORTIONS HAVE BEEN CHANGED FOR ALL SPECIES:',
     >        /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     >        '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     >        '; 25 INCH TREES=',F6.2,'; 30 INCH TREES=',F6.2,/T12,
     >        '35 INCH TREES=',F6.2,'; 40 INCH AND LARGER TREES=',F6.2)
              IF(LKECHO .AND. IGNDEF.GT.0)WRITE(JOSTND,11909)
            ENDIF
            IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.2)THEN
              IF(LKECHO)WRITE(JOSTND,11921) KEYWRD,(WK6(I),I=1,8)
11921         FORMAT(/A8,T12,'BOARD FOOT VOLUME DEFECT',
     &        ' PROPORTIONS HAVE BEEN CHANGED FOR ALL SPECIES:',
     &        /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     &        '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     >        '; 25 INCH TREES=',F6.2,'; 30 INCH TREES=',F6.2,/T12,
     >        '35 INCH TREES=',F6.2,'; 40 INCH AND LARGER TREES=',F6.2)
              IF(LKECHO .AND. IGNDEF.GT.0)WRITE(JOSTND,11909)
            ENDIF
C
        END SELECT
C----------
C     SPECIES CODE IS SPECIFIED (IS > 0).
C----------
      ELSE
        IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.1)THEN
          CFDEFT(2,IS)=WK6(1)
          CFDEFT(3,IS)=WK6(2)
          CFDEFT(4,IS)=WK6(3)
          CFDEFT(5,IS)=WK6(4)
          CFDEFT(6,IS)=WK6(5)
          CFDEFT(7,IS)=WK6(6)
          CFDEFT(8,IS)=WK6(7)
          CFDEFT(9,IS)=WK6(8)
        ENDIF
        IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.2)THEN
          BFDEFT(2,IS)=WK6(1)
          BFDEFT(3,IS)=WK6(2)
          BFDEFT(4,IS)=WK6(3)
          BFDEFT(5,IS)=WK6(4)
          BFDEFT(6,IS)=WK6(5)
          BFDEFT(7,IS)=WK6(6)
          BFDEFT(8,IS)=WK6(7)
          BFDEFT(9,IS)=WK6(8)
        ENDIF
        ILEN=3
C
        SELECT CASE (VARACD)
C
          CASE ('CS','LS','NE','SN')
            IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.1)THEN
              IF(LKECHO)WRITE(JOSTND,11932) KEYWRD,KARD(2)(1:ILEN),
     &                                    IS,(WK6(I),I=1,8)
11932         FORMAT(/A8,T12,'PULPWOOD VOLUME DEFECT PROPORTIONS ',
     >        'HAVE BEEN CHANGED FOR SPECIES:',A,' (CODE=',I3,')',
     >        /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     >        '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     >        '; 25 INCH TREES=',F6.2,'; 30 INCH TREES=',F6.2,/T12,
     >        '35 INCH TREES=',F6.2,'; 40 INCH AND LARGER TREES=',F6.2)
              IF(LKECHO .AND. IGNDEF.GT.0)WRITE(JOSTND,11909)
            ENDIF
            IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.2)THEN
              IF(LKECHO)WRITE(JOSTND,11933) KEYWRD,KARD(2)(1:ILEN),
     &                                    IS,(WK6(I),I=1,8)
11933         FORMAT(/A8,T12,'SAWLOG VOLUME DEFECT PROPORTIONS HAVE ',
     &        'BEEN CHANGED FOR SPECIES:',A,' (CODE=',I3,')',
     &        /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     &        '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     >        '; 25 INCH TREES=',F6.2,'; 30 INCH TREES=',F6.2,/T12,
     >        '35 INCH TREES=',F6.2,'; 40 INCH AND LARGER TREES=',F6.2)
              IF(LKECHO .AND. IGNDEF.GT.0)WRITE(JOSTND,11909)
            ENDIF
C
          CASE DEFAULT
            IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.1)THEN
              IF(LKECHO)WRITE(JOSTND,11934) KEYWRD,KARD(2)(1:ILEN),
     &                                    IS,(WK6(I),I=1,8)
11934         FORMAT(/A8,T12,'CUBIC FOOT VOLUME DEFECT PROPORTIONS ',
     >        'HAVE BEEN CHANGED FOR SPECIES:',A,' (CODE=',I3,')',
     >        /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     >        '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     >        '; 25 INCH TREES=',F6.2,'; 30 INCH TREES=',F6.2,/T12,
     >        '35 INCH TREES=',F6.2,'; 40 INCH AND LARGER TREES=',F6.2)
              IF(LKECHO .AND. IGNDEF.GT.0)WRITE(JOSTND,11909)
            ENDIF
            IF(IDTYPE.EQ.0 .OR. IDTYPE.EQ.2)THEN
              IF(LKECHO)WRITE(JOSTND,11935) KEYWRD,KARD(2)(1:ILEN),
     &                                    IS,(WK6(I),I=1,8)
11935         FORMAT(/A8,T12,'BOARD FOOT VOLUME DEFECT PROPORTIONS ',
     &        'HAVE BEEN CHANGED FOR SPECIES:',A,' (CODE=',I3,')',
     &        /T12,' 5 INCH TREES=',F6.2,'; 10 INCH TREES=',F6.2,
     &        '; 15 INCH TREES=',F6.2,/T12,'20 INCH TREES=',F6.2,
     >        '; 25 INCH TREES=',F6.2,'; 30 INCH TREES=',F6.2,/T12,
     >        '35 INCH TREES=',F6.2,'; 40 INCH AND LARGER TREES=',F6.2)
              IF(LKECHO .AND. IGNDEF.GT.0)WRITE(JOSTND,11909)
            ENDIF
C
        END SELECT
      ENDIF
      GO TO 10
C
C  ==========  OPTION NUMBER 120: available ==========================available
C
12000 CONTINUE
C
C     PROCESS OPTION 120 CODE HERE. PREVIOUS OPTION WAS AN ACTIVITY AND USED
C     ACTIVITY CODE 205.
C     CRUZFILE KEYWORD HAD BEEN HERE BUT WAS DEFUNCT AND REMOVED 7/23/2021
C

      GOTO 10
C
C  ==========  OPTION NUMBER 121: STANDCN  ================================ STANDCN
C
12100 CONTINUE
      READ (IREAD,'(A)',END=80) DBCN
      IRECNT = IRECNT + 1
      DBCN=TRIM(ADJUSTL(DBCN))
      IF(LKECHO)WRITE(JOSTND,12110) KEYWRD,TRIM(DBCN)
12110 FORMAT(/A8,'   DATA BASE CONTROL NUMBER=',A)
      GOTO 10
C
C  ==========  OPTION NUMBER 122: THINMIST  =========================THINMIST
C
12200 CONTINUE
      ICFLAG=233
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.LE.0) GOTO 12210
      IF (IPRMPT.NE.2) THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,25)
      ELSE
         CALL OPNEWC (KODE,JOSTND,IREAD,IDT,ICFLAG,KEYWRD,KARD,IPRMPT,
     >                IRECNT,ICYC)
         CALL fvsGetRtnCode(IRTNCD)
         IF (IRTNCD.NE.0) RETURN
      ENDIF
      GOTO 10
C
12210 CONTINUE
      PRMS(1)=0.
      IF (LNOTBK(2)) PRMS(1)=ARRAY(2)
      IF(PRMS(1).LT.0.0 .OR. PRMS(1).GT.6.0)PRMS(1)=0.
C
C   PROCESS REMAINING PARAMETER FIELDS
C
      PRMS(2)=0.0
      IF(LNOTBK(3)) PRMS(2)=ARRAY(3)
      IF(PRMS(2).LT.0.0)PRMS(2)=0.0
C
      PRMS(3)=999.0
      IF(LNOTBK(4)) PRMS(3)=ARRAY(4)

      IF(PRMS(3) .LE. PRMS(2))THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
C
      PRMS(4)=EFF
      IF(LNOTBK(5)) PRMS(4)=ARRAY(5)
C
      CALL OPNEW (KODE,IDT,ICFLAG,4,PRMS)
      IF (KODE.GT.0) GOTO 10
      IF(PRMS(1).EQ.0.0)THEN
        IF(LKECHO)WRITE(JOSTND,12215) KEYWRD,IDT
12215   FORMAT (/A8,'   DATE/CYCLE=',I5,'; TREES WITH A DMR OF 1-6',
     &          ' WILL BE REMOVED.')
      ELSE
        IF(LKECHO)WRITE(JOSTND,12220) KEYWRD,IDT,PRMS(1)
12220   FORMAT (/A8,'   DATE/CYCLE=',I5,'; TREES WITH A DMR OF',F5.0,
     &          ' WILL BE REMOVED.')
      ENDIF
      IF(LKECHO)WRITE(JOSTND,12225)PRMS(2),PRMS(3),PRMS(4)
12225 FORMAT(T12,
     >   'DBH OF REMOVED TREES WILL RANGE FROM ',F5.1,' TO ',
     >   F5.1,' INCHES.',
     >   ' PROPORTION OF SELECTED TREES REMOVED= ',F6.3)
      GOTO 10
C
C  ==========  OPTION NUMBER 123  TREESZCP  =========================TREESZCP
C
12300 CONTINUE
C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (1,ISPC,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(ISPC.EQ.-999) GO TO 10
      LMORT=.TRUE.
      CAPDBH=999.
      IF(LNOTBK(2))CAPDBH=ARRAY(2)
      CAPPRP=1.0
      IF(LNOTBK(3))CAPPRP=ARRAY(3)
      CAPFLG=0.
      IF(LNOTBK(4))CAPFLG=ARRAY(4)
      IDFLG=IFIX(CAPFLG)
      CAPHT=999.
      IF(LNOTBK(5))CAPHT=ARRAY(5)
      IF(CAPPRP.LT.0. .OR. CAPPRP.GT.1.0 .OR. CAPDBH.LT.0. .OR.
     &   CAPHT.LT.0. .OR. CAPFLG.LT.0. .OR. CAPFLG.GT.2.) THEN
        CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
        CALL ERRGRO (.TRUE.,4)
        GO TO 10
      ENDIF
C----------
C     IF (ISPC<0) CHANGE ALL SPECIES IN THE GROUP
C----------
      IF(ISPC .LT. 0) THEN
        IGRP = -ISPC
        IULIM = ISPGRP(IGRP,1)+1
        DO 12301 IG=2,IULIM
        IGSP = ISPGRP(IGRP,IG)
        SIZCAP(IGSP,1)=CAPDBH
        SIZCAP(IGSP,2)=CAPPRP
        SIZCAP(IGSP,3)=CAPFLG
        SIZCAP(IGSP,4)=CAPHT
12301   CONTINUE
        ILEN=ISPGRP(-ISPC,92)
        IF(LKECHO)WRITE(JOSTND,12320) KEYWRD,KARD(1)(1:ILEN),
     &    ISPC,CAPDBH,CAPPRP,IDFLG,CAPHT
C----------
C     IF (ISPC=0) ALL SPECIES WILL BE CHANGED IN FOLLOWING CODE:
C----------
      ELSEIF(ISPC .EQ. 0)THEN
        DO 12310 I=1,MAXSP
        SIZCAP(I,1)=CAPDBH
        SIZCAP(I,2)=CAPPRP
        SIZCAP(I,3)=CAPFLG
        SIZCAP(I,4)=CAPHT
12310   CONTINUE
        IF(LKECHO)WRITE(JOSTND,12315) KEYWRD,CAPDBH,CAPPRP,IDFLG,CAPHT
12315   FORMAT(/A8,'   SPECIES= ALL (CODE=  0',
     >  ');  DBH=',F6.1,';  MORTALITY PROPORTION=',F7.4,
     >  ';  DBH USE CODE=',I2,';  HT=',F6.1)
C----------
C     SPECIES CODE IS SPECIFIED (ISPC > 0).
C----------
      ELSE
        SIZCAP(ISPC,1)=CAPDBH
        SIZCAP(ISPC,2)=CAPPRP
        SIZCAP(ISPC,3)=CAPFLG
        SIZCAP(ISPC,4)=CAPHT
        ILEN=3
        IF(LKECHO)WRITE(JOSTND,12320) KEYWRD,KARD(1)(1:ILEN),
     &  ISPC,CAPDBH,CAPPRP,IDFLG,CAPHT
12320   FORMAT(/A8,'   SPECIES= ',A,' (CODE= ',I3,
     >  ');  DBH=',F6.1,';  MORTALITY PROPORTION=',F7.4,
     >  ';  DBH USE CODE=',I2,';  HT=',F6.1)
      ENDIF
      GO TO 10
C
C  ==========  OPTION NUMBER 124: THINRDEN ==========================THINRDEN
C
12400 CONTINUE
      ICFLAG=234
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.LE.0) GOTO 12410
      IF (IPRMPT.NE.2) THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,25)
      ELSE
         CALL OPNEWC (KODE,JOSTND,IREAD,IDT,ICFLAG,KEYWRD,KARD,IPRMPT,
     >                IRECNT,ICYC)
         CALL fvsGetRtnCode(IRTNCD)
         IF (IRTNCD.NE.0) RETURN
      ENDIF
      GOTO 10
12410 CONTINUE
      IF (LNOTBK(2)) THEN
         PRMS(1)=ARRAY(2)
      ELSE
C
C        REQUIRED RESIDUAL IS MISSING.
C
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
C
C   PROCESS REMAINING PARAMETER FIELDS
C
      PRMS(2)=EFF
      IF(LNOTBK(3)) PRMS(2)=ARRAY(3)
C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (4,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(IS.EQ.-999) GO TO 10
      PRMS(3)=IS
      PRMS(4)=0.0
      IF(LNOTBK(5)) PRMS(4)=ARRAY(5)
      PRMS(5)=999.0
      IF(LNOTBK(6)) PRMS(5)=ARRAY(6)
      IF(PRMS(5) .LE. PRMS(4))THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
      PRMS(6)=0.
      IF(LNOTBK(7)) PRMS(6)=ARRAY(7)
      IF(PRMS(6).EQ.0. .AND. PRMS(2).GT.0.)PRMS(2)=0.
      CALL OPNEW (KODE,IDT,ICFLAG,6,PRMS)
      IF (KODE.GT.0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,12420) KEYWRD,IDT,PRMS(1)
12420 FORMAT (/A8,'   DATE/CYCLE=',I5,'; RESIDUAL=',F8.2)
      IF(PRMS(2).EQ.0.)THEN
        ILEN=3
        IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,12421)KARD(4)(1:ILEN),IS,PRMS(4),PRMS(5)
12421   FORMAT(T12,
     >   'PROPORTION OF SELECTED TREES REMOVED WILL BE ',
     >   'COMPUTED BY THE MODEL'/,
     >   T12,'SPECIES=',A,' (CODE=',I3,');',
     >   ' DBH OF REMOVED TREES WILL RANGE FROM ',F5.1,' TO ',
     >   F5.1,' INCHES.')
      ELSE
        ILEN=3
        IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,12422)PRMS(2),KARD(4)(1:ILEN),IS,
     &                               PRMS(4),PRMS(5)
12422   FORMAT(T12,
     >   'PROPORTION OF SELECTED TREES REMOVED= ',F6.3,';',/,
     >   T12,'SPECIES=',A,' (CODE=',I3,');',
     >   ' DBH OF REMOVED TREES WILL RANGE FROM ',F5.1,' TO ',
     >   F5.1,' INCHES.')
      ENDIF
      IF(PRMS(6) .EQ. 0) THEN
        IF(LKECHO)WRITE(JOSTND,12423)
12423   FORMAT(T12,'CUTTING WILL BE DISTRIBUTED THROUGHOUT THE ',
     >                'SPECIFIED DIAMETER CLASS.')
      ELSEIF (PRMS(6) .EQ. 1) THEN
        IF(LKECHO)WRITE(JOSTND,12424)
12424   FORMAT(T12,'CUTTING WILL BE FROM BELOW IN THE SPECIFIED ',
     >                'DIAMETER CLASS.')
      ELSE
        IF(LKECHO)WRITE(JOSTND,12425)
12425   FORMAT(T12,'CUTTING WILL BE FROM ABOVE IN THE SPECIFIED ',
     >                'DIAMETER CLASS.')
      ENDIF
      GOTO 10
C
C  ==========  OPTION NUMBER 125: SPGROUP  ==========================SPGROUP
C
12500 CONTINUE
C
C     FIRST CHECK TO SEE THAT THE MAXIMUM NUMBER OF SPECIES GROUPS HAS NOT
C     ALREADY BEEN DEFINED.  IF SO, IGNORE THIS REQUEST.
C
      IF(NSPGRP .GE. 30)THEN
        IF(LKECHO)WRITE(JOSTND,12502) IRECNT,KEYWRD,KARD(1)
12502   FORMAT (/,'CARD NUM =',I5,'; KEYWORD FIELD = ',A8,
     &  '   GROUP NAME: ',A10)
        CALL ERRGRO(.TRUE.,28)
12503   CONTINUE
        IRECNT=IRECNT+1
        READ(IREAD,'(A)',END=80) RECORD
        I=LEN_TRIM(RECORD)
        IF(LKECHO)WRITE(JOSTND,'(" SKIPPED RECORD=",A)') RECORD(:I)
        IF (RECORD(I:I).EQ.'&') GOTO 12503
        GO TO 10
      ENDIF
C
C     PROCESS THE SPECIES GROUP REQUEST. DELETE LEADING BLANKS
C     FROM THE SPECIES GROUP NAME AND STORE THE LENGTH OF THE
C     NAME
C
      NSPGRP=NSPGRP+1
      IF(LNOTBK(1))THEN            ! if there is a name, then use it
        NAMGRP(NSPGRP)=ADJUSTL(KARD(1))
        ILEN=LEN_TRIM(NAMGRP(NSPGRP))
        DO J=1,ILEN
          CALL UPCASE(NAMGRP(NSPGRP)(J:J))
        ENDDO
      ELSE                         ! otherwise build one
        WRITE(NAMGRP(NSPGRP),'("GROUP",I2.2,2X)') NSPGRP
        ILEN=7
      ENDIF
      ISPGRP(NSPGRP,92)=ILEN       ! save the group name length
      INUM=0                       ! initialize the number of codes in the group
      KARD=' '                     ! blank out and zero out kard and arrays
      ARRAY=0
12504 CONTINUE
      IRECNT=IRECNT+1
      READ(IREAD,'(A)',END=80) RECORD
      ILEN=LEN_TRIM(RECORD)
      J=0                          ! j points to the first char for the new token...
                                   ! when j is zero, no new token is being built.
      DO I=1,ILEN                  ! loop over the chars in the record
        IF (RECORD(I:I).EQ.' ') THEN ! hit a blank
          IF (J.EQ.0) CYCLE          ! if no token being built, go on to next char
        ENDIF
        IF (RECORD(I:I).EQ.'&') GOTO 12504  ! read another record
        IF (J.EQ.0) J=I
        CALL UPCASE(RECORD(I:I))
        IF (RECORD(I:I).EQ.' '.OR.I.EQ.ILEN) THEN ! end of token (a blank or end of record)
          INUM=INUM+1              ! so, we have a token.
C
C  DON'T SAVE OVER 90, COULD DO AN ERROR MSG, BUT DIDN'T
C
          IF (INUM.GT.90) INUM=90
          IF (I.EQ.ILEN) THEN      ! store the token in kard(1)
            KARD(1)=RECORD(J:I)
          ELSE
            KARD(1)=RECORD(J:I-1)
          ENDIF
          J=0
          ARRAY(1)=0.
          READ(KARD(1),'(F10.0)',ERR=12505) ARRAY(1)  ! make a number, if we can.
12505     CONTINUE
          IF (KARD(1).EQ.'ALL') THEN  ! ALL is illegal
            INUM=INUM-1
            CYCLE
          ENDIF

          CALL SPDECD(1,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &         ARRAY,KARD)
          IF (ARRAY(1).EQ.0) THEN  ! zero is illegal
            INUM=INUM-1
            CYCLE
          ENDIF
          IF(IS.EQ.-999)THEN      ! species decode failed, don't keep the species
            INUM=INUM-1
            CYCLE
          ENDIF
          IF (INUM.GT.1) THEN     ! check for duplicates, save unique codes
            DO J=2,INUM
              IF (ISPGRP(NSPGRP,J).EQ.IS) THEN
                IS=-999           ! if it is a dup, then set flag
                EXIT
              ENDIF
            ENDDO
            J=0
            IF (IS.EQ.-999) THEN  ! skip dups
              INUM=INUM-1
              CYCLE
            ENDIF
          ENDIF
          ISPGRP(NSPGRP,INUM+1)=IS
        ENDIF
      ENDDO
      ISPGRP(NSPGRP,1)=INUM
      IF(LKECHO)WRITE(JOSTND,12535) KEYWRD,-NSPGRP,NAMGRP(NSPGRP),INUM
12535 FORMAT(/A8,'   GROUP NUMBER:',I4,'  GROUP NAME: ',A10,
     &'  NUMBER OF SPECIES IN THIS GROUP:',I3,'  SPECIES:')
      IF(LKECHO)WRITE(JOSTND,12540) (ISPGRP(NSPGRP,J),
     &      NSP(ISPGRP(NSPGRP,J),1),J=2,INUM+1)
12540 FORMAT((T12,9(I3,' =',A2,:,'; '),I3,' =',A2))
      GO TO 10
C
C  ==========  OPTION NUMBER 126: BMIN  ============================BMIN
C
12600 CONTINUE
      IF(LKECHO)WRITE(JOSTND,12610) KEYWRD
12610 FORMAT (/A8,'   INDIVIDUAL STAND WWPB MODEL OPTIONS:')
      CALL BMIN(LKECHO)
      GOTO 10
C
C  ==========  OPTION NUMBER 127: DATASCRN ========================DATASCRN
C
12700 CONTINUE
      IF (LNOTBK(1)) SDLO=ARRAY(1)
      IF (LNOTBK(2)) SDHI=ARRAY(2)
C
C     SPECIES CODE PROCESSING.
C
      CALL SPDECD (3,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF (IS.EQ.-999) GOTO 10
C
      ISDSP=IS
      IF(LKECHO)THEN
        WRITE(JOSTND,12708)KEYWRD
12708   FORMAT(/A8)
        IF(IS.NE.0) THEN
          ILEN=3
          IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
          IF(LKECHO)WRITE(JOSTND,12709) 'SPECIES= ',KARD(3)(1:ILEN),
     >                               IS,'IS'
12709     FORMAT (T12,A,A,' (CODE= ',I3,') ',A,
     >           ' TARGETED FOR SCREENING.')
        ELSE
         IF(LKECHO)WRITE(JOSTND,1411) 'ALL',' SPECIES',IS,'ARE'
        ENDIF
        WRITE(JOSTND,12710) SDLO,SDHI
12710   FORMAT(T12,'ONLY RECORDS WITH DIAMETERS GE',F6.1,
     &     ' INCHES OR LT',F6.1,' INCHES WILL BE READ FROM THE DATA.',/,
     &     T12,'ALL OTHER INPUT RECORDS WILL BE SCREENED OUT.')
      ENDIF
      GO TO 10
C
C  ==========  OPTION NUMBER 128: SETPTHIN ========================SETPTHIN
C
12800 CONTINUE
      ICFLAG=248
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.LE.0) GOTO 12810
      IF (IPRMPT.NE.2) THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,25)
      ELSE
         CALL OPNEWC (KODE,JOSTND,IREAD,IDT,ICFLAG,KEYWRD,KARD,IPRMPT,
     >                IRECNT,ICYC)
         CALL fvsGetRtnCode(IRTNCD)
         IF (IRTNCD.NE.0) RETURN
      ENDIF
      GOTO 10
12810 CONTINUE
C
C   PROCESS REMAINING PARAMETER FIELDS
C
      PRMS(1)=FLOAT(ITHNPN)
      IF(LNOTBK(2)) PRMS(1)=ARRAY(2)
      POINTNO=INT(PRMS(1))
C
C  CHECK FOR POINT GROUP
C
      CALL PTGDECD(POINTNO,KARD(2),IFLAG)
      IF(IFLAG.GE.1)THEN
        ITHNPN=POINTNO
        PRMS(1)=FLOAT(ITHNPN)
        ILEN=IPTGRP(ITHNPN,52)
        IF(LKECHO)WRITE(JOSTND,12812) 'POINT= ',KARD(2)(1:ILEN),ITHNPN
12812 FORMAT (T12,A,A,I3' TARGETED FOR THIS CUT.')
      ENDIF
C
      PRMS(2)=FLOAT(ITHNPA)
      IF(LNOTBK(3).AND.ARRAY(3).GT.0.) PRMS(2)=ARRAY(3)
C
      IF(PRMS(2).LE.0. .OR. PRMS(2).GT.6)THEN
        CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
        CALL ERRGRO (.TRUE.,4)
        IF(LKECHO)WRITE(JOSTND,12816)
12816   FORMAT(T12,'POINT THINNING RESIDUAL ATTRIBUTE IS MISSING ',
     &  'OR INVALID.')
        GO TO 10
      ENDIF
C
      CALL OPNEW (KODE,IDT,ICFLAG,2,PRMS)
      IF (KODE.GT.0) GOTO 10
      IF(PRMS(2).EQ.1.)THEN
        IF(LKECHO)WRITE(JOSTND,12824)KEYWRD,IDT,PRMS(1),PRMS(2)
12824   FORMAT(/A8,'   DATE/CYCLE=',I5,
     &  '; POINT NUMBER=',F5.0,'; POINT THINNING RESIDUAL ATTRIBUTE=',
     &  F5.0,' (TREES PER ACRE).')
      ELSEIF(PRMS(2).EQ.2.)THEN
        IF(LKECHO)WRITE(JOSTND,12825)KEYWRD,IDT,PRMS(1),PRMS(2)
12825   FORMAT(/A8,'   DATE/CYCLE=',I5,
     &  '; POINT NUMBER=',F5.0,'; POINT THINNING RESIDUAL ATTRIBUTE=',
     &  F5.0,' (BASAL AREA PER ACRE).')
      ELSEIF(PRMS(2).EQ.3.)THEN
        IF(LKECHO)WRITE(JOSTND,12826)KEYWRD,IDT,PRMS(1),PRMS(2)
12826   FORMAT(/A8,'   DATE/CYCLE=',I5,
     &  '; POINT NUMBER=',F5.0,'; POINT THINNING RESIDUAL ATTRIBUTE=',
     &  F5.0,' (STAND DENSITY INDEX).')
      ELSEIF(PRMS(2).EQ.4.)THEN
        IF(LKECHO)WRITE(JOSTND,12827)KEYWRD,IDT,PRMS(1),PRMS(2)
12827   FORMAT(/A8,'   DATE/CYCLE=',I5,
     &  '; POINT NUMBER=',F5.0,'; POINT THINNING RESIDUAL ATTRIBUTE=',
     &  F5.0,' (PERCENT CANOPY COVER).')
      ELSEIF(PRMS(2).EQ.5.)THEN
        IF(LKECHO)WRITE(JOSTND,12828)KEYWRD,IDT,PRMS(1),PRMS(2)
12828   FORMAT(/A8,'   DATE/CYCLE=',I5,
     &  '; POINT NUMBER=',F5.0,'; POINT THINNING RESIDUAL ATTRIBUTE=',
     &  F5.0,' (CURTIS RELATIVE DENSITY).')
      ELSE
        IF(LKECHO)WRITE(JOSTND,12829)KEYWRD,IDT,PRMS(1),PRMS(2)
12829   FORMAT(/A8,'   DATE/CYCLE=',I5,
     &  '; POINT NUMBER=',F5.0,'; POINT THINNING RESIDUAL ATTRIBUTE=',
     &  F5.0,' (SILVAH RELATIVE DENSITY).')
      ENDIF
            GO TO 10
C
C  ==========  OPTION NUMBER 129: THINPT   ========================THINPT
C
12900 CONTINUE
      ICFLAG=235
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.LE.0) GOTO 12910
      IF (IPRMPT.NE.2) THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,25)
      ELSE
         CALL OPNEWC (KODE,JOSTND,IREAD,IDT,ICFLAG,KEYWRD,KARD,IPRMPT,
     >                IRECNT,ICYC)
         CALL fvsGetRtnCode(IRTNCD)
         IF (IRTNCD.NE.0) RETURN
      ENDIF
      GOTO 10
12910 CONTINUE
      IF (LNOTBK(2)) THEN
         PRMS(1)=ARRAY(2)
      ELSE
C
C        REQUIRED RESIDUAL IS MISSING.
C
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
C
C   PROCESS REMAINING PARAMETER FIELDS
C
      PRMS(2)=EFF
      IF(LNOTBK(3)) PRMS(2)=ARRAY(3)
C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (4,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(IS.EQ.-999) GO TO 10
      PRMS(3)=IS
      PRMS(4)=0.0
      IF(LNOTBK(5)) PRMS(4)=ARRAY(5)
      PRMS(5)=999.0
      IF(LNOTBK(6)) PRMS(5)=ARRAY(6)
      IF(PRMS(5) .LE. PRMS(4))THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
      PRMS(6)=0.
      IF(LNOTBK(7)) PRMS(6)=ARRAY(7)
      IF(PRMS(6).EQ.0. .AND. PRMS(2).GT.0.)PRMS(2)=0.
      CALL OPNEW (KODE,IDT,ICFLAG,6,PRMS)
      IF (KODE.GT.0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,12920) KEYWRD,IDT,PRMS(1)
12920 FORMAT (/A8,'   DATE/CYCLE=',I5,'; RESIDUAL=',F8.2)
      IF(PRMS(2).EQ.0.)THEN
        ILEN=3
        IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,12921)KARD(4)(1:ILEN),IS,PRMS(4),PRMS(5)
12921   FORMAT(T12,
     >   'PROPORTION OF SELECTED TREES REMOVED WILL BE ',
     >   'COMPUTED BY THE MODEL'/,
     >   T12,'SPECIES=',A,' (CODE=',I3,');',
     >   ' DBH OF REMOVED TREES WILL RANGE FROM ',F5.1,' TO ',
     >   F5.1,' INCHES.')
      ELSE
        ILEN=3
        IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,12922)PRMS(2),KARD(4)(1:ILEN),
     &                                    IS,PRMS(4),PRMS(5)
12922   FORMAT(T12,
     >   'PROPORTION OF SELECTED TREES REMOVED= ',F6.3,';',/,
     >   T12,'SPECIES=',A,' (CODE=',I3,');',
     >   ' DBH OF REMOVED TREES WILL RANGE FROM ',F5.1,' TO ',
     >   F5.1,' INCHES.')
      ENDIF
      IF(PRMS(6) .EQ. 0) THEN
        IF(LKECHO)WRITE(JOSTND,12923)
12923   FORMAT(T12,'CUTTING WILL BE DISTRIBUTED THROUGHOUT THE ',
     >                'SPECIFIED DIAMETER CLASS,')
      ELSEIF (PRMS(6) .EQ. 1) THEN
        IF(LKECHO)WRITE(JOSTND,12924)
12924   FORMAT(T12,'CUTTING WILL BE FROM BELOW IN THE SPECIFIED ',
     >                'DIAMETER CLASS,')
      ELSE
        IF(LKECHO)WRITE(JOSTND,12925)
12925   FORMAT(T12,'CUTTING WILL BE FROM ABOVE IN THE SPECIFIED ',
     >                'DIAMETER CLASS,')
      ENDIF
      IF(LKECHO)WRITE(JOSTND,12926)
12926 FORMAT(T12,'ON THE POINT SPECIFIED WITH THE SETPTHIN ',
     >                'KEYWORD PRIOR TO THIS THINNING REQUEST.')
      GOTO 10
C
C  ==========  OPTION NUMBER 130: VOLEQNUM ========================VOLEQNUM
C
13000 CONTINUE
C
C  IF WE DONT HAVE A KODFOR VALUE YET SET REGION BASED ON VARIANT
C
      IF(KODFOR.LE.0)THEN
        SELECT CASE (VARACD)
          CASE('EM','KT','NI','IE')
            IRDUM=1
          CASE( 'CR')
            IRDUM=2
          CASE('CI','TT','UT')
            IRDUM=4
          CASE('CA','NC','SO','WS')
            IRDUM=5
          CASE('BM','PN','WC','EC')
            IRDUM=6
          CASE('OC','OP')
            IRDUM=7
          CASE('SN')
            IRDUM=8
          CASE('CS','LS','NE')
            IRDUM=9
          CASE('AK')
            IRDUM=10
        END SELECT
      ELSE
C
C   FOREST CODE PROCESSING
C
        IF((VARACD.EQ.'SN').AND.
     &     (KODFOR.GE.1000))THEN
          IREGN = KODFOR/10000
          IRDUM=IREGN
          IFORST=KODFOR/100-IREGN*100
          WRITE(FORST,'(I2)')IFORST
          IF(IFORST.LT.10)FORST(1:1)='0'
          INTDIST = KODFOR - (KODFOR/100)*100
          WRITE(DIST,'(I2)')INTDIST
          IF(INTDIST.LT.10)DIST(1:1)='0'
        ELSEIF(VARACD.EQ.'AK') THEN
          IREGN = 10
          FORST = '02'
        ELSE
          IREGN = KODFOR/100
          IRDUM=IREGN
          IFOREST = KODFOR-900
          WRITE(FORST,'(I2)')IFOREST
          IF(IFOREST.LT.10)FORST(1:1)='0'
        ENDIF
     
C
C  USE SPECIAL FORESTS FOR BIA AND PRIVATE VOLUME EQS.
C  PN-QUINAULT IR (FC=800 USES OLYMIC 609)
C  NC SIMPSOM TIMBER (FC=800 USES R5 SAY 510)
C  SO INDUSTRY LANDS (FC=701 USES R5 SAY 505)
C  SO WARM SPRINGS (FC=799 USES R6 FC=601)
C
        IF(VARACD.EQ.'PN' .OR. VARACD.EQ.'OP')THEN
          IF(IREGN.EQ.8)THEN
            IRDUM=6
            FORDUM='09'
          ELSE
            IRDUM=IREGN
            FORDUM=FORST
          ENDIF
        ELSEIF(VARACD.EQ.'NC')THEN
          IF(IREGN.EQ.8)THEN
            IRDUM=5
            FORDUM='10'
          ELSE
            IRDUM=IREGN
            FORDUM=FORST
          ENDIF
        ELSEIF(VARACD.EQ.'SO')THEN
          IF(IREGN.EQ.7)THEN
            SELECT CASE (KODFOR)
            CASE (701)
              IRDUM=5
              FORDUM='05'
            CASE (799)
              IRDUM=6
              FORDUM='01'
            END SELECT
          ELSE
            IRDUM=IREGN
            FORDUM=FORST
          ENDIF
        ELSE
          IRDUM=IREGN
          FORDUM=FORST
        ENDIF
      ENDIF

C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (1,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(IS .EQ. -999) GO TO 10
C----------
C  SPECIES GROUP PROCESSING
C----------
      IF(IS .LT. 0) THEN
        IGRP = -IS
        IULIM = ISPGRP(IGRP,1)+1
        IF(LNOTBK(2))THEN
          DO IG=2,IULIM
          IGSP = ISPGRP(IGRP,IG)
          VEQNNC(IGSP)=KARD(2)
          ENDDO
C----------
C  CHECK FOR VALID CUBIC FT EQUATION NUMBER
C----------
          ISPEC=9999
          PROD='02'
          CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                  VEQNNC(IGSP),ERRFLAG)
C
C  CHECK FOR CASES WHERE VARIANTS CROSS REGIONAL BOUNDARIES
C
          IF((KODFOR.LE.0).AND.(ISPEC.NE.8888))THEN
            SELECT CASE(IRDUM)
            CASE(1)
              IF(VARACD.EQ.'IE')THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(IGSP),ERRFLAG)
              ENDIF
            CASE(2)
              IF(VARACD.EQ.'CR')THEN
                IRDUM=3
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(IGSP),ERRFLAG)
              ENDIF
            CASE(5)
              IF((VARACD.EQ.'CA').OR.(VARACD.EQ.'NC').OR.
     &           (VARACD.EQ.'SO').OR.(VARACD.EQ.'OC'))THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(IGSP),ERRFLAG)
              ENDIF
            CASE(7)
              IF(VARACD.EQ.'OC')THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(IGSP),ERRFLAG)
                IF(ISPEC.NE.8888)THEN
                  IRDUM=5
                  CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(IGSP),ERRFLAG)
                ENDIF
              ENDIF
            END SELECT
          ENDIF
C
          IF(ISPEC.NE.8888)THEN
            DO IG=2,IULIM
            IGSP = ISPGRP(IGRP,IG)
            VEQNNC(IGSP)='          '
            ENDDO
            ILEN=ISPGRP(-IS,92)
            WRITE(JOSTND,13003)KEYWRD,KARD(1)(1:ILEN),IS
          ELSE
            ILEN=ISPGRP(-IS,92)
            IF(LKECHO)WRITE(JOSTND,13008)KEYWRD,KARD(1)(1:ILEN),IS
          ENDIF
        ENDIF
        IF(LNOTBK(3))THEN
          DO IG=2,IULIM
          IGSP = ISPGRP(IGRP,IG)
          VEQNNB(IGSP)=KARD(3)
          ENDDO
C----------
C  CHECK FOR VALID BOARD FT EQUATION NUMBER
C----------
          ISPEC=9999
          PROD='01'
          CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                  VEQNNB(IGSP),ERRFLAG)
C
C  CHECK FOR CASES WHERE VARIANTS CROSS REGIONAL BOUNDARIES
C
          IF((KODFOR.LE.0).AND.(ISPEC.NE.8888))THEN
            SELECT CASE(IRDUM)
            CASE(1)
              IF(VARACD.EQ.'IE')THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(IGSP),ERRFLAG)
              ENDIF
            CASE(2)
              IF(VARACD.EQ.'CR')THEN
                IRDUM=3
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(IGSP),ERRFLAG)
              ENDIF
            CASE(5)
              IF((VARACD.EQ.'CA').OR.(VARACD.EQ.'NC').OR.
     &           (VARACD.EQ.'SO').OR.(VARACD.EQ.'OC'))THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(IGSP),ERRFLAG)
              ENDIF
            CASE(7)
              IF(VARACD.EQ.'OC')THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(IGSP),ERRFLAG)
                IF(ISPEC.NE.8888)THEN
                  IRDUM=5
                  CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(IGSP),ERRFLAG)
                ENDIF
              ENDIF
            END SELECT
          ENDIF
C
          IF(ISPEC.NE.8888)THEN
            DO IG=2,IULIM
            IGSP = ISPGRP(IGRP,IG)
            VEQNNB(IGSP)='          '
            ENDDO
            ILEN=ISPGRP(-IS,92)
            IF(LNOTBK(2))KEYWRD='        '
            WRITE(JOSTND,13004)KEYWRD,KARD(1)(1:ILEN),IS
          ELSE
            ILEN=ISPGRP(-IS,92)
            IF(LNOTBK(2))KEYWRD='        '
            IF(LKECHO)WRITE(JOSTND,13009)KEYWRD,KARD(1)(1:ILEN),IS
          ENDIF
        ENDIF
        GOTO 10
13003   FORMAT(/A8,'   INVALID VOLUME EQUATION NUMBER: THE DEFAULT ',
     &    'CUBIC FT EQUATION NUMBER WILL BE USED FOR SPECIES GROUP=',A,
     &    ' (CODE=',I3,');')
13004   FORMAT(/A8,'   INVALID VOLUME EQUATION NUMBER: THE DEFAULT ',
     &    'BOARD FT EQUATION NUMBER WILL BE USED FOR SPECIES GROUP=',A,
     &    ' (CODE=',I3,');')
13008   FORMAT(/A8,'   NATIONAL CRUISE SYSTEM CUBIC FT VOLUME EQUA',
     &  'TION NUMBERS CHANGED FOR SPECIES GROUP=',A,' (CODE=',I3,');')
13009   FORMAT(/A8,'   NATIONAL CRUISE SYSTEM BOARD FT VOLUME EQUA',
     &  'TION NUMBERS CHANGED FOR SPECIES GROUP=',A,' (CODE=',I3,');')
C----------
C  ALL SPECIES PROCESSING
C----------
      ELSEIF(IS.EQ.0)THEN
        IF(LNOTBK(2))THEN
          DO I=1,MAXSP
            VEQNNC(I)=KARD(2)
          ENDDO
C----------
C  CHECK FOR VALID CUBIC FT EQUATION NUMBER
C----------
          ISPEC=9999
          PROD='02'
          CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                  VEQNNC(1),ERRFLAG)
C
C  CHECK FOR CASES WHERE VARIANTS CROSS REGIONAL BOUNDARIES
C
          IF((KODFOR.LE.0).AND.(ISPEC.NE.8888))THEN
            SELECT CASE(IRDUM)
            CASE(1)
              IF(VARACD.EQ.'IE')THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(1),ERRFLAG)
              ENDIF
            CASE(2)
              IF(VARACD.EQ.'CR')THEN
                IRDUM=3
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(1),ERRFLAG)
              ENDIF
            CASE(5)
              IF((VARACD.EQ.'CA').OR.(VARACD.EQ.'NC').OR.
     &           (VARACD.EQ.'SO').OR.(VARACD.EQ.'OC'))THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(1),ERRFLAG)
              ENDIF
            CASE(7)
              IF(VARACD.EQ.'OC')THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(1),ERRFLAG)
                IF(ISPEC.NE.8888)THEN
                  IRDUM=5
                  CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(1),ERRFLAG)
                ENDIF
              ENDIF
            END SELECT
          ENDIF
C
          IF(ISPEC.NE.8888)THEN
            DO I=1,MAXSP
            VEQNNC(I)='          '
            ENDDO
            WRITE(JOSTND,13006)KEYWRD
          ELSE
            IF(LKECHO)WRITE(JOSTND,13020)KEYWRD
          ENDIF
        ENDIF
        IF(LNOTBK(3))THEN
          DO I=1,MAXSP
            VEQNNB(I)=KARD(3)
          ENDDO
C----------
C  CHECK FOR VALID BOARD FT EQUATION NUMBER
C----------
          ISPEC=9999
          PROD='01'
          CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                  VEQNNB(1),ERRFLAG)
C
C  CHECK FOR CASES WHERE VARIANTS CROSS REGIONAL BOUNDARIES
C
          IF((KODFOR.LE.0).AND.(ISPEC.NE.8888))THEN
            SELECT CASE(IRDUM)
            CASE(1)
              IF(VARACD.EQ.'IE')THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(1),ERRFLAG)
              ENDIF
            CASE(2)
              IF(VARACD.EQ.'CR')THEN
                IRDUM=3
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(1),ERRFLAG)
              ENDIF
            CASE(5)
              IF((VARACD.EQ.'CA').OR.(VARACD.EQ.'NC').OR.
     &           (VARACD.EQ.'SO').OR.(VARACD.EQ.'OC'))THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(1),ERRFLAG)
              ENDIF
            CASE(7)
              IF(VARACD.EQ.'OC')THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(1),ERRFLAG)
                IF(ISPEC.NE.8888)THEN
                  IRDUM=5
                  CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(1),ERRFLAG)
                ENDIF
              ENDIF
            END SELECT
          ENDIF
C
          IF(ISPEC.NE.8888)THEN
            DO I=1,MAXSP
            VEQNNB(I)='          '
            ENDDO
            IF(LNOTBK(2))KEYWRD='        '
            WRITE(JOSTND,13016)KEYWRD
          ELSE
            IF(LNOTBK(2))KEYWRD='        '
            IF(LKECHO)WRITE(JOSTND,13021)KEYWRD
          ENDIF
        ENDIF
        GOTO 10
13006   FORMAT(/A8,'   INVALID VOLUME EQUATION NUMBER: THE',
     &    ' DEFAULT CUBIC FT EQUATION NUMBERS WILL BE USED FOR ALL ',
     &    'SPECIES:')
C       IF(LKECHO)WRITE(JOSTND,13021)KEYWRD
13020   FORMAT(/A8,'   NATIONAL CRUISE SYSTEM CUBIC FT ',
     &    'VOLUME EQUATION NUMBERS CHANGED FOR ALL SPECIES:')
13016   FORMAT(/A8,'   INVALID VOLUME EQUATION NUMBER: THE',
     &    ' DEFAULT BOARD FT EQUATION NUMBERS WILL BE USED FOR ALL ',
     &    'SPECIES:')
C       IF(LKECHO)WRITE(JOSTND,13021)KEYWRD
13021   FORMAT(/A8,'   NATIONAL CRUISE SYSTEM BOARD FT VOLUME ',
     &     'EQUATION NUMBERS CHANGED FOR ALL SPECIES:')
C----------
C  SINGLE SPECIES PROCESSING
C----------
      ELSE
C----------
C  CHECK FOR VALID EQUATION NUMBER CUBIC FT
C----------
        IF(LNOTBK(2))THEN
          VEQNNC(IS)=KARD(2)
          ISPEC=9999
          PROD='02'
          CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                  VEQNNC(IS),ERRFLAG)
C
C  CHECK FOR CASES WHERE VARIANTS CROSS REGIONAL BOUNDARIES
C
          IF((KODFOR.LE.0).AND.(ISPEC.NE.8888))THEN
            SELECT CASE(IRDUM)
            CASE(1)
              IF(VARACD.EQ.'IE')THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(IS),ERRFLAG)
              ENDIF
            CASE(2)
              IF(VARACD.EQ.'CR')THEN
                IRDUM=3
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(IS),ERRFLAG)
              ENDIF
            CASE(5)
              IF((VARACD.EQ.'CA').OR.(VARACD.EQ.'NC').OR.
     &           (VARACD.EQ.'SO').OR.(VARACD.EQ.'OC'))THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(IS),ERRFLAG)
              ENDIF
            CASE(7)
              IF(VARACD.EQ.'OC')THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(IS),ERRFLAG)
                IF(ISPEC.NE.8888)THEN
                  IRDUM=5
                  CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNC(IS),ERRFLAG)
                ENDIF
              ENDIF
            END SELECT
          ENDIF
C
          IF(ISPEC.NE.8888)THEN
            VEQNNC(IS)='          '
            KARD(2)='***INVALID'
           WRITE(JOSTND,13030)KEYWRD,KARD(1)(1:3),IS
         ELSE
           IF(LKECHO)WRITE(JOSTND,13030)KEYWRD,KARD(1)(1:3),IS
          ENDIF
        ENDIF
C----------
C  CHECK FOR VALID EQUATION NUMBER BOARD FT
C----------
        IF(LNOTBK(3))THEN
          VEQNNB(IS)=KARD(3)
          ISPEC=9999
          PROD='01'
          CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                  VEQNNB(IS),ERRFLAG)
C
C  CHECK FOR CASES WHERE VARIANTS CROSS REGIONAL BOUNDARIES
C
          IF((KODFOR.LE.0).AND.(ISPEC.NE.8888))THEN
            SELECT CASE(IRDUM)
            CASE(1)
              IF(VARACD.EQ.'IE')THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(IS),ERRFLAG)
              ENDIF
            CASE(2)
              IF(VARACD.EQ.'CR')THEN
                IRDUM=3
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(IS),ERRFLAG)
              ENDIF
            CASE(5)
              IF((VARACD.EQ.'CA').OR.(VARACD.EQ.'NC').OR.
     &           (VARACD.EQ.'SO').OR.(VARACD.EQ.'OC'))THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(IS),ERRFLAG)
              ENDIF
            CASE(7)
              IF(VARACD.EQ.'OC')THEN
                IRDUM=6
                CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(IS),ERRFLAG)
                IF(ISPEC.NE.8888)THEN
                  IRDUM=5
                  CALL VOLEQDEF(VARACD,IRDUM,FORDUM,DIST,ISPEC,PROD,
     &                VEQNNB(IS),ERRFLAG)
                ENDIF
              ENDIF
            END SELECT
          ENDIF
C
          IF(ISPEC.NE.8888)THEN
            VEQNNB(IS)='          '
            KARD(3)='***INVALID'
            IF(.NOT.LNOTBK(2))WRITE(JOSTND,13030)KEYWRD,KARD(1)(1:3),IS
          ELSE
            IF(.NOT.LNOTBK(2).AND.LKECHO)
     &      WRITE(JOSTND,13030)KEYWRD,KARD(1)(1:3),IS
          ENDIF
        ENDIF
13030     FORMAT(/A8,'   NATIONAL CRUISE SYSTEM VOLUME EQUATION ',
     &    'NUMBERS CHANGED FOR SPECIES=',A,' (CODE=',I3,');')
      ENDIF
      IF(LNOTBK(2).AND.LNOTBK(3))THEN
        IF(LKECHO)WRITE(JOSTND,13040)KARD(2),KARD(3)
13040   FORMAT(T9,'   CUBIC FOOT = ',A10,'   BOARD FOOT = ',A10)
      ELSEIF(LNOTBK(2))THEN
        IF(LKECHO)WRITE(JOSTND,13041)KARD(2)
13041   FORMAT(T9,'   CUBIC FOOT = ',A10)
      ELSEIF(LNOTBK(3))THEN
        IF(LKECHO)WRITE(JOSTND,13042)KARD(3)
13042   FORMAT(T9,'   BOARD FOOT = ',A10)
      ELSE
        WRITE(JOSTND,13043)
13043   FORMAT(T9,' EQUATION NUMBERS NOT SPECIFIED.',
     &  '  REQUEST CANCELLED.')
      ENDIF
      GO TO 10
C
C  ==========  OPTION NUMBER 131: POINTREF ==========================POINTREF
C
13100 CONTINUE
      IF(LNOTBK(1)) ITHNPI=IFIX(ARRAY(1)+0.5)
      IF(ITHNPI.LT.0 .OR. ITHNPI.GT.2) THEN
        CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
        CALL ERRGRO (.TRUE.,4)
        WRITE(JOSTND,13105)
13105   FORMAT(T12,'INVALID POINT INDICATOR. POINT INDICATOR BEING ',
     &  'RESET TO 1 (POINT NUMBERS FROM DATA) FOR FURTHER PROCESSING.')
        ITHNPI=1
        GO TO 10
      ENDIF
      IF(ITHNPI.EQ.1.)THEN
        IF(LKECHO)WRITE(JOSTND,13110)KEYWRD
13110   FORMAT(/A8,'   POINT NUMBERS ARE AS INPUT IN THE TREE DATA.')
      ELSE
        IF(LKECHO)WRITE(JOSTND,13111)KEYWRD
13111   FORMAT(/A8,'   POINT NUMBERS ARE THE FVS SEQUENTIAL POINT ',
     &  'NUMBERS.')
      ENDIF
      GO TO 10
C
C  ==========  OPTION NUMBER 132: ECHO  ============================ECHO
C
13200 CONTINUE
      LKECHO=.TRUE.
      IF(IRECNT.GT.JRECNT)THEN
        JRECNT=IRECNT-JRECNT-1
      ELSE
        JRECNT=IRECNT
      ENDIF
      WRITE(JOSTND,13210)KEYWRD,JRECNT
13210 FORMAT(/A8,'   THERE WERE',I8,' KEYWORD RECORDS PROCESSED.',
     &' KEYWORD ECHO WILL RESUME.')
      GO TO 10
C
C  ==========  OPTION NUMBER 133: NOECHO ===========================NOECHO
C
13300 CONTINUE
        LKECHO=.FALSE.
        JRECNT=IRECNT
        WRITE(JOSTND,13310)KEYWRD
13310   FORMAT(/A8,'   KEYWORDS WILL **NOT** BE ECHOED TO THE MAIN',
     &                ' OUTPUT FILE.')
      GO TO 10
C
C  ==========  OPTION NUMBER 134: CYCLEAT ===========================CYCLEAT
C
13400 CONTINUE
        NEWYR = IFIX(ARRAY(1))
        IF(NEWYR.LE.0) THEN
           CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
           CALL ERRGRO (.TRUE.,4)
        ELSE
           IF (IWORK1(1).EQ.0) THEN
              IWORK1(1)=1
              IWORK1(2)=NEWYR
           ELSE
              I = IWORK1(1)+1
              J = 0
              DO K=2,I
                IF (IWORK1(K).EQ.NEWYR) THEN
                  J=K
                  EXIT
                ENDIF
              ENDDO
              IF (J.EQ.0) THEN
                 IWORK1(1)=I
                 IWORK1(I+1)=NEWYR
              ENDIF
           ENDIF
           IF(LKECHO)WRITE(JOSTND,13410) KEYWRD,NEWYR
13410      FORMAT(/A8,'   REQUESTED YEAR FOR A CYCLE =',I4)
        ENDIF
        GO TO 10
C
C  ==========  OPTION NUMBER 135: ATRTLIST  ==========================ATRTLIST
C
13500 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
      NP = 2
      IF (LNOTBK(4)) NP = 3
      IF (.NOT.LNOTBK(2)) ARRAY(2)=FLOAT(JOLIST)
      CALL OPNEW (KODE,IDT,198,NP,ARRAY(2))
      IF (KODE.GT.0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,13510) KEYWRD,IDT,ARRAY(2),ARRAY(3)
13510 FORMAT (/A8,'   DATE/CYCLE=',I5,'; DATA SET REFERENCE ',
     >        'NUMBER =',F4.0,'; HEADING SUPPRESSION CODE =',F3.0/
     >        T12,'(0=WITH HEADING, OTHER VALUES=SUPPRESS HEADING).')
      GOTO 10
C
C  ==========  OPTION NUMBER 136: THINRDSL ==========================THINRDSL
C
13600 CONTINUE
      IF(VARACD.NE.'NE') THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         WRITE(JOSTND,13601)
13601    FORMAT(/'********   ','THIS KEYWORD IS NOT VALID FOR THIS ',
     &   'VARIANT. KEYWORD IGNORED.')
         GO TO 10
      ENDIF
      ICFLAG=236
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.LE.0) GOTO 13610
      IF (IPRMPT.NE.2) THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,25)
      ELSE
         CALL OPNEWC (KODE,JOSTND,IREAD,IDT,ICFLAG,KEYWRD,KARD,IPRMPT,
     >                IRECNT,ICYC)
         CALL fvsGetRtnCode(IRTNCD)
         IF (IRTNCD.NE.0) RETURN
      ENDIF
      GOTO 10
13610 CONTINUE
      IF (LNOTBK(2)) THEN
         PRMS(1)=ARRAY(2)
      ELSE
C
C        REQUIRED RESIDUAL IS MISSING.
C
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
C
C   PROCESS REMAINING PARAMETER FIELDS
C
      PRMS(2)=EFF
      IF(LNOTBK(3)) PRMS(2)=ARRAY(3)
C
C   SPECIES CODE PROCESSING.
C
      CALL SPDECD (4,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF(IS.EQ.-999) GO TO 10
      PRMS(3)=IS
      PRMS(4)=0.0
      IF(LNOTBK(5)) PRMS(4)=ARRAY(5)
      PRMS(5)=999.0
      IF(LNOTBK(6)) PRMS(5)=ARRAY(6)
      IF(PRMS(5) .LE. PRMS(4))THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
      PRMS(6)=0.
      IF(LNOTBK(7)) PRMS(6)=ARRAY(7)
      IF(PRMS(6).EQ.0. .AND. PRMS(2).GT.0.)PRMS(2)=0.
      CALL OPNEW (KODE,IDT,ICFLAG,6,PRMS)
      IF (KODE.GT.0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,12420) KEYWRD,IDT,PRMS(1)
      IF(PRMS(2).EQ.0.)THEN
        ILEN=3
        IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,12421)KARD(4)(1:ILEN),IS,PRMS(4),PRMS(5)
      ELSE
        ILEN=3
        IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
        IF(LKECHO)WRITE(JOSTND,12422)PRMS(2),KARD(4)(1:ILEN),IS,
     &                               PRMS(4),PRMS(5)
      ENDIF
      IF(PRMS(6) .EQ. 0) THEN
        IF(LKECHO)WRITE(JOSTND,12423)
      ELSEIF (PRMS(6) .EQ. 1) THEN
        IF(LKECHO)WRITE(JOSTND,12424)
      ELSE
        IF(LKECHO)WRITE(JOSTND,12425)
      ENDIF
      GOTO 10
C
C  ==========  OPTION NUMBER 137: MORTMSB  ===========================MORTMSB
C
13700 CONTINUE
      IF(LNOTBK(1)) THEN
        IF(ARRAY(1) .GT. 0.)THEN
          QMDMSB=ARRAY(1)
        ELSE
          CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
          CALL ERRGRO (.TRUE.,4)
          GOTO 13714
        ENDIF
      ENDIF
      IF(LNOTBK(2)) THEN
        IF(ARRAY(2).LE. -1.605 .AND. ARRAY(2).GE. -10.0)THEN
          SLPMSB=ARRAY(2)
        ELSE
          CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
          CALL ERRGRO (.TRUE.,4)
          GOTO 13714
        ENDIF
      ENDIF
      IF(LNOTBK(3))THEN
        IF(ARRAY(3).GT. 0. .AND. ARRAY(3).LE. 1.0)THEN
          EFFMSB=ARRAY(3)
        ELSE
          CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
          CALL ERRGRO (.TRUE.,4)
          GOTO 13714
        ENDIF
      ENDIF
      IF(LNOTBK(4))THEN
        IF(ARRAY(4) .GE. 0.) DLOMSB=ARRAY(4)
      ENDIF
      IF(LNOTBK(5))THEN
        IF(ARRAY(5) .GE. 0.) DHIMSB=ARRAY(5)
      ENDIF
      IF(DLOMSB .GE. DHIMSB)THEN
        CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
        CALL ERRGRO (.TRUE.,4)
        GOTO 13714
      ENDIF
      IF(LNOTBK(6))THEN
        IF(ARRAY(6).GE.1 .AND. ARRAY(6).LE.3)THEN
          MFLMSB=IFIX(ARRAY(6))
        ELSE
          CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
          CALL ERRGRO (.TRUE.,4)
          GOTO 13714
        ENDIF
      ENDIF
      IF(LKECHO)WRITE(JOSTND,13710) KEYWRD,QMDMSB,SLPMSB,EFFMSB,
     &DLOMSB,DHIMSB,MFLMSB
13710 FORMAT (/A8,'   MATURE STAND BOUNDARY: QMD =',F9.4,
     >';  SLOPE = ',F9.4,';  MORTALITY EFFICIENCY = ',F9.4,';',/11X,
     >'LOWER DBH (GE) = ',F6.1,';  UPPER DBH (LT) = ',F6.1,
     >';  MORTALITY FLAG = ',I1)
      IF(LKECHO .AND. MFLMSB .EQ. 1)THEN
        WRITE(JOSTND,13711)
      ELSEIF(LKECHO .AND. MFLMSB .EQ. 2)THEN
        WRITE(JOSTND,13712)
      ELSE
        WRITE(JOSTND,13713)
      ENDIF
13711 FORMAT(11X,'(MORTALITY WILL BE FROM ABOVE WITHIN THE SPECIFIED',
     &' DBH RANGE.)')
13712 FORMAT(11X,'(MORTALITY WILL BE FROM BELOW WITHIN THE SPECIFIED',
     &' DBH RANGE.)')
13713 FORMAT(11X,'(MORTALITY WILL BE SPREAD THROUGHOUT THE SPECIFIED',
     &' DBH RANGE.)')
      GOTO 10
C
C RESTORE DEFAULTS
C
13714 CONTINUE
      QMDMSB=999.
      SLPMSB=0.
      CEPMSB=0.
      EFFMSB=0.90
      DLOMSB=0.
      DHIMSB=999.
      MFLMSB=1
      GO TO 10
C
C  ==========  OPTION NUMBER 138: SETSITE  ===========================SETSITE
C
13800 CONTINUE
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C     NOTE: A NUMERIC VALUE MUST BE PASSED OR THERE WILL BE AN ERROR
C     COMPILING THE EXPRESSION IN GRINCR. SO IN PASSING A PLANT ASSOCIATION
C     CODE, USERS SHOULD ENTER THE NUMERIC SEQUENCE NUMBER OF THE PA CODE.
C
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
           CALL OPNEWC (KODE,JOSTND,IREAD,IDT,120,KEYWRD,KARD,
     >                  IPRMPT,IRECNT,ICYC)
           CALL fvsGetRtnCode(IRTNCD)
           IF (IRTNCD.NE.0) RETURN
         ENDIF
         GOTO 10
      ENDIF
C
C  IF HABITAT TYPE WAS ENTERED, TRANSLATE IT FOR THIS VARIANT, AND
C  PASS THE INDEX OF THE TRANSLATED VALUE.
C
      IHAB=0
      IF (LNOTBK(2)) THEN
        IDUM1=ICL5
        IDUM2=ITYPE
        IDUM3=KODTYP
        PVRDUM=CPVREF
        KODTYP=IFIX(ARRAY(2))
        ICL5=KODTYP
        CPVREF='          '
        TPCOM=PCOM
        CALL HABTYP (KARD(2),ARRAY(2))
        ARRAY(2)=FLOAT(KODTYP)
        IHAB=KODTYP
        ICL5=IDUM1
        ITYPE=IDUM2
        KODTYP=IDUM3
        CPVREF=PVRDUM
        PCOM=TPCOM
      ENDIF
C
C  BASAL AREA MAXIMUM PROCESSING
C
      IF(.NOT.LNOTBK(3))ARRAY(3)=0.
C
C  SPECIES CODE PROCESSING.
C
      CALL SPDECD (4,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF (IS.EQ.-999) GOTO 10
C
C  SITE INDEX AND SITE INDEX FLAG PROCESSING
C
      IF(.NOT.LNOTBK(5))ARRAY(5)=0.
      IF(.NOT.LNOTBK(6))ARRAY(6)=0.
C
C  STAND DENSITY INDEX MAXIMUM PROCESSING
C
      IF(.NOT.LNOTBK(7))ARRAY(7)=0.
C
C  WRITE KEYWORD TO THE OUTPUT FILE AND SEND TO THE OPTION PROCESSOR.
C
      ILEN=3
      IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
      IF(LKECHO)WRITE(JOSTND,13830)KEYWRD,IDT
13830 FORMAT (/A8,'   DATE/CYCLE=',I5)
C
      IF(ARRAY(2).NE.0 .AND. LKECHO)THEN
        WRITE(JOSTND,13832)IHAB
13832   FORMAT (T12,'HABITAT TYPE=',I5)
      ENDIF
C
      IF(ARRAY(3).NE.0 .AND. LKECHO)THEN
        WRITE(JOSTND,13836)ARRAY(3)
13836   FORMAT (T12,'BASAL AREA MAXIMUM=',F5.0)
      ENDIF
C
      IF(ARRAY(5).NE.0 .AND. LKECHO)THEN
        WRITE(JOSTND,13833)KARD(4)(1:ILEN),IS,ARRAY(5)
13833   FORMAT (T12,'SPECIES=',A,' (CODE=',I3,'); SITE INDEX=',F10.1)
        IF(ARRAY(6).EQ.0)THEN
          WRITE(JOSTND,13834)
13834     FORMAT(T12,'SITE INDEX VALUE IS ENTERED DIRECTLY')
        ELSE
          WRITE(JOSTND,13835)
13835     FORMAT(T12,'SITE INDEX VALUE ENTERED AS A PERCENT CHANGE')
        ENDIF
      ENDIF
C
      IF(ARRAY(7).NE.0 .AND. LKECHO)THEN
        WRITE(JOSTND,13837)ARRAY(7)
13837   FORMAT (T12,'STAND DENSITY INDEX=',F5.0)
      ENDIF
C
      CALL OPNEW (KODE,IDT,120,6,ARRAY(2))
      GOTO 10
C
C  ==========  OPTION NUMBER 139: CLIMATE  ===========================CLIMATE
C
13900 CONTINUE
      IF(LKECHO)WRITE(JOSTND,13910) KEYWRD
13910 FORMAT (/A8,'   CLIMATE EXTENSION KEYWORDS:')
      CALL CLIN (DEBUG,LKECHO)
      CALL fvsGetRtnCode(IRTNCD)
      IF (IRTNCD.NE.0) RETURN
      GOTO 10
C
C  ==========  OPTION NUMBER 1400 SDICALC ===========================SDICALC
C
14000 CONTINUE
        DBHSTAGE=0.
        IF(LNOTBK(1))DBHSTAGE=ARRAY(1)
        DBHZEIDE=0.
        IF(LNOTBK(2))DBHZEIDE=ARRAY(2)
        IF(ARRAY(3).GE.1)THEN
          LZEIDE=.TRUE.
          CALCSDI="ZEIDE"
        ELSE
          LZEIDE=.FALSE.
          CALCSDI="REINEKE"
        ENDIF
        IF(LKECHO)WRITE(JOSTND,14010) KEYWRD,CALCSDI,DBHSTAGE,DBHZEIDE
14010   FORMAT (/A8,'   THE ',A7,' METHOD WILL BE ',
     &              'USED TO CALCULATE SDI.'/
     &  8X,'   THE MINIMUM DIAMETER USED IN REINEKE SDI CALCULATIONS = '
     &  ,F6.2,' IN'/
     &  8X,'   THE MINIMUM DIAMETER USED IN ZEIDE SDI CALCULATIONS = ',
     &  F6.2,' IN')
        GO TO 10
      CALL ERRGRO (.TRUE.,16)
      GO TO 10
C
C  ==========  OPTION NUMBER 141: THINQFA  ===========================THINQFA
C
14100 CONTINUE
      ICFLAG=237
      IDT=1
      IF (LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,ICFLAG,KEYWRD,KARD,
     >                   IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
         GOTO 10
      ENDIF
      CALL SPDECD (4,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF (IS.EQ.-999) GOTO 10
      PRMS(3)=IS
C
C  DEFAULT PARAMETERS
C
      PRMS(1)=0.      ! LOWER DBH
      PRMS(2)=24.     ! UPPER DBH
      PRMS(4)=1.4     ! Q FACTOR
      PRMS(5)=2.      ! DIA. CLASS WIDTH
      PRMS(6)=0.      ! BA, SDI, OR TPA TARGET VALUE
C
      IF (LNOTBK(2))PRMS(1)=ARRAY(2)       ! LOWER DBH
      IF (LNOTBK(3))PRMS(2)=ARRAY(3)       ! UPPER DBH
      IF (LNOTBK(5))PRMS(4)=ARRAY(5)  ! Q FACTOR        
      IF (LNOTBK(6))PRMS(5)=ARRAY(6)  ! DIA. CLASS WIDTH
      IF (LNOTBK(7))PRMS(6)=ARRAY(7)  ! TARGET TPA, BA, or SDI 
C
C  THE SWITCH TO SET THE UNITS FOR THE TARGET ARE ON A SECOND RECORD
C  OF THE THINQFA KEYWORD 
C  <= 0 - TPA TARGET
C  <= 1 - BA TARGET
C  >  1 - SDI TARGET
C
      ISETQFA=0
      READ(IREAD,'(I1)')ISETQFA
      IRECNT=IRECNT+1
C
      IF(ISETQFA.LE.0)THEN                  ! BA TARGET
        CTARGET='TARGET BA='
        PRMS(7)=0
      ELSEIF(ISETQFA.LE.1)THEN              ! TPA TARGET
        CTARGET='TARGET TPA='
        PRMS(7)=1
      ELSEIF(ISETQFA.GT.1)THEN              ! SDI TARGET
        CTARGET='TARGET SDI='
        PRMS(7)=2
      ENDIF
C
      CALL OPNEW(KODE,IDT,ICFLAG,7,PRMS(1))
      IF (KODE.GT.0) GOTO 10
      IF(LKECHO)WRITE(JOSTND,41110)KEYWRD,IDT,PRMS(1),PRMS(2)
41110 FORMAT(/A8,'   DATE/CYCLE=',I5,'; MINIMUM ',F8.1,
     >        '; MAXIMUM ',F8.1)
      IF (IS.NE.0) THEN
         ILEN=3
         IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
         IF(LKECHO)WRITE(JOSTND,41114) ' SPECIES= ',KARD(4)(1:ILEN),
     >                                IS,'IS'
41114    FORMAT (T11,A,A,' (CODE= ',I3,') ',A,
     >           ' TARGETED FOR THIS CUT.')
      ELSE
         IF(LKECHO)WRITE(JOSTND,41114) ' ALL',' SPECIES',IS,'ARE'
      ENDIF
      IF(LKECHO)WRITE(JOSTND,41117)PRMS(4),PRMS(5),CTARGET,PRMS(6)
41117 FORMAT(T12,'Q FACTOR= ',F8.3,/
     >       T12,'DIA. CLASS WIDTH= ',F6.1,/
     >       T12,A,F6.1)
C
      GOTO 10
C
C  ==========  OPTION NUMBER 142: PTGROUP ===========================PTGROUP
C
14200 CONTINUE
C
C     FIRST CHECK TO SEE THAT THE MAXIMUM NUMBER OF POINT GROUPS HAS NOT
C     ALREADY BEEN DEFINED.  IF SO, IGNORE THIS REQUEST.
C
      IF(NPTGRP .GE. 30)THEN
        IF(LKECHO)WRITE(JOSTND,14210) IRECNT,KEYWRD,KARD(1)
14210   FORMAT (/,'CARD NUM =',I5,'; KEYWORD FIELD = ',A8,
     &  '   GROUP NAME: ',A10)
        CALL ERRGRO(.TRUE.,37)
14220   CONTINUE
        IRECNT=IRECNT+1
        READ(IREAD,'(A)',END=80) RECORD
        I=LEN_TRIM(RECORD)
        IF(LKECHO)WRITE(JOSTND,'(" SKIPPED RECORD=",A)') RECORD(:I)
        IF (RECORD(I:I).EQ.'&') GOTO 14220
        GO TO 10
      ENDIF
C
C     PROCESS THE POINT GROUP REQUEST. DELETE LEADING BLANKS
C     FROM THE POINT GROUP NAME AND STORE THE LENGTH OF THE
C     NAME
C
      NPTGRP=NPTGRP+1
      IF(LNOTBK(1))THEN            ! if there is a name, then use it
        PTGNAME(NPTGRP)=ADJUSTL(KARD(1))
        ILEN=LEN_TRIM(PTGNAME(NPTGRP))
        DO J=1,ILEN
          CALL UPCASE(PTGNAME(NPTGRP)(J:J))
        ENDDO
      ELSE                         ! otherwise build one
        WRITE(PTGNAME(NPTGRP),'("PTGROUP",I2.2,2X)') NPTGRP
        ILEN=9
      ENDIF
      IPTGRP(NPTGRP,52)=ILEN       ! save the group name length
      INUM=0                       ! initialize the number of codes in the group
      KARD=' '                     ! blank out and zero out kard and arrays
      ARRAY=0
14230 CONTINUE
      IRECNT=IRECNT+1
      READ(IREAD,'(A)',END=80) RECORD
      ILEN=LEN_TRIM(RECORD)
      J=0                          ! j points to the first char for the new token...
                                   ! when j is zero, no new token is being built.
      DO I=1,ILEN                  ! loop over the chars in the record
        IF (RECORD(I:I).EQ.' ') THEN ! hit a blank
          IF (J.EQ.0) CYCLE          ! if no token being built, go on to next char
        ENDIF
        IF (RECORD(I:I).EQ.'&') GOTO 14230  ! read another record
        IF (J.EQ.0) J=I
C        CALL UPCASE(RECORD(I:I))
        IF (RECORD(I:I).EQ.' '.OR.I.EQ.ILEN) THEN ! end of token (a blank or end of record)
          INUM=INUM+1              ! so, we have a token.
C
C  DON'T SAVE OVER 50, COULD DO AN ERROR MSG, BUT DIDN'T
C
          IF (INUM.GT.50) INUM=50
          IF (I.EQ.ILEN) THEN      ! store the token in kard(1)
            KARD(1)=RECORD(J:I)
          ELSE
            KARD(1)=RECORD(J:I-1)
          ENDIF
          J=0
          ARRAY(1)=0.
          READ(KARD(1),'(F10.0)',ERR=14240) ARRAY(1)  ! make a number, if we can.
14240     CONTINUE
          IF (ARRAY(1).EQ.0) THEN  ! zero is illegal
            INUM=INUM-1
            CYCLE
          ENDIF
          IF (INUM.GT.1) THEN     ! check for duplicates, save unique codes
            DO J=2,INUM
              IF (IPTGRP(NPTGRP,J).EQ.ARRAY(1)) THEN
                ARRAY(1)=-999           ! if it is a dup, then set flag
                EXIT
              ENDIF
            ENDDO
            J=0
            IF (ARRAY(1).EQ.-999) THEN  ! skip dups
              INUM=INUM-1
              CYCLE
            ENDIF
          ENDIF
          IPTGRP(NPTGRP,INUM+1)=INT(ARRAY(1))
        ENDIF
      ENDDO
      IPTGRP(NPTGRP,1)=INUM
C
      IF(LKECHO)WRITE(JOSTND,14250) KEYWRD,-NPTGRP,PTGNAME(NPTGRP),INUM,
     &(IPTGRP(NPTGRP,J),J=2,INUM+1)
14250 FORMAT(/A8,'   GROUP NUMBER:',I4,'  GROUP NAME: ',A10,
     &'  NUMBER OF POINTS IN THIS GROUP:',I3,'  POINTS:'/5(T12,10I10/))
      GO TO 10
C
C  ==========  OPTION NUMBER 143: ORGANON  ===========================ORGANON
C
14300 CONTINUE
C----------
C  CALL THE SUBROUTINE THAT READS ORGANON CONTROL PARAMETERS FROM THE
C  KEYWORD FILE
C----------
      SELECT CASE (VARACD)
C
        CASE ('OC','OP')
          IF(LKECHO)WRITE(JOSTND,14310) KEYWRD
14310     FORMAT (/,A8,'   START OF ORGANON KEYWORDS:')
          CALL ORIN (DEBUG,LKECHO,LNOTRE)
C
        CASE DEFAULT
          IF(LKECHO)WRITE(JOSTND,14315) KEYWRD
14315     FORMAT (/,A8,'   ORGANON KEYWORDS NOT RECOGNIZED IN THIS',
     &    ' VARIANT')
C
      END SELECT
      GOTO 10
C
C  ==========  OPTION NUMBER 144: SPLEAVE ============================SPLEAVE
C
14400 CONTINUE
      IDT=1
      IF(LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,206,KEYWRD,KARD,
     >                      IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
         GOTO 10
      ENDIF
C
C     IF THE SELECTION VALUE IS NOT PRESENT;
C     THEN:  WRITE ERROR MSG AND SKIP PROCESSING KEYWORD CARD.
C
      IF (.NOT.LNOTBK(2)) THEN
        CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
        CALL ERRGRO (.TRUE.,4)
        GOTO 10
      ENDIF
C
C     SPECIES CODE PROCESSING.
C
      CALL SPDECD (2,IS,NSP(1,1),JOSTND,IRECNT,KEYWRD,
     &             ARRAY,KARD)
      IF (IS.EQ.-999) GOTO 10
      PRMS(1)=IS
C
C  DEFAULT IS LEAVE THE SPECIES PRMS(2)=1.
C
      PRMS(2)=1.
      IF (LNOTBK(3))PRMS(2)=ARRAY(3)
C
C     SCHEDULE THE ACTIVITY
C
      CALL OPNEW(KODE,IDT,206,2,PRMS)
      IF (KODE .GT. 0) GOTO 10
      ILEN=3
      IF(IS.LT.0)ILEN=ISPGRP(-IS,92)
      IF(PRMS(2).GT.0)THEN
        IF(LKECHO)WRITE(JOSTND,14410) KEYWRD,IDT,KARD(2)(1:ILEN),IS
      ELSE
        IF(LKECHO)WRITE(JOSTND,14420) KEYWRD,IDT,KARD(2)(1:ILEN),IS
      ENDIF
14410 FORMAT (/A8,'   DATE/CYCLE=',I5,'; SPECIES= ',A,' (CODE=',
     >           I3,'); WILL NOT BE INCLUDED IN THE FOLLOWING',
     >           ' THINNING ACTIVITIES')
14420 FORMAT (/A8,'   DATE/CYCLE=',I5,'; SPECIES= ',A,' (CODE=',
     >           I3,'); WILL BE INCLUDED IN THE FOLLOWING',
     >           ' THINNING ACTIVITIES')
      GOTO 10
C
C  ==========  OPTION NUMBER 145: CCADJ ============================CCADJ
C
14500 CONTINUE 
      IDT=1
      IF(LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C    IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C    TO PROCESS IT.
C
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,444,KEYWRD,KARD,
     >                      IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
         GOTO 10
      ENDIF   
C     
C    IF THE FIRST PARAMETER IS NOT PRESENT THEN SET OR JUST OUTPUT
C    THE CURRENT CORRECTION FACTOR. 
C
      IF (.NOT.LNOTBK(1)) THEN
        IF (.NOT.LNOTBK(2)) THEN
          ARRAY(2) = CCCOEF
        ELSE
          CCCOEF = ARRAY(2)
        ENDIF
        IF(LKECHO)WRITE(JOSTND,14505) KEYWRD,ARRAY(2)
14505   FORMAT (/A8,'   OVERLAP COEFFICIENT=',F8.6)                   
      ELSE
        PRMS(1)=ARRAY(2)
C     
C       SCHEDULE THE ACTIVITY
C
        CALL OPNEW (KODE,IDT,444,1,PRMS)
        IF (KODE.GT.0) GOTO 10     
        IF(LKECHO)WRITE(JOSTND,14510)KEYWRD,IDT,ARRAY(2)
14510   FORMAT (/A8,'   DATE/CYCLE=',I5,'; OVERLAP COEFICCIENT=',F8.6)
      ENDIF     
      GOTO 10
C
C  ==========  OPTION NUMBER 146: PRMFROST  ==========================PRMFROST
C
14600 CONTINUE
      IDT=1
      IF(LNOTBK(1)) IDT=IFIX(ARRAY(1))
C
C     IF THE KEYWORD RECORD HAS THE 'PARMS' OPTION, CALL OPNEWC
C     TO PROCESS IT.
C
      IF (IPRMPT.GT.0) THEN
         IF (IPRMPT.NE.2) THEN
            CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
            CALL ERRGRO (.TRUE.,25)
         ELSE
            CALL OPNEWC (KODE,JOSTND,IREAD,IDT,445,KEYWRD,KARD,
     >                      IPRMPT,IRECNT,ICYC)
            CALL fvsGetRtnCode(IRTNCD)
            IF (IRTNCD.NE.0) RETURN
         ENDIF
         GOTO 10
       ENDIF
C
C     IF THE SELECTION VALUE IS NOT PRESENT;
C     THEN:  WRITE ERROR MSG AND SKIP PROCESSING KEYWORD CARD.
C
      IF (.NOT.LNOTBK(2)) THEN
         CALL KEYDMP (JOSTND,IRECNT,KEYWRD,ARRAY,KARD)
         CALL ERRGRO (.TRUE.,4)
         GOTO 10
      ENDIF
C
C     SCHEDULE THE ACTIVITY
C
      CALL OPNEW(KODE,IDT,445,1,ARRAY(2))
      IF (KODE .GT. 0) GOTO 10
      ONOFF = 'OFF'
      IF (ARRAY(2) .EQ. 1) ONOFF = 'ON '
      IF(LKECHO)WRITE(JOSTND,14620) KEYWRD,IDT,ONOFF
14620 FORMAT (/A8,'   DATE/CYCLE=',I5,'; PERMAFROST EFFECT ',A3)
      GOTO 10

      END