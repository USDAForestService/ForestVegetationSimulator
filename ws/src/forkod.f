      SUBROUTINE FORKOD
      IMPLICIT NONE
C----------
C  **FORKOD--WS   DATE OF LAST REVISION:  03/03/11
C----------
C
C     TRANSTLATES FOREST CODE INTO A SUBSCRIPT, IFOR, AND IF
C     KODFOR IS ZERO, THE ROUTINE RETURNS THE DEFAULT CODE.
C
COMMONS
C
C
      INCLUDE 'PRGPRM.F77'
C
C
      INCLUDE 'PLOT.F77'
C
C
      INCLUDE 'CONTRL.F77'
C
C
COMMONS
C
C----------
C  NATIONAL FORESTS:
C  503 = ELDORADO
C  511 = PLUMAS
C  513 = SEQUOIA
C  515 = SIERRA
C  516 = STANISLAUS
C  517 = TAHOE
C  501 = ANGELES (MAPPED TO SEQUOIA)
C  502 = CLEVELAND (MAPPED TO SEQUOIA)
C  504 = INYO (MAPPED TO SEQUOIA)
C  507 = LOS PADRES (MAPPED TO SEQUOIA)
C  512 = SAN BERNADINO (MAPPED TO SEQUOIA)
C  519 = LAKE TAHOE BASIN MGMT UNIT (MAPPED TO ELDORADO)
C  417 = TOIYABE (MAPPED TO STANISLAUS)
C----------
      INTEGER JFOR(13),KFOR(13),NUMFOR,I,KFOR1,KDIS
C----------
C  DATA STATEMENTS:
C     KFOR IS USED IN THIS VARIANT TO SEND A GEOGRAPHIC LOCATER TO
C     **DGF** FOR SETTING THE FORCON VARIABLE FOR THE ANGELES NF
C     THIS GETS SET AFTER 30 CONTINUE
C----------
      DATA JFOR/503,511,513,515,516,517,501,502,504,507,512,519,417/
      DATA NUMFOR/13/
      DATA KFOR/13*1/
C
      IF (KODFOR .EQ. 0) GOTO 30
      KFOR1 = KODFOR
   60 CONTINUE
      IF(KODFOR .LE. 999) GO TO 50
        KFOR1=FLOAT(KODFOR)/100.0
        IF(KFOR1.EQ.501 .OR. KFOR1.EQ.502 .OR. KFOR1.EQ.504 .OR.
     &     KFOR1.EQ.507 .OR. KFOR1.EQ.512 .OR. KFOR1.EQ.519 .OR.
     &     KFOR1.EQ.417)THEN
          KODFOR = KFOR1
          GO TO 60
        ENDIF
        KDIS=KODFOR-KFOR1*100
        IF(KFOR1 .EQ. 503) THEN
          TLAT=38.
          IF(KDIS .EQ. 53) TLAT=39.
          GO TO 50
        ENDIF
        IF(KFOR1 .EQ. 511) THEN
          TLAT=39.
          IF(KDIS .LE. 52) TLAT=40.
          GO TO 50
        ENDIF
        IF(KFOR1 .EQ. 513) THEN
          TLAT=35.
          IF(KDIS .LE. 52) TLAT=36.
          GO TO 50
        ENDIF
        IF(KFOR1 .EQ. 515) THEN
          TLAT=37.
          IF(KDIS .EQ. 54) TLAT=36.
          GO TO 50
        ENDIF
        IF(KFOR1 .EQ. 516) THEN
          TLAT=38.
          IF(KDIS .EQ. 54) TLAT=37.
          GO TO 50
        ENDIF
        IF(KFOR1 .EQ. 517) TLAT=39.
   50 CONTINUE
      DO 10 I=1,NUMFOR
      IF (KFOR1 .EQ. JFOR(I)) GOTO 20
   10 CONTINUE
      CALL ERRGRO (.TRUE.,3)
      WRITE(JOSTND,11) JFOR(IFOR)
   11 FORMAT(T12,'FOREST CODE USED FOR THIS PROJECTION IS',I4)
      GOTO 30
   20 CONTINUE
      IF(I .EQ. 7)THEN
        WRITE(JOSTND,21)
   21   FORMAT(T12,'ANGELES NF (501) BEING MAPPED TO SEQUOIA ',
     &  '(513) FOR FURTHER PROCESSING.')
        I=3
      ELSEIF(I .EQ. 8)THEN
        WRITE(JOSTND,22)
   22   FORMAT(T12,'CLEVELAND NF (502) BEING MAPPED TO SEQUOIA ',
     &  '(513) FOR FURTHER PROCESSING.')
        I=3
      ELSEIF(I .EQ. 9)THEN
        WRITE(JOSTND,23)
   23   FORMAT(T12,'INYO NF (504) BEING MAPPED TO SEQUOIA ',
     &  '(513) FOR FURTHER PROCESSING.')
        I=3
      ELSEIF(I .EQ. 10)THEN
        WRITE(JOSTND,24)
   24   FORMAT(T12,'LOS PADRES NF (507) BEING MAPPED TO SEQUOIA ',
     &  '(513) FOR FURTHER PROCESSING.')
        I=3
      ELSEIF(I .EQ. 11)THEN
        WRITE(JOSTND,25)
   25   FORMAT(T12,'SAN BERNARDINO NF (512) BEING MAPPED TO SEQUOIA ',
     &  '(513) FOR FURTHER PROCESSING.')
        I=3
      ELSEIF(I .EQ. 12)THEN
        WRITE(JOSTND,26)
   26   FORMAT(T12,'LAKE TAHOE BASIN MGMT UNIT (519) BEING MAPPED TO ',
     &  'ELDORADO (503) FOR FURTHER PROCESSING.')
        I=1
      ELSEIF(I .EQ. 13)THEN
        WRITE(JOSTND,27)
   27   FORMAT(T12,'TOIYABE NF (417) BEING MAPPED TO STANISLAUS ',
     &  '(516) FOR FURTHER PROCESSING.')
        I=5
      ENDIF
      IFOR=I
      IF(KFOR1 .EQ. 501)THEN
        IGL=2
      ELSE
        IGL=KFOR(I)
      ENDIF
   30 CONTINUE
      KODFOR=JFOR(IFOR)
      RETURN
      END
